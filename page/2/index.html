<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","version":"8.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="不负光阴韶华">
<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="不负光阴韶华">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="zsz">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hexo</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hexo</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">遇见美好的每天</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">19</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">8</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">21</span></a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">zsz</p>
  <div class="site-description" itemprop="description">不负光阴韶华</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/01/19/SystemVerilog-For-Design-note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zsz">
      <meta itemprop="description" content="不负光阴韶华">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/01/19/SystemVerilog-For-Design-note/" class="post-title-link" itemprop="url">SystemVerilog_For_Design_note</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-01-19 05:46:01" itemprop="dateCreated datePublished" datetime="2022-01-19T05:46:01+08:00">2022-01-19</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-02-04 16:59:47" itemprop="dateModified" datetime="2022-02-04T16:59:47+08:00">2022-02-04</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="systemverilog-for-design-学习笔记"><a href="#systemverilog-for-design-学习笔记" class="headerlink" title="systemverilog  for design 学习笔记"></a>systemverilog  for design 学习笔记</h1><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>system verilog 相对于verilog 的扩展从广义上来说可以分为两个主要的分类：</p>
<ul>
<li>增强主要解决硬件建模的需求，包括整体效率和抽象级别。</li>
<li>增强验证和断言 对于超大型复杂设计测试平台的高效编写</li>
</ul>
<p>对于使用system Verilog 进行HDL 设计可以参考本书《system Verilog for design》，对于验证方面的书可以参考“SystemVerilog for Verification”。</p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><ol>
<li>什么是单文件编译？什么是多文件编译？？？</li>
<li>第三章中的3.2节没有搞明白，system Verilog 中对于`define 的增强。？？？</li>
<li>在verilog 中的$signed() 与 $unsigned() 可以被综合吗？？？？</li>
<li>fpga 中锁存器的影响，什么是锁存器</li>
</ol>
<h2 id="第一章-system-Verilog-简介"><a href="#第一章-system-Verilog-简介" class="headerlink" title="第一章 system Verilog 简介"></a>第一章 system Verilog 简介</h2><h3 id="package-definitions"><a href="#package-definitions" class="headerlink" title="package definitions"></a>package definitions</h3><p>Example 2-1: A package definition</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> definitions;</span><br><span class="line"><span class="keyword">parameter</span> VERSION = <span class="string">&quot;1.1&quot;</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;ADD, SUB, MUL&#125; opcodes_t;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line"><span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a, b;</span><br><span class="line">opcodes_t opcode;</span><br><span class="line">&#125; instruction_t;</span><br><span class="line"><span class="keyword">function</span> <span class="keyword">automatic</span> [<span class="number">31</span>:<span class="number">0</span>] multiplier (<span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] a, b);</span><br><span class="line"><span class="comment">// code for a custom 32-bit multiplier goes here</span></span><br><span class="line"><span class="keyword">return</span> a * b; <span class="comment">// abstract multiplier (no error detection)</span></span><br><span class="line"><span class="keyword">endfunction</span></span><br><span class="line"><span class="keyword">endpackage</span></span><br></pre></td></tr></table></figure>



<p>Example 2-2: Explicit package references using the :: scope resolution operator</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> ALU</span><br><span class="line">(<span class="keyword">input</span> definitions::instruction_t IW,</span><br><span class="line"><span class="keyword">input</span> <span class="keyword">logic</span> clock,</span><br><span class="line"><span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] result</span><br><span class="line">);</span><br><span class="line">    </span><br><span class="line"><span class="keyword">always_ff</span> @(<span class="keyword">posedge</span> clock) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">case</span> (IW<span class="variable">.opcode</span>)</span><br><span class="line">definitions::ADD : result = IW<span class="variable">.a</span> + IW<span class="variable">.b</span>;</span><br><span class="line">definitions::SUB : result = IW<span class="variable">.a</span> - IW<span class="variable">.b</span>;</span><br><span class="line">definitions::MUL : result = definitions::</span><br><span class="line">multiplier(IW<span class="variable">.a</span>, IW<span class="variable">.b</span>);</span><br><span class="line"><span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>



<p>Example 2-3: Importing specific package items into a module</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> ALU</span><br><span class="line">(<span class="keyword">input</span> definitions::instruction_t IW,</span><br><span class="line"><span class="keyword">input</span> <span class="keyword">logic</span> clock,</span><br><span class="line"><span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] result</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> definitions::ADD;</span><br><span class="line"><span class="keyword">import</span> definitions::SUB;</span><br><span class="line"><span class="keyword">import</span> definitions::MUL;</span><br><span class="line"><span class="keyword">import</span> definitions::multiplier;</span><br><span class="line"><span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line"><span class="keyword">case</span> (IW<span class="variable">.opcode</span>)</span><br><span class="line">ADD : result = IW<span class="variable">.a</span> + IW<span class="variable">.b</span>;</span><br><span class="line">SUB : result = IW<span class="variable">.a</span> - IW<span class="variable">.b</span>;</span><br><span class="line">MUL : result = multiplier(IW<span class="variable">.a</span>, IW<span class="variable">.b</span>);</span><br><span class="line"><span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>



<p>Example 2-4: Using a package wildcard import</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> ALU</span><br><span class="line">(<span class="keyword">input</span> definitions::instruction_t IW,</span><br><span class="line"><span class="keyword">input</span> <span class="keyword">logic</span> clock,</span><br><span class="line"><span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] result</span><br><span class="line">);</span><br><span class="line"><span class="keyword">import</span> definitions::*; <span class="comment">// wildcard import</span></span><br><span class="line"><span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line"><span class="keyword">case</span> (IW<span class="variable">.opcode</span>)</span><br><span class="line">ADD : result = IW<span class="variable">.a</span> + IW<span class="variable">.b</span>;</span><br><span class="line">SUB : result = IW<span class="variable">.a</span> - IW<span class="variable">.b</span>;</span><br><span class="line">MUL : result = multiplier(IW<span class="variable">.a</span>, IW<span class="variable">.b</span>);</span><br><span class="line"><span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>system Verilog允许使用时间单位作为时间的一部分比如：</p>
<p>在verilog中使用`timescale  编译器指令将时间单位指定为软件工具的命令  。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//产生一个周期为10ns的时钟：</span></span><br><span class="line"><span class="keyword">forever</span> #<span class="number">5</span>ns clock = ~clock;</span><br></pre></td></tr></table></figure>



<p>Mixed declarations of time units and precision (not synthesizable)</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">timeunit</span> <span class="number">1</span>ns; <span class="comment">// external time unit and precision</span></span><br><span class="line"><span class="keyword">timeprecision</span> <span class="number">1</span>ns;</span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> my_chip ( ... ); </span><br><span class="line">    <span class="keyword">timeprecision</span> <span class="number">1</span>ps; <span class="comment">// local precision (priority over external)</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> data_request) <span class="keyword">begin</span></span><br><span class="line">        #<span class="number">2</span><span class="variable">.5</span> send_packet; <span class="comment">// uses external units &amp; local precision</span></span><br><span class="line">        #<span class="number">3</span><span class="variable">.75ns</span> check_crc; <span class="comment">// specific units take precedence</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">task</span> send_packet();</span><br><span class="line">		...</span><br><span class="line">	<span class="keyword">endtask</span></span><br><span class="line">	<span class="keyword">task</span> check_crc();</span><br><span class="line">		...</span><br><span class="line">	<span class="keyword">endtask</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ps/1ps // directive takes precedence over external</span></span><br><span class="line"><span class="keyword">module</span> FSM ( ... );</span><br><span class="line">	<span class="keyword">timeunit</span> <span class="number">1</span>ns; <span class="comment">// local units take priority over directive</span></span><br><span class="line">    <span class="keyword">always</span> @(State) <span class="keyword">begin</span></span><br><span class="line">    	#<span class="number">1</span><span class="variable">.2</span> <span class="keyword">case</span> (State) <span class="comment">// uses local units &amp; timescale precision</span></span><br><span class="line">    	WAITE: #<span class="number">20</span>ps ...; <span class="comment">// specific units take precedence</span></span><br><span class="line">    	...</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>







<h2 id="第三章"><a href="#第三章" class="headerlink" title="第三章"></a>第三章</h2><h3 id="3-3-System-Verilog-变量"><a href="#3-3-System-Verilog-变量" class="headerlink" title="3.3 System Verilog 变量"></a>3.3 System Verilog 变量</h3><p>在system Verilog中分为类型与数据类型：</p>
<p><strong>type：</strong> variable types,net types</p>
<p><strong>data type：</strong> 4state(logic) 2state(bit)</p>
<p>verilog 数据类型：variable type, net type</p>
<p>variable types：reg ，integer，time 都是4值类型</p>
<p>net types: wire,wor,wand etc也都是4值类型，但是每种值都有120个强度等级。</p>
<h4 id="system-Verilog-data-types"><a href="#system-Verilog-data-types" class="headerlink" title="system Verilog data types"></a>system Verilog data types</h4><p><strong>Type</strong> indicates if the signal is a net or variable. system verilog 使用了所有的verilog 变量类型，像 <strong>reg</strong></p>
<p>, <strong>integer</strong> ,并且添加了几个variable types 像byte,int 等。在System verilog 中，并没有扩展verilog 的 net types.</p>
<p><strong>Data type</strong> indicates the value system of the net or variable, which is 0 or 1 for 2-state data types, and 0, 1, Z or X for 4-state data types.System Verilog 使用关键字 <strong>bit</strong> 定义2 state date types;使用关键字<strong>logic</strong> 定义4state data types。变量可以是2 state 或者是4 state ,而net 只能是4 state。 </p>
<h5 id="SystemVerilog-4-state-variables"><a href="#SystemVerilog-4-state-variables" class="headerlink" title="SystemVerilog 4-state variables"></a>SystemVerilog 4-state variables</h5><p>variable type:</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//隐式表示4state 变量 与verilog 中的reg 等价</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">logic</span> resetN; <span class="comment">// a 1-bit wide 4-state variable</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">63</span>:<span class="number">0</span>] data; <span class="comment">// a 64-bit wide variable</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">0</span>:<span class="number">7</span>] array [<span class="number">0</span>:<span class="number">255</span>]; <span class="comment">// an array of 8-bit variable</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//明确的表示 variable </span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">logic</span> [<span class="number">63</span>:<span class="number">0</span>] data;<span class="comment">// a 64-bit wide variable</span></span><br></pre></td></tr></table></figure>

<p>net type:</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">wire</span> <span class="keyword">logic</span> [<span class="number">63</span>:<span class="number">0</span>] data; <span class="comment">// a 64-bit wide net</span></span><br></pre></td></tr></table></figure>



<h5 id="SystemVerilog-2-state-variables"><a href="#SystemVerilog-2-state-variables" class="headerlink" title="SystemVerilog 2-state variables"></a>SystemVerilog 2-state variables</h5><ul>
<li> bit — a 1-bit 2-state integer</li>
<li> byte — an 8-bit 2-state integer, similar to a C char</li>
<li> shortint — a 16-bit 2-state integer, similar to a C short</li>
<li> int — a 32-bit 2-state integer, similar to a C int</li>
<li> longint — a 64-bit 2-state integer, similar to a C longlong</li>
</ul>
<p>The  keyword  bit  is  not  actually  a  variable  type,  it  is  a  data  type, indicating the variable can have 2-state values.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//隐式表示</span></span><br><span class="line"><span class="keyword">bit</span> resetN; <span class="comment">// a 1-bit wide 2-state variable</span></span><br><span class="line"><span class="keyword">bit</span> [<span class="number">63</span>:<span class="number">0</span>] data; <span class="comment">// a 64-bit 2-state variable</span></span><br><span class="line"><span class="keyword">bit</span> [<span class="number">0</span>:<span class="number">7</span>] array [<span class="number">0</span>:<span class="number">255</span>]; <span class="comment">// an array of 8-bit 2-state variables</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//明确的表示 variable </span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">bit</span> [<span class="number">63</span>:<span class="number">0</span>] addr; <span class="comment">// a 64-bit wide variable</span></span><br></pre></td></tr></table></figure>



<h5 id="simulation"><a href="#simulation" class="headerlink" title="simulation"></a>simulation</h5><p>在仿真中，4 state types 的默认值是X;2-state types 的默认值是0。</p>
<p>当4-state types 转换成2-state types时，X,Z将被映射成0。</p>
<h4 id="Explicit-and-implicit-variable-and-net-data-types"><a href="#Explicit-and-implicit-variable-and-net-data-types" class="headerlink" title="Explicit and implicit variable and net data types"></a>Explicit and implicit variable and net data types</h4><p>在system verilog 中关键字<strong>logic</strong> 表示4-state data type，关键字<strong>bit</strong>表示2-state data type。当使用这些 4 状态或 2 状态数据类型而没有明确指定数据类型是<strong>variable</strong>或<strong>net</strong>时，会推断出隐式<strong>variable</strong>。</p>
<p>example：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//隐式</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">7</span>:<span class="number">0</span>] busA; 	<span class="comment">// infers a variable that is</span></span><br><span class="line">					<span class="comment">// a 4-state data type</span></span><br><span class="line"><span class="keyword">bit</span> [<span class="number">31</span>:<span class="number">0</span>] busB; 	<span class="comment">// infers a variable that is</span></span><br><span class="line">					<span class="comment">// a 2-state data type</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//显式定义：</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">logic</span> [<span class="number">7</span>:<span class="number">0</span>] a; <span class="comment">// 4-state 8-bit variable</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">bit</span> [<span class="number">31</span>:<span class="number">0</span>] b; <span class="comment">// 2-state 32-bit variable</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">int</span> i; <span class="comment">// 2-state 32-bit variable</span></span><br></pre></td></tr></table></figure>

<p>var 关键字不影响变量在仿真或综合中的行为方式。它的用途是帮助使代码更加自文档化。当从用户定义的类型创建变量时，此明确的文档可以帮助使代码更具可读性和可维护性。例如：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> <span class="keyword">bit</span> &#123;FALSE, TRUE&#125; bool_t;</span><br><span class="line"><span class="keyword">var</span> bool_t c; <span class="comment">// variable of user-defined type</span></span><br></pre></td></tr></table></figure>



<p>可选地，可以使用网络类型和逻辑数据类型来声明网络：wire logic [31:0] busC;</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">wire</span>  [<span class="number">31</span>:<span class="number">0</span>] busC;</span><br><span class="line"><span class="keyword">wire</span> <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] busC;</span><br></pre></td></tr></table></figure>

<h4 id="综合指南"><a href="#综合指南" class="headerlink" title="综合指南"></a>综合指南</h4><p>2-state types synthesize the same as 4-state types</p>
<p>4 状态逻辑类型和 2 状态位、字节、shortint、int 和 longint 类型是可综合的。综合编译器以相同的方式处理 2-state 和 4-state 类型。 2 态类型的使用主要影响仿真。</p>
<p>synthesis ignores the default initial value of 2-state types</p>
<p>2 状态类型以逻辑值 0 的默认值开始仿真。综合忽略此默认初始值。通过综合实现的综合后设计不能保证以零上电，就像使用 2 态类型的综合前模型上电时一样。</p>
<h3 id="SystemVerilog-relaxes-restrictions-on-using-variables"><a href="#SystemVerilog-relaxes-restrictions-on-using-variables" class="headerlink" title="SystemVerilog relaxes restrictions on using variables"></a>SystemVerilog relaxes restrictions on using variables</h3><p>SystemVerilog 通过放宽可以使用变量的规则，极大地简化了确定模型中使用的正确类型的过程。使用 SystemVerilog，变量可以通过以下任何一种方式接收值，但不能超过以下一种方式（意思是不可以多重驱动同一个变量）：</p>
<ul>
<li>Be  assigned  a  value  from  any  number  of  initial  or  always procedural blocks (the same rule as in Verilog). </li>
<li> Be assigned a value from a single always_comb, always_ff or always_latch  procedural  block.  These  SystemVerilog  proce- dural blocks are discussed in Chapter 6.</li>
<li> Be  assigned  a  value  from  a  single  continuous  assignment  state-ment.</li>
<li> Receive a value from a single module or primitive output or inout port.</li>
</ul>
<p><strong>example:</strong></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> compare (<span class="keyword">output</span> <span class="keyword">logic</span> lt, eq, gt,</span><br><span class="line">	<span class="keyword">input</span> <span class="keyword">logic</span> [<span class="number">63</span>:<span class="number">0</span>] a, b );</span><br><span class="line"><span class="keyword">always</span> @(a, b)</span><br><span class="line">    <span class="keyword">if</span> (a &lt; b) </span><br><span class="line">        lt = <span class="number">1&#x27;b1</span>; <span class="comment">// procedural assignments</span></span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        lt = <span class="number">1&#x27;b0</span>;</span><br><span class="line">	<span class="keyword">assign</span> gt = (a &gt; b); <span class="comment">// continuous assignments</span></span><br><span class="line">	comparator u1 (eq, a, b); <span class="comment">// module instance</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> comparator (<span class="keyword">output</span> <span class="keyword">logic</span> eq,</span><br><span class="line">	<span class="keyword">input</span> [<span class="number">63</span>:<span class="number">0</span>] a, b);</span><br><span class="line"><span class="keyword">always</span> @(a, b)</span><br><span class="line">	eq = (a==b);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h4 id="错误的使用情况："><a href="#错误的使用情况：" class="headerlink" title="错误的使用情况："></a>错误的使用情况：</h4><p><strong>Restrictions on variables can prevent design errors</strong></p>
<p><strong>Variables cannot be driven by multiple sources.</strong></p>
<h3 id="system-verilog-使用变量的限制"><a href="#system-verilog-使用变量的限制" class="headerlink" title="system verilog 使用变量的限制"></a>system verilog 使用变量的限制</h3><p>需要注意的是，虽然 SystemVerilog 允许在 Verilog 不允许的地方使用变量，但 SystemVerilog 对变量的使用仍然有一些限制。 </p>
<p>SystemVerilog 将多个输出端口或多个连续赋值写入同一个变量，或者将过程赋值与连续赋值或输出驱动程序组合在同一个变量上会导致错误。</p>
<p>这些限制的原因是当两个或多个设备驱动相同的输出时，变量没有内置的解析功能来解析最终值。只有 Verilog 网络类型，例如wire、wand (wire-and) 和 wor (wire-or)，具有内置解析函数来解析多驱动器逻辑。 （Verilog-2005 标准也有一个 uwire 网络类型，它将其使用限制为单个驱动程序，与变量相同。）</p>
<p>错误的使用：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> add_and_increment (</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">63</span>:<span class="number">0</span>] sum,</span><br><span class="line">	<span class="keyword">output</span> <span class="keyword">logic</span> carry,</span><br><span class="line">	<span class="keyword">input</span> <span class="keyword">logic</span> [<span class="number">63</span>:<span class="number">0</span>] a, b </span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(a, b)</span><br><span class="line">	sum = a + b; <span class="comment">// procedural assignment to sum</span></span><br><span class="line"><span class="keyword">assign</span> sum = sum + <span class="number">1</span>; <span class="comment">// ERROR! sum is already being</span></span><br><span class="line"><span class="comment">// assigned a value</span></span><br><span class="line">look_ahead i1 (carry, a, b); <span class="comment">// module instance drives carry</span></span><br><span class="line">overflow_check i2 (carry, a, b); <span class="comment">// ERROR! 2nd driver of carry</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> look_ahead (</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> carry,</span><br><span class="line">	<span class="keyword">input</span> <span class="keyword">logic</span> [<span class="number">63</span>:<span class="number">0</span>] a, b);</span><br><span class="line">	...</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> overflow_check (</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> carry,</span><br><span class="line">	<span class="keyword">input</span> <span class="keyword">logic</span> [<span class="number">63</span>:<span class="number">0</span>] a, b);</span><br><span class="line">	...</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：Use  variables  for  single-driver  logic,  and  use  nets  for  multi-driver logic.</p>
<h3 id="Signed-and-unsigned-modifiers"><a href="#Signed-and-unsigned-modifiers" class="headerlink" title="Signed and unsigned modifiers"></a>Signed and unsigned modifiers</h3><p>verilog 2001 中添加了有符号数的用法：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>]	u;			<span class="comment">// unsigned 8-bit variable</span></span><br><span class="line"><span class="keyword">reg</span> <span class="keyword">signed</span> [<span class="number">7</span>:<span class="number">0</span>] data;	<span class="comment">// signed 8-bit variable</span></span><br></pre></td></tr></table></figure>



<p>在systemverilog 中添加了新的有符号数： byte, shortint, int, and longint。并且sv 提供了无符号数的声明：unsigned。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用unsigned 将有符号数变成无符号数</span></span><br><span class="line"><span class="keyword">int</span> s_int; <span class="comment">// signed 32-bit variable</span></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">unsigned</span> u_int; <span class="comment">// unsigned 32-bit variable</span></span><br></pre></td></tr></table></figure>



<h3 id="3-9-数据类型转换"><a href="#3-9-数据类型转换" class="headerlink" title="3.9 数据类型转换"></a>3.9 数据类型转换</h3><p><strong>使用编译时强制转换运算符进行综合。</strong></p>
<h4 id="静态编译时强制转换"><a href="#静态编译时强制转换" class="headerlink" title="静态编译时强制转换"></a>静态编译时强制转换</h4><p><strong>usag</strong></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1、type casting</span></span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">type</span>&gt;‘(&lt;expression&gt;)  <span class="comment">//将值转换为任何类型，包括用户定义的类型。例如</span></span><br><span class="line"></span><br><span class="line"><span class="number">7</span>+ <span class="keyword">int</span>’(<span class="number">2</span><span class="variable">.0</span> * <span class="number">3</span><span class="variable">.0</span>); <span class="comment">// cast result of </span></span><br><span class="line">					<span class="comment">// (2.0 * 3.0) to int,</span></span><br><span class="line">					<span class="comment">// then add to 7 </span></span><br><span class="line"><span class="comment">//2、size casting</span></span><br><span class="line">&lt;size&gt;’(&lt;expression&gt;) <span class="comment">//— casts a value to any vector size. For example:</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] a, b, y;</span><br><span class="line">	y = a + b**<span class="number">16</span>&#x27;(<span class="number">2</span>); <span class="comment">// cast literal value 2  to be 16 bits wide</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3、sign casting</span></span><br><span class="line">&lt;sign&gt;’(&lt;expression&gt;) <span class="comment">//— casts a value to signed or unsigned. For example:</span></span><br><span class="line"><span class="keyword">shortint</span> a, b;</span><br><span class="line"><span class="keyword">int</span> y;</span><br><span class="line">y = y - <span class="keyword">signed</span>&#x27;(&#123;a,b&#125;); <span class="comment">// cast concatenation // result to a signed value</span></span><br></pre></td></tr></table></figure>



<h4 id="综合指南-1"><a href="#综合指南-1" class="headerlink" title="综合指南"></a>综合指南</h4><p>静态的编译时强制转换运算符是可综合的。综合编译器可能不支持动态 $cast 系统函数。</p>
<h3 id="3-10-常量"><a href="#3-10-常量" class="headerlink" title="3.10 常量"></a>3.10 常量</h3><p>在seystem Verilog 中添加了一个关键字<strong>const</strong> 常量类型。</p>
<p>const 常量的声明必须包含一个type。</p>
<p><strong>常量的声明：</strong></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] C1 = <span class="number">7</span>; 	<span class="comment">// 24-bit constant</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> C2 = <span class="number">15</span>; 			<span class="comment">// 32-bit constant</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">real</span> C3 = <span class="number">3</span><span class="variable">.14</span>; 		<span class="comment">// real constant</span></span><br><span class="line"><span class="keyword">const</span> C4 = <span class="number">5</span>; 				<span class="comment">// ERROR, no type</span></span><br></pre></td></tr></table></figure>



<p><strong>const 可用于自动任务和函数</strong></p>
<p>const 常量本质上是一个只能被初始化的变量。因为常量的 const 形式在运行时而不是细化时接收它的值，所以 const 常量可以在自动任务或函数中声明，也可以在模块或静态任务和函数中声明。在 begin…end 或 fork…join 块中声明的变量也可以声明为 const 常量。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">task</span> <span class="keyword">automatic</span> C;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5</span>; <span class="comment">// N is a constant</span></span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">endtask</span></span><br></pre></td></tr></table></figure>



<h2 id="第四章-User-Defined-and-Enumerated-Types"><a href="#第四章-User-Defined-and-Enumerated-Types" class="headerlink" title="第四章 User-Defined and Enumerated Types"></a>第四章 User-Defined and Enumerated Types</h2><h3 id="4-1-User-defined-types"><a href="#4-1-User-defined-types" class="headerlink" title="4.1 User-defined types"></a>4.1 User-defined types</h3><p>typedef defines a user-defined type</p>
<p>example:</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> <span class="keyword">unsigned</span> unit;</span><br><span class="line">……</span><br><span class="line">unit a,b;	<span class="comment">//two variable of type unit</span></span><br></pre></td></tr></table></figure>

<p>用户定义的类型可以在本地、包中或外部在编译单元范围内定义。</p>
<h4 id="Local-typedef-definitions"><a href="#Local-typedef-definitions" class="headerlink" title="Local typedef definitions"></a>Local typedef definitions</h4><p>using typedef locally</p>
<p>example:</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> alu (...);</span><br><span class="line">	<span class="keyword">typedef</span> <span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>] nibble;</span><br><span class="line">    nibble opA, opB; 	<span class="comment">// variables of the</span></span><br><span class="line">    					<span class="comment">// nibble type</span></span><br><span class="line">    nibble [<span class="number">7</span>:<span class="number">0</span>] data; 	<span class="comment">// a 32-bit vector made</span></span><br><span class="line">    					<span class="comment">// from 8 nibble types</span></span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>



<h4 id="Shared-typedef-definitions"><a href="#Shared-typedef-definitions" class="headerlink" title="Shared typedef definitions"></a>Shared typedef definitions</h4><p>当一个用户定义类型被很多不同的模块使用时，typedef 定义可以在包中声明。</p>
<h5 id="typedef-definitions-in-packages"><a href="#typedef-definitions-in-packages" class="headerlink" title="typedef definitions in packages"></a>typedef definitions in packages</h5><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> definitions;</span><br><span class="line">	<span class="keyword">parameter</span> VERSION = <span class="string">&quot;1.1&quot;</span>;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;ADD, SUB, MUL&#125; opcodes_t;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line">        <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a, b;</span><br><span class="line">        opcodes_t opcode;</span><br><span class="line">    &#125; instruction_t;</span><br><span class="line">    <span class="keyword">function</span> <span class="keyword">automatic</span> [<span class="number">31</span>:<span class="number">0</span>] multiplier (<span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] a, b);</span><br><span class="line">    	<span class="comment">// code for a custom 32-bit multiplier goes here</span></span><br><span class="line">    	<span class="keyword">return</span> a * b; <span class="comment">// abstract multiplier (no error detection)</span></span><br><span class="line">    <span class="keyword">endfunction</span></span><br><span class="line"><span class="keyword">endpackage</span></span><br></pre></td></tr></table></figure>

<p><strong>example2</strong></p>
<p>Directly referencing typedef definitions from a package </p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> chip_types; </span><br><span class="line">	<span class="meta">`<span class="meta-keyword">ifdef</span> TWO_STATE</span></span><br><span class="line">    	<span class="keyword">typedef</span> <span class="keyword">bit</span> dtype_t;</span><br><span class="line">    <span class="meta">`<span class="meta-keyword">else</span></span></span><br><span class="line">    	<span class="keyword">typedef</span> <span class="keyword">logic</span> dtype_t;</span><br><span class="line">    <span class="meta">`<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="keyword">endpackage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> counter</span><br><span class="line">(<span class="keyword">output</span> chip_types::dtype_t [<span class="number">15</span>:<span class="number">0</span>] count,</span><br><span class="line"><span class="keyword">input</span> chip_types::dtype_t clock, resetN);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">		<span class="keyword">if</span> (!resetN) count &lt;= <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">else</span> count &lt;= count + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>





<h5 id="typedef-definitions-in-unit"><a href="#typedef-definitions-in-unit" class="headerlink" title="typedef definitions in  $unit"></a>typedef definitions in  $unit</h5><p>typedef 定义也可以在外部声明，在编译单元范围内。</p>
<p>**注意:**外部编译单元范围声明不是全局的</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/******************* External declarations *******************/</span></span><br><span class="line"><span class="keyword">parameter</span> VERSION = <span class="string">&quot;1.2a&quot;</span>; <span class="comment">// external constant</span></span><br><span class="line"><span class="keyword">reg</span> resetN = <span class="number">1</span>; <span class="comment">// external variable (active low)</span></span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="keyword">packed</span> &#123; <span class="comment">// external user-defined type</span></span><br><span class="line">        <span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] address;</span><br><span class="line">        <span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] data;</span><br><span class="line">        <span class="keyword">reg</span> [ <span class="number">7</span>:<span class="number">0</span>] opcode;</span><br><span class="line">    &#125; instruction_word_t;</span><br><span class="line"><span class="keyword">function</span> <span class="keyword">automatic</span> <span class="keyword">int</span> log2 (<span class="keyword">input</span> <span class="keyword">int</span> n); <span class="comment">// external function</span></span><br><span class="line">    <span class="keyword">if</span> (n &lt;=<span class="number">1</span>) <span class="keyword">return</span>(<span class="number">1</span>);</span><br><span class="line">    log2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n &gt; <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">        n = n/<span class="number">2</span>;</span><br><span class="line">        log2++;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span>(log2);</span><br><span class="line"><span class="keyword">endfunction</span></span><br><span class="line"><span class="comment">/********************* module definition *********************/</span></span><br><span class="line"><span class="comment">// external declaration is used to define port types</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> register (<span class="keyword">output</span> instruction_word_t q,</span><br><span class="line">				<span class="keyword">input</span> instruction_word_t d,</span><br><span class="line">				<span class="keyword">input</span> <span class="keyword">wire</span> clock );</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">    <span class="keyword">if</span> (!resetN) q &lt;= <span class="number">0</span>; <span class="comment">// use external reset</span></span><br><span class="line">    <span class="keyword">else</span> q &lt;= d;</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>example2：</strong></p>
<p>Importing package typedef definitions into $unit</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> chip_types; </span><br><span class="line">	<span class="meta">`<span class="meta-keyword">ifdef</span> TWO_STATE</span></span><br><span class="line">    	<span class="keyword">typedef</span> <span class="keyword">bit</span> dtype_t;</span><br><span class="line">    <span class="meta">`<span class="meta-keyword">else</span></span></span><br><span class="line">    	<span class="keyword">typedef</span> <span class="keyword">logic</span> dtype_t;</span><br><span class="line">    <span class="meta">`<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="keyword">endpackage</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> chip_types::dtype_t; <span class="comment">// import definition into $unit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> counter</span><br><span class="line">(<span class="keyword">output</span> dtype_t [<span class="number">15</span>:<span class="number">0</span>] count,</span><br><span class="line"> <span class="keyword">input</span>  dtype_t clock, resetN);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">		<span class="keyword">if</span> (!resetN) count &lt;= <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">else</span> count &lt;= count + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p><strong>注意</strong> 如果package 中含有多个typedefs,可以使用通配符导入：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> chip_types::*; <span class="comment">// wildcard import</span></span><br></pre></td></tr></table></figure>



<h4 id="user-defined-types-命名惯例"><a href="#user-defined-types-命名惯例" class="headerlink" title="user-defined types 命名惯例"></a>user-defined types 命名惯例</h4><p>为了使源代码更易于阅读和维护，一个常见的命名约定是以字符“_t”结束所有typedef的type。</p>
<h3 id="Enumerated-types-枚举类型"><a href="#Enumerated-types-枚举类型" class="headerlink" title="Enumerated types 枚举类型"></a>Enumerated types 枚举类型</h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//vari-able RGB can have the values of red, green and blue:</span></span><br><span class="line"><span class="keyword">enum</span> &#123;red,green,blue&#125; RGB;</span><br></pre></td></tr></table></figure>



<p>example</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> chip_types;</span><br><span class="line">	<span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;FETCH, WRITE, ADD, SUB,</span><br><span class="line">				  MULT, DIV, SHIFT, NOP &#125; instr_t;</span><br><span class="line"><span class="keyword">endpackage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> chip_types::*; <span class="comment">// import package definitions into $unit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> controller (	<span class="keyword">output</span> <span class="keyword">logic</span> read, write,</span><br><span class="line">					<span class="keyword">input</span> instr_t instruction,</span><br><span class="line">					<span class="keyword">input</span> <span class="keyword">wire</span> clock, resetN);</span><br><span class="line">	<span class="keyword">enum</span> &#123;WAITE, LOAD, STORE&#125; State, NextState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">always_ff</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">    	<span class="keyword">if</span> (!resetN) State &lt;= WAITE;</span><br><span class="line">    	<span class="keyword">else</span> State &lt;= NextState;</span><br><span class="line">    <span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (State)</span><br><span class="line">            WAITE: NextState = LOAD;</span><br><span class="line">            LOAD: NextState = STORE;</span><br><span class="line">            STORE: NextState = WAITE;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">    	read = <span class="number">0</span>; write = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (State == LOAD &amp;&amp; instruction == FETCH)</span><br><span class="line">    	read = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (State == STORE &amp;&amp; instruction == WRITE)</span><br><span class="line">    	write = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="Importing-enumerated-types-from-packages"><a href="#Importing-enumerated-types-from-packages" class="headerlink" title="Importing enumerated types from packages"></a>Importing enumerated types from packages</h4><p><strong>注意：</strong> 导入一个枚举类型定义的名字并不会自动导入枚举标签值。</p>
<p>example: 下面的这个例子并不工作：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> chip_types;</span><br><span class="line">	<span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;WAITE, LOAD, READY&#125; states_t;</span><br><span class="line"><span class="keyword">endpackage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> chip (...);</span><br><span class="line">    <span class="keyword">import</span> chip_types::states_t; 	<span class="comment">// imports the</span></span><br><span class="line">                                    <span class="comment">// typedef name,</span></span><br><span class="line">                                    <span class="comment">// only</span></span><br><span class="line">    states_t state, next_state;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always_ff</span> @(<span class="keyword">posedge</span> clk, <span class="keyword">negedge</span> resetN)</span><br><span class="line">        <span class="keyword">if</span> (!resetN)</span><br><span class="line">        	state &lt;= WAITE; <span class="comment">// ERROR: &quot;WAITE&quot; has not been imported!</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        	state &lt;= next_state;</span><br><span class="line">    ... </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p>为了使枚举类型标签可见，有两种方法可以实现：</p>
<ol>
<li>必须显示的导入每一个标签；</li>
<li>或者这个包使用通配符导入：使用通配符导入可以确保枚举type name 与enumerated value lables 在导入的作用范围内是可见的。</li>
</ol>
<p>example：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> chip_types::*; <span class="comment">// wildcard import</span></span><br></pre></td></tr></table></figure>

<h4 id="Enumerated-type-label-sequences"><a href="#Enumerated-type-label-sequences" class="headerlink" title="Enumerated type label sequences"></a>Enumerated type label sequences</h4><p>The  following  example  creates  an  enumerated  list  with  the  labels RESET, S0 through S4, and W6 through W9:</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> &#123;RESET, S[<span class="number">5</span>], W[<span class="number">6</span>:<span class="number">9</span>]&#125; state;</span><br></pre></td></tr></table></figure>

<h4 id="enumerated-labels-must-be-unique"><a href="#enumerated-labels-must-be-unique" class="headerlink" title="enumerated labels must be unique"></a>enumerated labels must be unique</h4><p>枚举类型列表中的标签在该范围内必须是唯一的。可以包含枚举类型声明的范围是编译单元、模块、接口、程序、begin…end 块、fork…join 块、任务和函数</p>
<p><strong>example</strong></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> FSM (...);</span><br><span class="line">	<span class="keyword">enum</span> &#123;GO, STOP&#125; fsm1_state;</span><br><span class="line">...</span><br><span class="line">    <span class="keyword">enum</span> &#123;WAITE, GO, DONE&#125; fsm2_state; <span class="comment">// ERROR GO</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>修改上面的错误:可以使用在两个begin end 中声明</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> FSM (...);</span><br><span class="line">...</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clock)</span><br><span class="line">    <span class="keyword">begin</span>: fsm1</span><br><span class="line">        <span class="keyword">enum</span> &#123;STOP, GO&#125; fsm1_state;</span><br><span class="line">    	...</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clock)</span><br><span class="line">    <span class="keyword">begin</span>: fsm2</span><br><span class="line">    	<span class="keyword">enum</span> &#123;WAITE, GO, DONE&#125; fsm2_state;</span><br><span class="line">    	...</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h4 id="Enumerated-type-values"><a href="#Enumerated-type-values" class="headerlink" title="Enumerated type values"></a>Enumerated type values</h4><p>默认的：枚举中的标签实际是一个int type的值,枚举体中的标签值从0依次递增：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//example</span></span><br><span class="line"><span class="keyword">enum</span> &#123;a,b,c,d&#125; state; <span class="comment">//a-d 依次表示0-3</span></span><br></pre></td></tr></table></figure>

<p>users can specify the label’s value</p>
<p>枚举体中的标签的值可以被用户指定：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> &#123;ONE	= <span class="number">1</span>,</span><br><span class="line">      FIVE  = <span class="number">5</span>,</span><br><span class="line">      TEN   = <span class="number">10</span>&#125; dtate;</span><br></pre></td></tr></table></figure>

<p>example2</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> &#123;A=<span class="number">1</span>, B, C, X=<span class="number">24</span>, Y, Z&#125; list1;<span class="comment">//A=1,B=2,C=3,X=24,Y=25,Z=26</span></span><br></pre></td></tr></table></figure>

<p>枚举体中标签的值只能是唯一的：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> &#123;A=<span class="number">1</span>, B, C, D=<span class="number">3</span>&#125; list2; <span class="comment">// ERROR</span></span><br></pre></td></tr></table></figure>

<h4 id="基于type-的枚举体类型"><a href="#基于type-的枚举体类型" class="headerlink" title="基于type 的枚举体类型"></a>基于type 的枚举体类型</h4><p>枚举体默认是基于int(32bit 2-state)类型的。</p>
<p>system verilog 允许显式的指明枚举体基于的类去声明。</p>
<p>for example </p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// enumerated type with a 1-bit wide,</span></span><br><span class="line"><span class="comment">// 2-state base type</span></span><br><span class="line"><span class="keyword">enum</span> <span class="keyword">bit</span> &#123;TRUE, FALSE&#125; Boolean; </span><br><span class="line"></span><br><span class="line"><span class="comment">// enumerated type with a 2-bit wide,</span></span><br><span class="line"><span class="comment">// 4-state base type</span></span><br><span class="line"><span class="keyword">enum</span> <span class="keyword">logic</span> [<span class="number">1</span>:<span class="number">0</span>] &#123;WAITE, LOAD, READY&#125; state;</span><br></pre></td></tr></table></figure>

<p>如果为显式类型枚举类型的枚举标签赋值，则其大小必须与基本类型的大小匹配。</p>
<p>for example </p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="keyword">logic</span> [<span class="number">2</span>:<span class="number">0</span>] &#123;WAITE = <span class="number">3</span>’b001,</span><br><span class="line">                  LOAD 	= <span class="number">3</span>’b010,</span><br><span class="line">                  READY = <span class="number">3</span>’b100&#125; state;</span><br><span class="line"></span><br><span class="line"><span class="comment">//enum variable defaults to an int base type. An error will result from assigning a 3-bit value to the labels.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> &#123;WAITE = <span class="number">3</span>’b001, <span class="comment">// ERROR! </span></span><br><span class="line">	  LOAD 	= <span class="number">3</span>’b010,</span><br><span class="line">      READY = <span class="number">3</span>’b100&#125; state;</span><br><span class="line"><span class="comment">//枚举列表中的标签多于基本类型大小可以表示的标签也是错误的。</span></span><br><span class="line"><span class="keyword">enum</span> <span class="keyword">logic</span> &#123;A=<span class="number">1</span>’b0, B, C&#125; list5; <span class="comment">// ERROR: too many labels for 1-bit size</span></span><br></pre></td></tr></table></figure>

<p>如果枚举值的基类型是 4 状态类型，则将 X 或 Z 的值分配给枚举标签是合法的。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="keyword">logic</span> &#123;ON=<span class="number">1</span>’b1, OFF=<span class="number">1</span>’bz&#125; out; <span class="comment">//正确的</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="keyword">logic</span> [<span class="number">1</span>:<span class="number">0</span>]</span><br><span class="line">&#123;WAITE, ERR=<span class="number">2</span>’bxx, LOAD, READY&#125; state;	<span class="comment">//如果有一个标签被分配成了X或者Z,那么后面的标签的值需要明确指定。</span></span><br><span class="line"><span class="comment">// ERROR: cannot determine a value for LOAD</span></span><br></pre></td></tr></table></figure>

<h4 id="枚举类型可以声明为typedef"><a href="#枚举类型可以声明为typedef" class="headerlink" title="枚举类型可以声明为typedef"></a>枚举类型可以声明为typedef</h4><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;WAITE, LOAD, READY&#125; states_t;</span><br><span class="line">states_t state, next_state;</span><br></pre></td></tr></table></figure>



<h4 id="枚举类型的操作"><a href="#枚举类型的操作" class="headerlink" title="枚举类型的操作"></a>枚举类型的操作</h4><p>枚举类型是半强类型的。只能分配枚举类型：</p>
<ul>
<li>A label from its enumerated type list</li>
<li>Another enumerated type of the same type (that is, declared with the same typedef definition) </li>
<li>A value cast to the typedef type of the enumerated type</li>
</ul>
<p>当对枚举类型值执行操作时，枚举值会自动转换为表示枚举类型列表中标签的基本类型和内部值。如果未显式声明枚举类型的基类型，则基类型和标签将默认为 int 类型。</p>
<p>In the following example:</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;WAITE, LOAD, READY&#125; states_t;</span><br><span class="line">states_t state, next_state;</span><br><span class="line"><span class="keyword">int</span> foo;</span><br></pre></td></tr></table></figure>

<p>WAITE will be represented as an int with a value of 0, LOAD as an int with a value of 1, and READY as an int value of 2.<br>以下对枚举类型的赋值操作是合法的：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">state = next_state; <span class="comment">// legal operation</span></span><br></pre></td></tr></table></figure>

<p>The <strong>state</strong> and <strong>next_state</strong> are both enumerated type variables of the  same  <strong>type</strong>  (<strong>states_t</strong>).  A  value  in  one  enumerated  type  vari-able  can  be  assigned  to  another  enumerated  <strong>type</strong>  variable  of  the<br>same type.<br>The assignment statement below is also legal. The enumerated type of state is represented as a base type of <strong>int</strong>, which is added to the literal integer 1. The result of the operation is an <strong>int</strong> value, which is assigned to a variable of type <strong>int</strong>.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo = state + <span class="number">1</span>; <span class="comment">// legal operation</span></span><br></pre></td></tr></table></figure>

<p>The  converse  of  the  preceding  example  is  illegal.  An  error  will result if a value that is not of the same enumerated type is assigned to an enumerated type variable. For example: </p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">state = foo + <span class="number">1</span>; <span class="comment">// ERROR: illegal assignment</span></span><br></pre></td></tr></table></figure>

<p>在这个例子中，foo + 1 的结果类型是一个 int，它与 state 不同，state 是一个 states_t 类型。</p>
<p>下面的例子也是非法的，并且会导致错误：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">state = state + <span class="number">1</span>; 		<span class="comment">// illegal operation</span></span><br><span class="line">state++; 				<span class="comment">// illegal operation</span></span><br><span class="line">next_state += state; 	<span class="comment">// illegal operation</span></span><br></pre></td></tr></table></figure>

<p>The enumerated type of <strong>state</strong> is represented as a base type of <strong>int</strong>, which is added to the literal integer 1. The result of the operation is an <strong>int</strong>  value.  It  is  an  error  to  directly  assign  this  <strong>int</strong>  result  to  a variable of the enumerated type <strong>state</strong>, which is a <strong>states_t</strong> type. </p>
<h4 id="将表达式转换为枚举类型"><a href="#将表达式转换为枚举类型" class="headerlink" title="将表达式转换为枚举类型"></a>将表达式转换为枚举类型</h4><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;WAITE, LOAD, READY&#125; states_t;</span><br><span class="line">states_t state, next_state;</span><br><span class="line">next_state = states_t’(state++); <span class="comment">// legal</span></span><br><span class="line"><span class="built_in">$cast</span>(next_state, state + <span class="number">1</span>); <span class="comment">// legal</span></span><br></pre></td></tr></table></figure>



<p>注意：转换运算符可能会导致超出范围。转换运算符将始终执行转换操作和赋值。没有检查要分配的值是否在枚举类型集的合法范围内。使用前面关于 state 和 next_state 的枚举类型示例，如果 state 的值为 READY，表示为值 2，则将其递增 1 将导致整数值 3。将此值分配给 next_state 超出了next_state 的枚举类型列表中的值范围。</p>
<p>动态的转换$cast(next_state, state + 1); // legal 可能会无法综合。</p>
<p>SystemVerilog 提供了几个内置函数（称为方法）来遍历枚举类型列表中的值。这些方法会自动处理枚举类型的半强类型特性，从而可以轻松地执行诸如递增到枚举类型列表中的下一个值、跳转到列表开头或跳转到列表末尾等操作。 使用这些方法，不必知道枚举列表中的标签或值。</p>
<p>这些处理枚举列表的特殊方法以类似于 C++ 类方法的方式调用。也就是说，方法的名称附加在枚举类型名称的末尾，并以句点作为分隔符。</p>
<p><enum_variable_name>.first — 返回指定变量枚举列表中第一个成员的值。</enum_variable_name></p>
<p> <enum_variable_name>.last — 返回枚举列表中最后一个成员的值。</enum_variable_name></p>
<p><enum_variable_name>.next(<N>)</N></enum_variable_name></p>
<p><enum_variable_name>.prev(<N>)</N></enum_variable_name></p>
<p><enum_variable_name>.num — 返回给定变量的枚举列表中的标签数。</enum_variable_name></p>
<p><enum_variable_name>.name — 返回给定枚举类型中值的标签的字符串表示形式。如果该值不是枚举的成员，则 name 方法返回一个空字符串。枚举类型方法使用 C++ 语法</enum_variable_name></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Example  <span class="number">4</span>-<span class="number">5</span>  illustrates  a  state  machine  model  that  sequences through  its  states,  using  some  of  the  enumeration  methods  listed above. The example is a simple <span class="number">0</span> to <span class="number">15</span> confidence counter, where:</span><br><span class="line">• The  in_sync  <span class="keyword">output</span>  is  initially  <span class="number">0</span>;  it  is  set  when  the  counter reaches <span class="number">8</span>; in_sync is cleared again <span class="keyword">if</span> the counter goes to <span class="number">0</span>.</span><br><span class="line">• If  the  compare  <span class="keyword">and</span>  synced  <span class="keyword">input</span>  flags  are  both  false,  the counter stays at its current count.</span><br><span class="line">• If  the  compare  flag  <span class="keyword">and</span>  the  synced  flag  are  both  true,  the counter increments by <span class="number">1</span> (but cannot go beyond <span class="number">15</span>).</span><br><span class="line">• If  the  compare  flag  is  true  but  the  synced  flag  is  false,  the counter decrements by <span class="number">2</span> (but cannot go below <span class="number">0</span>).</span><br><span class="line"><span class="comment">//Using special methods to iterate through enumerated type lists</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> confidence_counter(<span class="keyword">input</span> <span class="keyword">logic</span> synced, compare, 	resetN, clock,</span><br><span class="line">						  <span class="keyword">output</span> <span class="keyword">logic</span> in_sync);</span><br><span class="line">	<span class="keyword">enum</span> &#123;cnt[<span class="number">0</span>:<span class="number">15</span>]&#125; State, Next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">always_ff</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">     	<span class="keyword">if</span> (!resetN) State &lt;= cnt0;</span><br><span class="line">    	<span class="keyword">else</span> State &lt;= Next;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">    	Next = State; <span class="comment">// default NextState value</span></span><br><span class="line">        <span class="keyword">case</span> (State)</span><br><span class="line">            cnt0 : <span class="keyword">if</span> (compare &amp;&amp; synced) Next = State<span class="variable">.next</span>;</span><br><span class="line">            cnt1 : <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span> (compare &amp;&amp; synced) Next = State<span class="variable">.next</span>;</span><br><span class="line">                <span class="keyword">if</span> (compare &amp;&amp; !synced) Next = State<span class="variable">.first</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            cnt15: <span class="keyword">if</span> (compare &amp;&amp; !synced) Next = State<span class="variable">.prev</span>(<span class="number">2</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">default</span> <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span> (compare &amp;&amp; synced) Next = State<span class="variable">.next</span>;</span><br><span class="line">                <span class="keyword">if</span> (compare &amp;&amp; !synced) Next = State<span class="variable">.prev</span>(<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always_ff</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">        <span class="keyword">if</span> (!resetN) in_sync &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (State == cnt8) in_sync &lt;= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (State == cnt0) in_sync &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br></pre></td></tr></table></figure>



<h4 id="打印枚举类型"><a href="#打印枚举类型" class="headerlink" title="打印枚举类型"></a>打印枚举类型</h4><p>枚举类型值可以打印为标签的内部值，也可以打印为标签的名称。直接打印枚举类型会打印枚举类型的内部值。使用枚举类型名称方法访问表示当前值的标签<strong>name</strong>。此方法返回一个包含名称的字符串。然后可以将此字符串传递给 $display 以进行打印。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> FSM (<span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN,</span><br><span class="line">    		<span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>] control);</span><br><span class="line">    		<span class="keyword">enum</span> <span class="keyword">logic</span> [<span class="number">2</span>:<span class="number">0</span>] &#123;WAITE=<span class="number">3&#x27;b001</span>,</span><br><span class="line">    LOAD =<span class="number">3&#x27;b010</span>,</span><br><span class="line">    READY=<span class="number">3&#x27;b010</span>&#125; State, Next;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">        <span class="keyword">if</span> (!resetN) State &lt;= WAITE;</span><br><span class="line">        <span class="keyword">else</span> State &lt;= Next;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">    	<span class="built_in">$display</span>(<span class="string">&quot;\nCurrent state is %s (%b)&quot;</span>, State<span class="variable">.name</span>, State);</span><br><span class="line">    	<span class="keyword">case</span> (State)</span><br><span class="line">            WAITE: Next = LOAD;</span><br><span class="line">            LOAD: Next = READY;</span><br><span class="line">            READY: Next = WAITE;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    	<span class="built_in">$display</span>(<span class="string">&quot;Next state will be %s (%b)&quot;</span>, Next<span class="variable">.name</span>, Next);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assign</span> control = State;</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="第五章-SystemVerilog-Arrays-Structures-and-Unions"><a href="#第五章-SystemVerilog-Arrays-Structures-and-Unions" class="headerlink" title="第五章 SystemVerilog Arrays,Structures and Unions"></a>第五章 SystemVerilog Arrays,Structures and Unions</h2><h3 id="5-1-Structures-结构体"><a href="#5-1-Structures-结构体" class="headerlink" title="5.1 Structures 结构体"></a>5.1 Structures 结构体</h3><p><strong>定义：</strong> 结构体使用<strong>struct</strong>关键字来定义，结构体的成员可以是任意变量类型，包括typpedef 用户自定义类型，和任何的常量类型。for example：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="keyword">int</span> a, b; 				<span class="comment">// 32-bit variables</span></span><br><span class="line">    opcode_t opcode; 		<span class="comment">// user-defined type</span></span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] address; 	<span class="comment">// 24-bit variable</span></span><br><span class="line">    <span class="keyword">bit</span> error; 				<span class="comment">// 1-bit 2-state var.</span></span><br><span class="line">&#125; Instruction_Word;</span><br></pre></td></tr></table></figure>

<p>访问结构体成员的方法与C类似：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;structure_name&gt;.&lt;variable_name&gt;</span><br></pre></td></tr></table></figure>

<p>给结构体成员赋值：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Instruction_Word<span class="variable">.address</span> = <span class="number">32</span>’hF000001E;</span><br></pre></td></tr></table></figure>



<h4 id="Structure-declartions"><a href="#Structure-declartions" class="headerlink" title="Structure declartions"></a>Structure declartions</h4><p>结构体可以是变量或者nets：</p>
<p>如果不使用var,或者nets类型的声明，隐式为var型。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将结构体整体声明成一个变量</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">struct</span> &#123; <span class="comment">// structure variable</span></span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a, b;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] opcode;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] address;</span><br><span class="line">&#125; Instruction_Word_var;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将结构体整体声明成一个线网</span></span><br><span class="line"><span class="keyword">wire</span> <span class="keyword">struct</span> &#123; <span class="comment">// structure net</span></span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a, b;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] opcode;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] address;</span><br><span class="line">&#125; Instruction_Word_net;</span><br></pre></td></tr></table></figure>

<h4 id="structures-can-be-user-defined-types"><a href="#structures-can-be-user-defined-types" class="headerlink" title="structures can be user-defined types"></a>structures can be user-defined types</h4><p>用户定义的结构体类型是不占用存储空间的。在对用户定义的结构体类型变量进行赋值之前，需要首先进行声明。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123; <span class="comment">// structure definition</span></span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a, b;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] opcode;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] address;</span><br><span class="line">&#125; instruction_word_t;</span><br><span class="line"></span><br><span class="line"><span class="comment">//变量声明</span></span><br><span class="line">instruction_word_t IW; <span class="comment">// structure allocation</span></span><br></pre></td></tr></table></figure>

<p>当一个结构被声明而不使用 typedef 时，它被称为匿名结构。</p>
<p>for example：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a, b;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] opcode;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] address;</span><br><span class="line">&#125; instruction;</span><br></pre></td></tr></table></figure>

<h4 id="共享结构体的定义：-using-packages-or-unit"><a href="#共享结构体的定义：-using-packages-or-unit" class="headerlink" title="共享结构体的定义： using packages or $unit"></a>共享结构体的定义： using packages or $unit</h4><p>结构类型可以在模块或接口中定义，允许在整个设计块中使用。如果一个结构类型定义需要在多个设计块中使用，或者作为模块或接口的一个端口，那么结构定义应该放在一个包中，并导入到设计块或$unit 编译单元空间.结构体类型也可以直接在$unit 编译单元空间中定义。</p>
<p>example1：package</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> definitions;</span><br><span class="line">	<span class="keyword">parameter</span> VERSION = <span class="string">&quot;1.1&quot;</span>;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;ADD, SUB, MUL&#125; opcodes_t;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line">        <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a, b;</span><br><span class="line">        opcodes_t opcode;</span><br><span class="line">    &#125; instruction_t;</span><br><span class="line">    <span class="keyword">function</span> <span class="keyword">automatic</span> [<span class="number">31</span>:<span class="number">0</span>] multiplier (<span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] a, b);</span><br><span class="line">    	<span class="comment">// code for a custom 32-bit multiplier goes here</span></span><br><span class="line">    	<span class="keyword">return</span> a * b; <span class="comment">// abstract multiplier (no error detection)</span></span><br><span class="line">    <span class="keyword">endfunction</span></span><br><span class="line"><span class="keyword">endpackage</span></span><br></pre></td></tr></table></figure>

<p>example2：  $unit</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/******************* External declarations *******************/</span></span><br><span class="line"><span class="keyword">parameter</span> VERSION = <span class="string">&quot;1.2a&quot;</span>; <span class="comment">// external constant</span></span><br><span class="line"><span class="keyword">reg</span> resetN = <span class="number">1</span>; <span class="comment">// external variable (active low)</span></span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="keyword">packed</span> &#123; <span class="comment">// external user-defined type</span></span><br><span class="line">        <span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] address;</span><br><span class="line">        <span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] data;</span><br><span class="line">        <span class="keyword">reg</span> [ <span class="number">7</span>:<span class="number">0</span>] opcode;</span><br><span class="line">    &#125; instruction_word_t;</span><br><span class="line"><span class="keyword">function</span> <span class="keyword">automatic</span> <span class="keyword">int</span> log2 (<span class="keyword">input</span> <span class="keyword">int</span> n); <span class="comment">// external function</span></span><br><span class="line">    <span class="keyword">if</span> (n &lt;=<span class="number">1</span>) <span class="keyword">return</span>(<span class="number">1</span>);</span><br><span class="line">    log2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n &gt; <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">        n = n/<span class="number">2</span>;</span><br><span class="line">        log2++;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span>(log2);</span><br><span class="line"><span class="keyword">endfunction</span></span><br><span class="line"><span class="comment">/********************* module definition *********************/</span></span><br><span class="line"><span class="comment">// external declaration is used to define port types</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> register (<span class="keyword">output</span> instruction_word_t q,</span><br><span class="line">				<span class="keyword">input</span> instruction_word_t d,</span><br><span class="line">				<span class="keyword">input</span> <span class="keyword">wire</span> clock );</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">    <span class="keyword">if</span> (!resetN) q &lt;= <span class="number">0</span>; <span class="comment">// use external reset</span></span><br><span class="line">    <span class="keyword">else</span> q &lt;= d;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h4 id="结构体赋值"><a href="#结构体赋值" class="headerlink" title="结构体赋值"></a>结构体赋值</h4><h5 id="初始化结构体"><a href="#初始化结构体" class="headerlink" title="初始化结构体"></a>初始化结构体</h5><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a, b;</span><br><span class="line">	<span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] opcode;</span><br><span class="line">	<span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] address;</span><br><span class="line">&#125; instruction_word_t;</span><br><span class="line"></span><br><span class="line">instruction_word_t IW = ’&#123;<span class="number">100</span>, <span class="number">3</span>, <span class="number">8</span>’hFF, <span class="number">0</span>&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="结构体成员赋值"><a href="#结构体成员赋值" class="headerlink" title="结构体成员赋值"></a>结构体成员赋值</h5><p>三种方法实现结构体的赋值：</p>
<p>方法一：结构体成员赋值</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123; </span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a, b;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] opcode;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] address;</span><br><span class="line">&#125; instr_t;</span><br><span class="line"></span><br><span class="line">instr_t IW;</span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">	<span class="keyword">if</span> (!resetN) <span class="keyword">begin</span></span><br><span class="line">        IW<span class="variable">.a</span> = <span class="number">100</span>; <span class="comment">// reference structure member</span></span><br><span class="line">        IW<span class="variable">.b</span> = <span class="number">5</span>;</span><br><span class="line">        IW<span class="variable">.opcode</span> = <span class="number">8</span>’hFF;</span><br><span class="line">        IW<span class="variable">.address</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span> </span><br><span class="line">    	...</span><br><span class="line">    <span class="keyword">end</span></span><br></pre></td></tr></table></figure>



<p>方法二：将结构表达式分配给结构体</p>
<p>example1:</p>
<p>a structure expression is enclosed within ’{ … }</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">	<span class="keyword">if</span> (!resetN) IW = ’&#123;<span class="number">100</span>, <span class="number">5</span>, <span class="number">8</span>’hFF, <span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">begin</span> </span><br><span class="line">	...</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>example2：</p>
<p>a structure expression  can be listed by order or by member name</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IW = ’&#123;address:<span class="number">0</span>, opcode:<span class="number">8</span>’hFF, a:<span class="number">100</span>, b:<span class="number">5</span>&#125;; <span class="comment">//legal</span></span><br><span class="line"><span class="comment">//It is illegal to mix listing by name and listing by order in the same structure expression.</span></span><br><span class="line">IW = ’&#123;address:<span class="number">0</span>, <span class="number">8</span>’hFF, <span class="number">100</span>, <span class="number">5</span>&#125;; <span class="comment">// ERROR </span></span><br></pre></td></tr></table></figure>

<p>方法三：Default values in structure expressions</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IW = ’&#123;<span class="keyword">default</span>:<span class="number">0</span>&#125;; <span class="comment">// set all members of IW to 0</span></span><br></pre></td></tr></table></figure>

<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="keyword">real</span> r0, r1;</span><br><span class="line">    <span class="keyword">int</span> i0, i1;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] opcode;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] address;</span><br><span class="line">&#125; instruction_word_t;</span><br><span class="line">    instruction_word_t IW;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">    <span class="keyword">if</span> (!resetN)</span><br><span class="line">    	IW = ’&#123; <span class="keyword">real</span>:<span class="number">1</span><span class="variable">.0</span>, <span class="keyword">default</span>:<span class="number">0</span> &#125;;</span><br><span class="line">    	<span class="comment">// assign all real members a default of 1.0</span></span><br><span class="line">    	<span class="comment">// and all other members a default of 0</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">    	...</span><br><span class="line">    <span class="keyword">end</span></span><br></pre></td></tr></table></figure>



<p>default value precedence</p>
<p>结构成员如何赋值是有优先顺序的。 default 关键字的优先级最低，将被任何特定于类型的默认值覆盖。特定类型的默认值将被任何显式命名的成员值覆盖。下面的结构表达式将为 r0 赋值 1.0，为 r1 赋值 3.1415，并将结构的所有其他成员赋值为 0。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="keyword">real</span> r0, r1;</span><br><span class="line">    <span class="keyword">int</span> i0, i1;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] opcode;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] address;</span><br><span class="line">&#125; instruction_word_t;</span><br><span class="line"></span><br><span class="line">instruction_word_t IW;</span><br><span class="line"></span><br><span class="line">	IW = ’&#123; <span class="keyword">real</span>:<span class="number">1</span><span class="variable">.0</span>, <span class="keyword">default</span>:<span class="number">0</span>, r1:<span class="number">3</span><span class="variable">.1415</span> &#125;;</span><br></pre></td></tr></table></figure>

<h4 id="打包和解包结构"><a href="#打包和解包结构" class="headerlink" title="打包和解包结构"></a>打包和解包结构</h4><blockquote>
<p>unpacked structures can have padding</p>
</blockquote>
<p>默认情况下，结构体是解包的。这意味着结构体的成员被视为独立变量或常量，它们以共同的名称组合在一起。 SystemVerilog 未指定软件工具应如何存储解压缩结构体的成员。存储的布局可能因一种软件工具而异。</p>
<blockquote>
<p>packed structures are stored without padding</p>
</blockquote>
<p>可以使用 packed 关键字将结构体显式声明为打包结构体。压缩结构体以指定的顺序将结构体的所有成员存储为连续位。压缩结构存体储为向量，结构体的第一个成员是向量的最左侧字段。结构体中最后一个成员的最右边位是向量的最低有效位，编号为第 0 位。如图 5-1 所示。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="keyword">packed</span> &#123;</span><br><span class="line">    <span class="keyword">logic</span> valid;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] tag;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] data;</span><br><span class="line">&#125; data_word;</span><br></pre></td></tr></table></figure>

<p>Figure 5-1: Packed structures are stored as a vector</p>
<table>
<thead>
<tr>
<th align="right">valid</th>
<th align="right">tag</th>
<th align="right">data</th>
</tr>
</thead>
<tbody><tr>
<td align="right">40-39</td>
<td align="right">31</td>
<td align="right">15        0</td>
</tr>
</tbody></table>
<p>压缩结构的成员可以通过成员的名称或使用结构表示的向量的部分选择来引用。以下两个赋值都将赋值给 data_word 结构体的tag成员：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data_word<span class="variable">.tag</span>    = <span class="number">8</span>’hf0;</span><br><span class="line">data_word[<span class="number">39</span>:<span class="number">32</span>] = <span class="number">8</span>’hf0; <span class="comment">// same bits as tag</span></span><br></pre></td></tr></table></figure>

<p><strong>Packed structures can only contain integral values</strong></p>
<blockquote>
<p>packed structures must contain packed variables</p>
</blockquote>
<p>压缩结构的所有成员必须是整数值。整数值是可以表示为向量的值，例如字节、整数和使用位或逻辑类型创建的向量。如果结构的任何成员不能表示为向量，则该结构不能被打包。这意味着压缩结构不能包含<strong>real</strong>或<strong>shortreal</strong>变量、unpacked结构体、unpacked联合体或unpacked数组。</p>
<h5 id="包装结构的操作"><a href="#包装结构的操作" class="headerlink" title="包装结构的操作"></a>包装结构的操作</h5><blockquote>
<p>packed structures are seen as vectors</p>
</blockquote>
<p>因为打包结构存储为向量，所以对完整结构的操作被视为向量操作。因此，可以对向量执行的数学运算、逻辑运算和任何其他运算也可以在压缩结构上执行。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="keyword">packed</span> &#123;</span><br><span class="line">    <span class="keyword">logic</span> valid;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] tag;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] data;</span><br><span class="line">&#125; data_word_t;</span><br><span class="line"></span><br><span class="line">data_word_t packet_in, packet_out;</span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clock)</span><br><span class="line">	packet_out &lt;= packet_in &lt;&lt; <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<h5 id="signed-packed-结构体"><a href="#signed-packed-结构体" class="headerlink" title="signed packed 结构体"></a>signed packed 结构体</h5><blockquote>
<p>a packed structures used as a vector can be signed or unsigned</p>
</blockquote>
<p>压缩结构体可以用有<strong>signed</strong>或<strong>unsigned</strong>关键字声明。当在数学或关系运算中用作向量时，这些修饰符会影响整个结构的感知方式。它们不影响结构成员的感知方式。根据该成员的类型声明，结构的每个成员都被视为有符号或无符号。压缩结构的部分选择始终是无符号的，与 Verilog 中向量的部分选择相同。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="keyword">packed</span> <span class="keyword">signed</span> &#123;</span><br><span class="line">    <span class="keyword">logic</span> valid;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] tag;</span><br><span class="line">    <span class="keyword">logic</span> <span class="keyword">signed</span> [<span class="number">31</span>:<span class="number">0</span>] data;</span><br><span class="line">&#125; data_word_t;</span><br><span class="line"></span><br><span class="line">	data_word_t A, B;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clock)</span><br><span class="line">		<span class="keyword">if</span> ( A &lt; B ) <span class="comment">// signed comparison</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>



<h4 id="通过端口传递结构"><a href="#通过端口传递结构" class="headerlink" title="通过端口传递结构"></a>通过端口传递结构</h4><blockquote>
<p>ports can be declared as a structure type</p>
</blockquote>
<p>结构体可以通过模块和接口端口传递。必须首先使用 <strong>typedef</strong> 将结构体定义为用户定义的类型，然后才能将模块或接口端口声明为结构体类型。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> definitions;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;ADD, SUB, MULT, DIV&#125; opcode_t;</span><br><span class="line">        <span class="keyword">typedef</span> <span class="keyword">struct</span> &#123; </span><br><span class="line">        <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a, b;</span><br><span class="line">        opcode_t opcode;</span><br><span class="line">        <span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] address;</span><br><span class="line">        <span class="keyword">logic</span> error;</span><br><span class="line">    &#125; instruction_word_t;</span><br><span class="line"><span class="keyword">endpackage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> alu (</span><br><span class="line">    <span class="keyword">input</span> definitions::instruction_word_t IW,</span><br><span class="line">	<span class="keyword">input</span> <span class="keyword">wire</span> clock</span><br><span class="line">);</span><br><span class="line">	...</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p>将包含 typedef 定义的包显式命名为模块端口的一部分的另一种样式是将包导入 $unit 编译单元声明空间。也可以直接在 $unit 空间中定义用户定义的类型。第 2 章讨论了导入包和使用 $unit 编译单元空间。</p>
<p>当一个解压的结构体通过模块端口传递时，必须在端口的每一侧连接一个完全相同类型的结构。在两个不同模块中声明的匿名结构，即使它们具有完全相同的名称、成员和成员名称，也不是同一类型的结构体。</p>
<h4 id="将结构作为参数传递给任务和函数"><a href="#将结构作为参数传递给任务和函数" class="headerlink" title="将结构作为参数传递给任务和函数"></a>将结构作为参数传递给任务和函数</h4><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> processor (...);</span><br><span class="line">	...</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;ADD, SUB, MULT, DIV&#125; opcode_t;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">struct</span> &#123; <span class="comment">// typedef is local</span></span><br><span class="line">        <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a, b;</span><br><span class="line">        opcode_t opcode;</span><br><span class="line">        <span class="keyword">logic</span> [<span class="number">23</span>:<span class="number">0</span>] address;</span><br><span class="line">        <span class="keyword">logic</span> error;</span><br><span class="line">    &#125; instruction_word_t;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> alu (<span class="keyword">input</span> instruction_word_t IW);</span><br><span class="line">   	 	...</span><br><span class="line">    <span class="keyword">endfunction</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p>当调用具有解压缩结构作为形式参数的任务或函数时，必须将完全相同类型的结构传递给任务或函数。匿名结构，即使它具有完全相同的成员和成员名称，也不是同一类型的结构。</p>
<h4 id="综合指南-2"><a href="#综合指南-2" class="headerlink" title="综合指南"></a>综合指南</h4><p>解压缩和压缩结构都是<strong>可综合</strong>的。综合支持通过module port 传递结构，以及 in/out  of<br>tasks  and  functions。支持按成员名称和值列表为结构分配值。</p>
<h3 id="5-2Unions-联合体"><a href="#5-2Unions-联合体" class="headerlink" title="5.2Unions 联合体"></a>5.2Unions 联合体</h3><blockquote>
<p>声明：</p>
</blockquote>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span>（</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">int</span> <span class="keyword">unsigned</span> u;</span><br><span class="line">） data;</span><br><span class="line">	...</span><br><span class="line">data<span class="variable">.i</span> = -<span class="number">5</span>;</span><br><span class="line"><span class="built_in">$display</span>(<span class="string">&quot;data is %d&quot;</span>,data<span class="variable">.i</span>);</span><br><span class="line"></span><br><span class="line">data<span class="variable">.u</span> = -<span class="number">5</span>;</span><br><span class="line"><span class="built_in">$display</span>(<span class="string">&quot;now data is %d&quot;</span>,data<span class="variable">.u</span>);</span><br></pre></td></tr></table></figure>

<p><strong>联合体减少存储并可能提高性能</strong></p>
<p>虽然声明语法相似，但联合与结构有很大不同。一个结构可以存储多个值。它是单一名称下的变量集合。一个联合只能存储一个值。联合的典型应用是当一个值可以表示为几种不同的类型，但在任何特定时刻仅作为一种类型。</p>
<p><strong>Typed and anonymous unions</strong></p>
<p>可以使用 typedef 将联合定义为类型，就像结构一样。定义为用户定义类型的联合称为类型化联合。如果不使用 typedef，则联合称为匿名联合。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">union</span> &#123; <span class="comment">// typed union </span></span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">int</span> <span class="keyword">unsigned</span> u;</span><br><span class="line">&#125; data_t;</span><br><span class="line"></span><br><span class="line">data_t a, b; <span class="comment">// two variables of type data_t</span></span><br></pre></td></tr></table></figure>

<h4 id="Unpacked-unions"><a href="#Unpacked-unions" class="headerlink" title="Unpacked unions"></a>Unpacked unions</h4><p><strong>Unpacked  unions  are  not  synthesizable.</strong>   对于系统级和传输级是有用的。</p>
<h4 id="Packed-unions"><a href="#Packed-unions" class="headerlink" title="Packed unions"></a>Packed unions</h4><p>packed unions are syntheiszable。</p>
<p>  A  packed  union cannot contain real or shortreal variables, unpacked structures,<br>unpacked unions, or unpacked arrays.</p>
<h4 id="An-example-of-using-structures-and-unions"><a href="#An-example-of-using-structures-and-unions" class="headerlink" title="An example of using structures and unions"></a>An example of using structures and unions</h4><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> definitions;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;ADD, SUB, MULT, DIV, SL, SR&#125; opcode_t;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;UNSIGNED, SIGNED&#125; operand_type_t;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">union</span> <span class="keyword">packed</span> &#123;</span><br><span class="line">        <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] u_data;</span><br><span class="line">        <span class="keyword">logic</span> <span class="keyword">signed</span> [<span class="number">31</span>:<span class="number">0</span>] s_data;</span><br><span class="line">    &#125; data_t;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="keyword">packed</span> &#123;</span><br><span class="line">        opcode_t opc;</span><br><span class="line">        operand_type_t op_type;</span><br><span class="line">        data_t op_a;</span><br><span class="line">        data_t op_b;</span><br><span class="line">    &#125; instr_t;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">endpackage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> definitions::*; <span class="comment">// import package into $unit space</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> alu </span><br><span class="line">(<span class="keyword">input</span> instr_t IW,</span><br><span class="line"><span class="keyword">output</span> data_t alu_out);</span><br><span class="line">    <span class="keyword">always</span> @(IW) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (IW<span class="variable">.op_type</span> == SIGNED) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">case</span> (IW<span class="variable">.opc</span>)</span><br><span class="line">                ADD : alu_out<span class="variable">.s_data</span> = IW<span class="variable">.op_a</span><span class="variable">.s_data</span> + IW<span class="variable">.op_b</span><span class="variable">.s_data</span>;</span><br><span class="line">                SUB : alu_out<span class="variable">.s_data</span> = IW<span class="variable">.op_a</span><span class="variable">.s_data</span> - IW<span class="variable">.op_b</span><span class="variable">.s_data</span>;</span><br><span class="line">                MULT: alu_out<span class="variable">.s_data</span> = IW<span class="variable">.op_a</span><span class="variable">.s_data</span> * IW<span class="variable">.op_b</span><span class="variable">.s_data</span>;</span><br><span class="line">                DIV : alu_out<span class="variable">.s_data</span> = IW<span class="variable">.op_a</span><span class="variable">.s_data</span> / IW<span class="variable">.op_b</span><span class="variable">.s_data</span>;</span><br><span class="line">                SL  : alu_out<span class="variable">.s_data</span> = IW<span class="variable">.op_a</span><span class="variable">.s_data</span> &lt;&lt;&lt; <span class="number">2</span>;</span><br><span class="line">                SR  : alu_out<span class="variable">.s_data</span> = IW<span class="variable">.op_a</span><span class="variable">.s_data</span> &gt;&gt;&gt; <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">case</span> (IW<span class="variable">.opc</span>)</span><br><span class="line">                ADD : alu_out<span class="variable">.u_data</span> = IW<span class="variable">.op_a</span><span class="variable">.u_data</span> + IW<span class="variable">.op_b</span><span class="variable">.u_data</span>;</span><br><span class="line">                SUB : alu_out<span class="variable">.u_data</span> = IW<span class="variable">.op_a</span><span class="variable">.u_data</span> - IW<span class="variable">.op_b</span><span class="variable">.u_data</span>;</span><br><span class="line">                MULT: alu_out<span class="variable">.u_data</span> = IW<span class="variable">.op_a</span><span class="variable">.u_data</span> * IW<span class="variable">.op_b</span><span class="variable">.u_data</span>;</span><br><span class="line">                DIV : alu_out<span class="variable">.u_data</span> = IW<span class="variable">.op_a</span><span class="variable">.u_data</span> / IW<span class="variable">.op_b</span><span class="variable">.u_data</span>;</span><br><span class="line">                SL  : alu_out<span class="variable">.u_data</span> = IW<span class="variable">.op_a</span><span class="variable">.u_data</span> &lt;&lt; <span class="number">2</span>;</span><br><span class="line">                SR  : alu_out<span class="variable">.u_data</span> = IW<span class="variable">.op_a</span><span class="variable">.u_data</span> &gt;&gt; <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>



<h3 id="5-3-Arrays"><a href="#5-3-Arrays" class="headerlink" title="5.3 Arrays"></a>5.3 Arrays</h3><h4 id="unpacked-arrays"><a href="#unpacked-arrays" class="headerlink" title="unpacked arrays"></a>unpacked arrays</h4><p>verilog-1995 标准中：支持数组：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;data_type&gt; &lt;vector_size&gt; &lt;array_name&gt; &lt;array_dimensions&gt;</span><br><span class="line">For example:</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">15</span>:<span class="number">0</span>] RAM [<span class="number">0</span>:<span class="number">4095</span>]; <span class="comment">// memory array</span></span><br></pre></td></tr></table></figure>

<p>verilog-2001 对数组的支持进行了增强：</p>
<ul>
<li>支持任何变量或者net 类型，不支持event 类型。</li>
<li>支持3维数组的使用</li>
</ul>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a 1-dimensional unpacked array of</span></span><br><span class="line"><span class="comment">// 1024 1-bit nets</span></span><br><span class="line"><span class="keyword">wire</span> n [<span class="number">0</span>:<span class="number">1023</span>];</span><br><span class="line"><span class="comment">// a 1-dimensional unpacked array of</span></span><br><span class="line"><span class="comment">// 256 8-bit variables</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] LUT [<span class="number">0</span>:<span class="number">255</span>];</span><br><span class="line"><span class="comment">// a 1-dimensional unpacked array of </span></span><br><span class="line"><span class="comment">// 1024 real variables</span></span><br><span class="line"><span class="keyword">real</span> r [<span class="number">0</span>:<span class="number">1023</span>];</span><br><span class="line"><span class="comment">// a 3-dimensional unpacked array of</span></span><br><span class="line"><span class="comment">// 32-bit int variables</span></span><br><span class="line"><span class="keyword">integer</span> i [<span class="number">7</span>:<span class="number">0</span>][<span class="number">3</span>:<span class="number">0</span>][<span class="number">7</span>:<span class="number">0</span>];</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Verilog 一次限制数组访问一个元素</p>
</blockquote>
<p>Verilog 限制对数组同一时间只能访问数组的一个元素，或者单个元素的位选择或部分选择。对数组的多个元素的任何读取或写入都是错误的。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">integer</span> i [<span class="number">7</span>:<span class="number">0</span>][<span class="number">3</span>:<span class="number">0</span>][<span class="number">7</span>:<span class="number">0</span>]; </span><br><span class="line"><span class="keyword">integer</span> j;</span><br><span class="line">j = i[<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]; <span class="comment">// legal: selects 1 element</span></span><br><span class="line">j = i[<span class="number">3</span>][<span class="number">0</span>]; <span class="comment">// illegal: selects 8 elements</span></span><br></pre></td></tr></table></figure>



<p>system verilog 允许未打包的数组可以是任意类型：</p>
<ul>
<li>支持event</li>
<li>支持logic，bit,byte, int , longint,shortreal,real。</li>
<li>typedef</li>
<li>struct,enum</li>
</ul>
<p>example:</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bit</span> [<span class="number">63</span>:<span class="number">0</span>] d_array [<span class="number">1</span>:<span class="number">128</span>]; <span class="comment">// array of vectors</span></span><br><span class="line"><span class="keyword">shortreal</span> cosines [<span class="number">0</span>:<span class="number">89</span>]; 	<span class="comment">// array of floats</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;Mo, Tu, We, Th, Fr, Sa, Su&#125; Week;</span><br><span class="line">Week Year [<span class="number">1</span>:<span class="number">52</span>]; 			<span class="comment">// array of Week types</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>SystemVerilog 可以引用数组的全部或切片</p>
</blockquote>
<p>SystemVerilog 还为 Verilog 添加了引用整个解压缩数组或解压缩数组中多个元素的切片的能力。切片是数组的一维内的一个或多个连续编号的元素。这些增强功能可以将整个数组的内容或数组的特定维度复制到另一个数组中。</p>
<blockquote>
<p>拷贝多个元素到未打包的数组中</p>
</blockquote>
<p>为了将多个元素直接复制到一个解包数组中，赋值左侧的数组或数组切片的布局和元素类型必须与右侧的布局和元素类型完全匹配。即元素类型和大小以及复制的维数必须相同。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a1 [<span class="number">7</span>:<span class="number">0</span>][<span class="number">1023</span>:<span class="number">0</span>]; 	<span class="comment">// unpacked array</span></span><br><span class="line"><span class="keyword">int</span> a2 [<span class="number">1</span>:<span class="number">8</span>][<span class="number">1</span>:<span class="number">1024</span>]; 	<span class="comment">// unpacked array</span></span><br><span class="line">a2 = a1; 				<span class="comment">// copy an entire array</span></span><br><span class="line">a2[<span class="number">3</span>] = a1[<span class="number">0</span>]; 			<span class="comment">// copy a slice of an array</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>简化的解包数组声明</p>
</blockquote>
<p>verilog array declarations</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> array [<span class="number">64</span>:<span class="number">83</span>]; 	<span class="comment">//a Verilog array with addresses from 64 to 83</span></span><br></pre></td></tr></table></figure>



<p>system verilog array declarations </p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// C-style array declarations </span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] data[<span class="number">1024</span>];</span><br><span class="line"><span class="comment">// is equivalent to the declaration:</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] data [<span class="number">0</span>:<span class="number">1023</span>];</span><br></pre></td></tr></table></figure>

<p>简化的 C 样式数组声明不能与向量声明（压缩数组）一起使用。以下示例是语法错误。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">logic</span> [<span class="number">32</span>] d; <span class="comment">// illegal vector declaration</span></span><br></pre></td></tr></table></figure>



<h4 id="Packed-arrays"><a href="#Packed-arrays" class="headerlink" title="Packed arrays"></a>Packed arrays</h4><p>Verilog 语言允许从单个位类型（例如 reg 和 wire）创建向量。向量范围在信号名称之前，而unpacked的数组范围在信号名称之后。</p>
<p>1D</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] select;  <span class="comment">// 4-bit &quot;packed array&quot;</span></span><br><span class="line"><span class="keyword">reg</span>  [<span class="number">63</span>:<span class="number">0</span>] data; 	<span class="comment">// 64-bit &quot;packed array&quot;</span></span><br></pre></td></tr></table></figure>

<p>SystemVerilog 允许多维打包数组</p>
<p>M-D</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>][<span class="number">7</span>:<span class="number">0</span>] data; <span class="comment">// 2-D packed array</span></span><br></pre></td></tr></table></figure>



<p><strong>Only bit-wise types can be packed</strong></p>
<p>Packed arrays must be formed using bit-wise types (logic, bit or reg),  other  packed  arrays,  packed  structures,  and  packed  unions. Packed arrays can also be formed from any of the Verilog net data types  (wire, uwire, wand, tri, triand, trior, tri0, tri1  or<br>trireg).</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="keyword">packed</span> &#123;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">7</span>:<span class="number">0</span>] crc	;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">63</span>:<span class="number">0</span>] data;</span><br><span class="line">&#125; data_word;</span><br><span class="line"></span><br><span class="line">data_word [<span class="number">7</span>:<span class="number">0</span>] darray; <span class="comment">//1D packed array of packed structures</span></span><br></pre></td></tr></table></figure>



<h5 id="引用打包数组"><a href="#引用打包数组" class="headerlink" title="引用打包数组"></a>引用打包数组</h5><p>打包数组可以作为一个整体、位选择或部分选择来引用。多维打包数组也可以在切片中引用。切片是数组的一个或多个连续维度。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>][<span class="number">7</span>:<span class="number">0</span>] data; 			<span class="comment">// 2-D packed array</span></span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] out = data;	 		<span class="comment">// whole array</span></span><br><span class="line"><span class="keyword">wire</span> sign = data[<span class="number">3</span>][<span class="number">7</span>]; 		<span class="comment">// bit-select</span></span><br><span class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] nib = data [<span class="number">0</span>][<span class="number">3</span>:<span class="number">0</span>]; <span class="comment">// part-select</span></span><br><span class="line"><span class="keyword">byte</span> high_byte;</span><br><span class="line"><span class="keyword">assign</span> high_byte = data[<span class="number">3</span>]; 	<span class="comment">// 8-bit slice</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] word;</span><br><span class="line"><span class="keyword">assign</span> word = data[<span class="number">1</span>:<span class="number">0</span>]; 		<span class="comment">// 2 slices</span></span><br></pre></td></tr></table></figure>

<h4 id="Using-packed-and-unpacked-arrays"><a href="#Using-packed-and-unpacked-arrays" class="headerlink" title="Using packed and unpacked arrays"></a>Using packed and unpacked arrays</h4><p>将多维数组声明为打包数组或解包数组的能力为如何表示大量复杂数据提供了极大的灵活性。以下是关于何时使用每种类型的数组的一些一般准则。</p>
<blockquote>
<p>使用解包数组建模：</p>
</blockquote>
<ul>
<li>Arrays  of  byte, int, integer, real,  unpacked  structures,unpacked unions, and other types that are not bit-wise types</li>
<li>Arrays where typically one element at a time is accessed, such as with RAMs and ROMs</li>
</ul>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> ROM (...);</span><br><span class="line">    <span class="keyword">byte</span> mem [<span class="number">0</span>:<span class="number">4095</span>]; <span class="comment">// unpacked array of bytes</span></span><br><span class="line">    <span class="keyword">assign</span> data = select? mem[address]: ’z;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>使用打包数组建模:</p>
</blockquote>
<ul>
<li>Vectors made up of 1-bit types (the same as in Verilog)</li>
<li>Vectors where it is useful to access sub-fields of the vector</li>
</ul>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">logic</span> [<span class="number">39</span>:<span class="number">0</span>][<span class="number">15</span>:<span class="number">0</span>] packet; 	<span class="comment">// 40 16-bit words</span></span><br><span class="line">packet = input_stream; 		<span class="comment">// assign to all words</span></span><br><span class="line">data = packet[<span class="number">24</span>]; 			<span class="comment">// select 1 16-bit word</span></span><br><span class="line">tag = packet[<span class="number">3</span>][<span class="number">7</span>:<span class="number">0</span>]; 		<span class="comment">// select part of 1 word</span></span><br></pre></td></tr></table></figure>

<h4 id="声明数组时初始化"><a href="#声明数组时初始化" class="headerlink" title="声明数组时初始化"></a>声明数组时初始化</h4><h5 id="Packed-数组初始化"><a href="#Packed-数组初始化" class="headerlink" title="Packed 数组初始化"></a>Packed 数组初始化</h5><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>][<span class="number">7</span>:<span class="number">0</span>] a = <span class="number">32</span>’h0; <span class="comment">// vector assignment</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>][<span class="number">7</span>:<span class="number">0</span>] b = &#123;<span class="number">16</span>’hz,<span class="number">16</span>’h0&#125;; <span class="comment">// concatenate operator</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>][<span class="number">7</span>:<span class="number">0</span>] c = &#123;<span class="number">16</span>&#123;<span class="number">2</span>’b01&#125;&#125;; <span class="comment">// replicate operator</span></span><br></pre></td></tr></table></figure>

<h5 id="Unpacked-数组初始化"><a href="#Unpacked-数组初始化" class="headerlink" title="Unpacked 数组初始化"></a>Unpacked 数组初始化</h5><p>解压数组可以在声明时初始化，使用包含在每个数组维度的 ‘{ 和 } 大括号之间的值列表。此语法类似于将值列表分配给 C 中的数组，但在左大括号之前添加了撇号。使用 ‘{ 作为开始分隔符表明封闭的值是表达式列表，而不是表达式的 Verilog 连接。请注意，省略内括号的 C 快捷方式在 SystemVerilog 中是不允许的。该赋值需要嵌套的大括号集，它们与数组的维度完全匹配。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> d [<span class="number">0</span>:<span class="number">1</span>][<span class="number">0</span>:<span class="number">3</span>] = ’&#123; ’&#123;<span class="number">7</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">5</span>&#125;, ’&#123;<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">6</span>&#125; &#125;;</span><br><span class="line"><span class="comment">// d[0][0] = 7 </span></span><br><span class="line"><span class="comment">// d[0][1] = 3 </span></span><br><span class="line"><span class="comment">// d[0][2] = 0 </span></span><br><span class="line"><span class="comment">// d[0][3] = 5 </span></span><br><span class="line"><span class="comment">// d[1][0] = 2 </span></span><br><span class="line"><span class="comment">// d[1][1] = 0 </span></span><br><span class="line"><span class="comment">// d[1][2] = 1 </span></span><br><span class="line"><span class="comment">// d[1][3] = 6 </span></span><br></pre></td></tr></table></figure>

<p>SystemVerilog 提供了声明值列表的快捷方式。数组的一维内部列表可以使用类似 Verilog 的复制因子重复任意次数。复制因子后面没有撇号。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> e [<span class="number">0</span>:<span class="number">1</span>][<span class="number">0</span>:<span class="number">3</span>] = ’&#123; <span class="number">2</span>&#123;<span class="number">7</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">5</span>&#125; &#125;;</span><br><span class="line"><span class="comment">// e[0][0] = 7 </span></span><br><span class="line"><span class="comment">// e[0][1] = 3 </span></span><br><span class="line"><span class="comment">// e[0][2] = 0 </span></span><br><span class="line"><span class="comment">// e[0][3] = 5 </span></span><br><span class="line"><span class="comment">// e[1][0] = 7 </span></span><br><span class="line"><span class="comment">// e[1][1] = 3 </span></span><br><span class="line"><span class="comment">// e[1][2] = 0 </span></span><br><span class="line"><span class="comment">// e[1][3] = 5</span></span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：The ’{ } list and ’{n{ }}  replicated list operators are not the same  as  the  Verilog  { }   concatenate  and  {n{ }}   replicate operators.</p>
<h4 id="数组赋值"><a href="#数组赋值" class="headerlink" title="数组赋值"></a>数组赋值</h4><h5 id="Unpacked-arrays-赋值"><a href="#Unpacked-arrays-赋值" class="headerlink" title="Unpacked arrays 赋值"></a>Unpacked arrays 赋值</h5><p>Verilog 语言支持两种给解压数组赋值的方法：</p>
<ul>
<li>单个元素的赋值方法</li>
<li>可以为单个元素的位选择或部分选择分配一个值（作为 Verilog-2001 标准的一部分添加）。可以将数组初始化为默认值</li>
</ul>
<p>SystemVerilog 扩展了 Verilog，增加了两种将值分配给解包数组的方法</p>
<ul>
<li>可以为整个数组分配一个值列表。 </li>
<li>可以为数组的一个切片分配一个值列表</li>
</ul>
<p>The  list  of  values  is  specified  between  ’{ }  braces,  the  same  as with  initializing  unpacked  arrays,  as  discussed  in  section  5.3.4  on page 119.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">byte</span> a [<span class="number">0</span>:<span class="number">3</span>][<span class="number">0</span>:<span class="number">3</span>];</span><br><span class="line">a[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">8</span>’h5; <span class="comment">// assign to one element</span></span><br><span class="line">a = ’&#123;’&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;,</span><br><span class="line">    ’&#123;<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>&#125;,</span><br><span class="line">    ’&#123;<span class="number">7</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>&#125;,</span><br><span class="line">    ’&#123;<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>&#125;&#125;;</span><br><span class="line"><span class="comment">// assign a list of values to the full array</span></span><br><span class="line">a[<span class="number">3</span>] = ’&#123;’hF, ’hA, ’hC, ’hE&#125;;</span><br><span class="line"><span class="comment">// assign list of values to slice of the array</span></span><br></pre></td></tr></table></figure>

<p>example2：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//using  the  default  keyword</span></span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">    <span class="keyword">if</span> (!resetN) <span class="keyword">begin</span></span><br><span class="line">        a = ’&#123;<span class="keyword">default</span>:<span class="number">0</span>&#125;;    <span class="comment">// init entire array</span></span><br><span class="line">        a[<span class="number">0</span>] = ’&#123;<span class="keyword">default</span>:<span class="number">4</span>&#125;; <span class="comment">// init slice of array</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    <span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h5 id="Packed-arrays-赋值"><a href="#Packed-arrays-赋值" class="headerlink" title="Packed arrays 赋值"></a>Packed arrays 赋值</h5><p>压缩数组是向量（可能恰好有子字段），并且可以赋值，就像 Verilog 向量一样。可以为打包数组分配一个值：</p>
<ul>
<li><p>到数组的一个元素</p>
</li>
<li><p> 到整个数组（向量）</p>
</li>
<li><p>To a part select of the array</p>
</li>
<li><p>To a slice (multiple contiguous sub-fields) of the array</p>
</li>
</ul>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">logic</span> [<span class="number">1</span>:<span class="number">0</span>][<span class="number">1</span>:<span class="number">0</span>][<span class="number">7</span>:<span class="number">0</span>] a; 	<span class="comment">// 3-D packed array</span></span><br><span class="line">a[<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>’b0; 			<span class="comment">// assign to one bit</span></span><br><span class="line">a = <span class="number">32</span>’hF1A3C5E7; 			<span class="comment">// assign to full array</span></span><br><span class="line">a[<span class="number">1</span>][<span class="number">0</span>][<span class="number">3</span>:<span class="number">0</span>] = <span class="number">4</span>’hF; 		<span class="comment">// assign to a part select</span></span><br><span class="line">a[<span class="number">0</span>] = <span class="number">16</span>’hFACE; 			<span class="comment">// assign to a slice</span></span><br><span class="line">a = &#123;<span class="number">16</span>’bz, <span class="number">16</span>’b0&#125;; 		<span class="comment">// assign concatenation </span></span><br></pre></td></tr></table></figure>

<h4 id="数组复制"><a href="#数组复制" class="headerlink" title="数组复制"></a>数组复制</h4><p>assigning packed array to packed array is allowed：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bit</span> [<span class="number">1</span>:<span class="number">0</span>][<span class="number">15</span>:<span class="number">0</span>] a; <span class="comment">// 32 bit 2-state vector</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>][ <span class="number">7</span>:<span class="number">0</span>] b; <span class="comment">// 32 bit 4-state vector</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] c; <span class="comment">// 16 bit 4-state vector</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">39</span>:<span class="number">0</span>] d; <span class="comment">// 40 bit 4-state vector</span></span><br><span class="line">b = a; <span class="comment">// assign 32-bit array to 32-bit array</span></span><br><span class="line">c = a; <span class="comment">// upper 16 bits will be truncated</span></span><br><span class="line">d = a; <span class="comment">// upper 8 bits will be zero filled</span></span><br></pre></td></tr></table></figure>

<p>assigning unpacked array to unpacked array is allowed</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] a [<span class="number">2</span>:<span class="number">0</span>][<span class="number">9</span>:<span class="number">0</span>];</span><br><span class="line"><span class="keyword">logic</span> [<span class="number">0</span>:<span class="number">31</span>] b [<span class="number">1</span>:<span class="number">3</span>][<span class="number">1</span>:<span class="number">10</span>]; </span><br><span class="line">a = b; <span class="comment">// assign unpacked array to unpacked array</span></span><br></pre></td></tr></table></figure>

<p>assigning unpacked arrays of different sizes requires casting</p>
<p>assigning unpacked arrays to packed arrays requires casting</p>
<p>assigning packed arrays to unpacked arrays requires casting</p>
<h4 id="将用户定义的类型与数组一起使用"><a href="#将用户定义的类型与数组一起使用" class="headerlink" title="将用户定义的类型与数组一起使用"></a>将用户定义的类型与数组一起使用</h4><p>用户定义的类型可以用作数组的元素。下面的例子定义了一个无符号整数的用户类型，并声明了一个由 128 个无符号整数组成的解压数组。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> <span class="keyword">unsigned</span> uint;</span><br><span class="line">uint u_array [<span class="number">0</span>:<span class="number">127</span>]; <span class="comment">// array of user types</span></span><br></pre></td></tr></table></figure>

<p>User-defined  types  can  also  be  defined  from  an  array  definition. These user types can then be used in other array definitions, creating a compound array.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>] nibble; <span class="comment">// packed array</span></span><br><span class="line">nibble [<span class="number">31</span>:<span class="number">0</span>] big_word; <span class="comment">// packed array</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//The preceding example is equivalent to:</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>][<span class="number">3</span>:<span class="number">0</span>] big_word;</span><br></pre></td></tr></table></figure>

<p>Another  example  of  a  compound  array  built  up  from  user-defined types is:</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>] nibble; <span class="comment">// packed array</span></span><br><span class="line"><span class="keyword">typedef</span> nibble nib_array [<span class="number">0</span>:<span class="number">3</span>]; <span class="comment">// unpacked</span></span><br><span class="line">nib_array compound_array [<span class="number">0</span>:<span class="number">7</span>]; <span class="comment">// unpacked</span></span><br><span class="line">This last example is equivalent to:</span><br><span class="line"><span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>] compound_array [<span class="number">0</span>:<span class="number">7</span>][<span class="number">0</span>:<span class="number">3</span>];</span><br></pre></td></tr></table></figure>



<h4 id="综合指南-3"><a href="#综合指南-3" class="headerlink" title="综合指南"></a>综合指南</h4><p>数组和涉及数组的赋值是可综合的。具体来说：数组可以包含结构或联合 结构和联合可以包含数组：</p>
<ul>
<li>Arrays declarations — Both unpacked and packed arrays are synthesizable. The arrays can have any number of dimensions.</li>
<li>Assigning values to arrays — synthesis supports assigning values to individual elements of an array, bit-selects or part-selects of an array element, array slices, or entire arrays. Assigning lists of literal values to arrays is also synthesizable, including literals using the <strong>default</strong> keyword. </li>
<li>Copying  arrays  —  Synthesis  supports  packed  arrays  directly assigned  to  packed  arrays.  Synthesis  also  supports  unpacked arrays  directly  assigned  to  unpacked  arrays  of  the  same  layout. Assigning any type of array to any type of array using bit-stream casting is also synthesizable.</li>
<li>Arrays in structures and unions — The use of arrays within structures and unions is synthesizable. <strong>Unions</strong> must be <strong>packed</strong>, which means arrays within the union must be packed).</li>
<li>Arrays of structures or unions — Arrays of structures and arrays of unions are synthesizable (unions must be packed). A structure or  union  must  be  typed  (using  <strong>typedef</strong>)  in  order  to  define  an array of the <strong>structure</strong> or <strong>union</strong>.</li>
<li>Passing  arrays  —  Arrays  passed  through  <strong>module  ports</strong>,  or  as arguments to a <strong>task</strong> or <strong>function</strong>, is <strong>synthesizable</strong></li>
</ul>
<h4 id="使用数组的示例"><a href="#使用数组的示例" class="headerlink" title="使用数组的示例"></a>使用数组的示例</h4><p>以下示例使用 32 条指令的压缩数组对指令寄存器进行建模。每条指令都是一个复合值，表示为一个压缩结构。指令中的操作数可以是有符号或无符号的，它们表示为两种类型的并集。该指令寄存器的输入是单独的操作数、操作码和指示操作数是有符号还是无符号的标志。该模型将这些单独的信息加载到指令寄存器中。模型的输出是 32 条指令的数组</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> definitions;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;ADD, SUB, MULT, DIV, SL, SR&#125; opcode_t;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;UNSIGNED, SIGNED&#125; operand_type_t;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">union</span> <span class="keyword">packed</span> &#123;</span><br><span class="line">        <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] u_data;</span><br><span class="line">		<span class="keyword">logic</span> <span class="keyword">signed</span> [<span class="number">31</span>:<span class="number">0</span>] s_data;</span><br><span class="line">	&#125; data_t;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="keyword">packed</span> &#123;</span><br><span class="line">        opcode_t opc;</span><br><span class="line">        operand_type_t op_type;</span><br><span class="line">        data_t op_a;</span><br><span class="line">        data_t op_b;</span><br><span class="line">    &#125; instr_t;</span><br><span class="line"><span class="keyword">endpackage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> definitions::*; <span class="comment">// import package into $unit space</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> instruction_register (</span><br><span class="line">        <span class="keyword">output</span> instr_t [<span class="number">0</span>:<span class="number">31</span>] instr_reg, <span class="comment">// packed array of structures</span></span><br><span class="line">        <span class="keyword">input</span> data_t operand_a,</span><br><span class="line">        <span class="keyword">input</span> data_t operand_b,</span><br><span class="line">        <span class="keyword">input</span> operand_type_t op_type,</span><br><span class="line">        <span class="keyword">input</span> opcode_t opcode,</span><br><span class="line">        <span class="keyword">input</span> <span class="keyword">logic</span> [<span class="number">4</span>:<span class="number">0</span>] write_pointer</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">always</span> @(write_pointer) <span class="keyword">begin</span></span><br><span class="line">        instr_reg[write_pointer]<span class="variable">.op_type</span> = op_type;</span><br><span class="line">        instr_reg[write_pointer]<span class="variable">.opc</span>     = opcode;</span><br><span class="line">        <span class="comment">// use op_type to determine the operand type stored</span></span><br><span class="line">        <span class="comment">// in the input operand union</span></span><br><span class="line">        <span class="keyword">if</span> (op_type == SIGNED) <span class="keyword">begin</span></span><br><span class="line">            instr_reg[write_pointer]<span class="variable">.op_a</span><span class="variable">.s_data</span> = operand_a<span class="variable">.s_data</span>;</span><br><span class="line">            instr_reg[write_pointer]<span class="variable">.op_b</span><span class="variable">.s_data</span> = operand_b<span class="variable">.s_data</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            instr_reg[write_pointer]<span class="variable">.op_a</span><span class="variable">.u_data</span> = operand_a<span class="variable">.u_data</span>;</span><br><span class="line">            instr_reg[write_pointer]<span class="variable">.op_b</span><span class="variable">.u_data</span> = operand_b<span class="variable">.u_data</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h3 id="foreach-数组循环结构"><a href="#foreach-数组循环结构" class="headerlink" title="foreach 数组循环结构"></a>foreach 数组循环结构</h3><h2 id="第六章-SystemVerilog-程序块、任务和函数"><a href="#第六章-SystemVerilog-程序块、任务和函数" class="headerlink" title="第六章 SystemVerilog 程序块、任务和函数"></a>第六章 SystemVerilog 程序块、任务和函数</h2><h3 id="Verilog-中的always块"><a href="#Verilog-中的always块" class="headerlink" title="Verilog 中的always块"></a>Verilog 中的always块</h3><h3 id="system-verilog-中的-procedural-block"><a href="#system-verilog-中的-procedural-block" class="headerlink" title="system verilog 中的  procedural  block"></a>system verilog 中的  procedural  block</h3><h4 id="always-comb"><a href="#always-comb" class="headerlink" title="always_comb"></a>always_comb</h4><p>always_comb 可以推断信号敏感列表:</p>
<p>SystemVerilog 还在敏感列表中包括由从程序块调用的函数读取的任何信号，除了仅在函数内分配和读取的临时变量。</p>
<p>always_comb 对于仿真的增强：</p>
<p>always_comb 程序块也不同于一般的 always 程序块，因为 always_comb 程序块将在仿真时间为零时自动触发一次，在所有初始和 always 程序块都被激活之后。无论推断的灵敏度列表中的信号是否有任何变化，都会发生这种自动评估。 always_comb 的这种特殊语义可确保组合逻辑的输出与仿真时间为零时逻辑的输入值一致。在使用 2 态变量建模时，默认情况下，以逻辑 0 开始仿真，这种在零时间的自动评估可能尤其重要。复位可能不会导致组合逻辑灵敏度列表中的信号发生事件。如果没有事件，则不会触发通用的始终过程块，因此不会更新输出变量。</p>
<p>以下示例说明了 always_comb 和通用 always 程序块之间的这种差异。该模型表示使用枚举类型建模的简单有限状态机。三种可能的状态是等待、加载和存储。当状态机复位时，它返回到等待状态。状态机的组合逻辑对当前状态进行解码，如果当前状态为 WAITE，则将下一个状态设置为 LOAD。在时钟的每个上升沿，状态序列逻辑将 State 变量设置为 NextState 变量的值。</p>
<p>verilog always block 6-1</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//simulation have problem</span></span><br><span class="line"><span class="keyword">module</span> controller (<span class="keyword">output</span> <span class="keyword">logic</span> read, write,</span><br><span class="line">                   <span class="keyword">input</span> instr_t instruction,</span><br><span class="line">                   <span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">enum</span> &#123;WAITE, LOAD, STORE&#125; State, NextState;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">        <span class="keyword">if</span> (!resetN) State &lt;= WAITE;</span><br><span class="line">        <span class="keyword">else</span> State &lt;= NextState;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(State) <span class="keyword">begin</span>	<span class="comment">//Only triggers when state changes value</span></span><br><span class="line">        <span class="keyword">case</span> (State)</span><br><span class="line">            WAITE: NextState = LOAD;</span><br><span class="line">            LOAD: NextState = STORE;</span><br><span class="line">            STORE: NextState = WAITE;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(State, instruction) <span class="keyword">begin</span></span><br><span class="line">        read = <span class="number">0</span>; write = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (State == LOAD &amp;&amp; instruction == FETCH) read = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (State == STORE &amp;&amp; instruction == WRITE) write = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p>示例 6-1 中有一个模拟的细微之处。在仿真时间为零时，枚举类型默认为枚举类型的基类型的默认值。除非另有明确声明，否则基本类型是 2 状态 int 类型。 int 开始模拟时的初始值为 0，这也是枚举值列表中的 WAITE 值。因此，State 变量和 NextState 变量都默认为 WAITE 的值。在时钟的上升沿，状态序列逻辑将 State 设置为 NextState。但是，由于两个变量具有相同的值，因此状态实际上并没有改变。由于 State 没有更改，因此始终 @(State) 程序块不会触发，并且 NextState 变量不会更新为新值。该模型的模拟被锁定，因为 State 和 NextState 变量具有相同的值。即使应用了重置，此问题仍然存在。重置会将 State 设置为 WAITE 的值，该值与其当前值相同。由于 State 没有改变，因此始终 @(State) 程序块不会触发，从而使 State 和 NextState 具有相同值的问题持续存在。</p>
<p>由于 Verilog 敏感度列表的工作方式，这个锁定状态问题是一个模拟异常。这个问题在实际硬件中不存在，甚至硬件的门级模型也不存在。在实际硬件中，组合逻辑的输出将反映该逻辑的输入值。如果硬件解码器的输入具有 WAITE 的值，则输出 NextState 将是 LOAD 的值。然而，在抽象的 RTL 模拟中，NextState 不能正确反映组合解码器逻辑的输入，因为在模拟时间为零时，没有任何东西触发程序块导致 NextState 从其默认初始值更新。</p>
<p>下面的示例 6-2 对该示例进行了一个简单的更改。总是 @(State) 被替换为 always_comb。 always_comb 程序块将推断块读取的所有外部变量的敏感度列表，在本例中为状态。因此，always_comb 推断出与示例 6-1 中相同的敏感度列表：</p>
<p>即使敏感度列表相同，always_comb 和使用 always @(State) 之间也有重要区别。在激活所有程序块之后，always_comb 程序块会在仿真时间为零时自动执行一次。在此示例中，这意味着在仿真时间为零时，NextState 将被更新以反映在时间为零时的状态值。 当时钟的第一个上升沿出现时，State 将转换为 NextState 的值，这是一个不同的值。 这将触发 always_comb 过程，然后更新 NextState 以反映 State 的新值。 使用 always_comb，就不会出现示例 6-1 中所示的模拟锁定问题。</p>
<p>system veriog  always_comb  6-2</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//this modle not have above problem</span></span><br><span class="line"><span class="keyword">module</span> controller (<span class="keyword">output</span> <span class="keyword">logic</span> read, write,</span><br><span class="line">    <span class="keyword">input</span> instr_t instruction,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">enum</span> &#123;WAITE, LOAD, STORE&#125; State, NextState;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">        <span class="keyword">if</span> (!resetN) State &lt;= WAITE;</span><br><span class="line">        <span class="keyword">else</span> State &lt;= NextState;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always_comb</span> <span class="keyword">begin</span> <span class="comment">//infers @(State) — the block automatically executes once at time zero, even if not triggered</span></span><br><span class="line">        <span class="keyword">case</span> (State)</span><br><span class="line">            WAITE: NextState = LOAD;</span><br><span class="line">            LOAD: NextState = STORE;</span><br><span class="line">            STORE: NextState = WAITE;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">        read = <span class="number">0</span>; write = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (State == LOAD &amp;&amp; instruction == FETCH) read = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (State == STORE &amp;&amp; instruction == WRITE) write = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h4 id="always-ff"><a href="#always-ff" class="headerlink" title="always_ff"></a>always_ff</h4><p>always_ff 专用程序块表明设计者的意图是对可综合的时序逻辑行为进行建模。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">always_ff</span> @(<span class="keyword">posedge</span> clock, <span class="keyword">negedge</span> resetN)</span><br><span class="line">    <span class="keyword">if</span> (!resetN) q &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> q &lt;= d;</span><br></pre></td></tr></table></figure>

<p>通过使用 always_ff 对时序逻辑进行建模，软件工具无需检查程序块的内容来尝试推断预期的逻辑类型。通过专用程序块类型清楚地表明意图，软件工具可以改为检查程序块的内容，并在内容不能合成为顺序逻辑时发出警告。与 always_comb 和 always_latch 一样，这些对 always_ff 程序块内容的附加语义检查是可选的。</p>
<p><strong>顺序逻辑灵敏度列表</strong></p>
<p>always_ff 程序块要求灵敏度列表中的每个信号都必须使用 posedge 或 negedge 进行限定。这是时序逻辑灵敏度列表的综合要求。将此规则作为句法要求有助于确保仿真结果与综合结果相匹配。 always_ff 程序块还禁止在程序块开头以外的任何地方使用事件控件。程序块内的事件控件不代表程序块的敏感度列表，因此是不允许的。这也是时序逻辑 RTL 模型的综合要求。</p>
<h4 id="always-latch"><a href="#always-latch" class="headerlink" title="always_latch"></a>always_latch</h4><p><strong>使用 always_latch 程序块的示例</strong></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> register_reader (<span class="keyword">input</span> clk, ready, resetN,</span><br><span class="line">						<span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">4</span>:<span class="number">0</span>] read_pointer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">logic</span> enable; <span class="comment">// internal enable signal for the counter</span></span><br><span class="line">    <span class="keyword">logic</span> overflow; <span class="comment">// internal counter overflow flag</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always_latch</span> <span class="keyword">begin</span> <span class="comment">// latch the ready input</span></span><br><span class="line">        <span class="keyword">if</span> (!resetN)</span><br><span class="line">        	enable &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ready)</span><br><span class="line">        	enable &lt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (overflow)</span><br><span class="line">        	enable &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk, <span class="keyword">negedge</span> resetN) <span class="keyword">begin</span> <span class="comment">// 5-bit counter</span></span><br><span class="line">            <span class="keyword">if</span> (!resetN)</span><br><span class="line">           	 	&#123;overflow,read_pointer&#125; &lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (enable)</span><br><span class="line">            	&#123;overflow,read_pointer&#125; &lt;= read_pointer + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h4 id="综合指南-4"><a href="#综合指南-4" class="headerlink" title="综合指南"></a>综合指南</h4><p>专用的 always_comb、always_latch 和 always_ff 程序块是可合成的。 无论何时打算将模型与仿真和综合工具一起使用，这些专用程序块都是比 Verilog 的通用始终程序块更好的建模选择。 专用程序块需要模拟器和其他软件工具来检查综合编译器所需的规则。 使用 always_comb、always_latch 和 always_ff 程序块有助于在模型准备好合成之前，在设计过程的早期消除潜在的建模错误。。</p>
<h3 id="增强的tasks-与-functions"><a href="#增强的tasks-与-functions" class="headerlink" title="增强的tasks 与 functions"></a>增强的tasks 与 functions</h3><h4 id="隐式的任务和函数语句组"><a href="#隐式的任务和函数语句组" class="headerlink" title="隐式的任务和函数语句组"></a>隐式的任务和函数语句组</h4><p><strong>begin…end groups multiple statements</strong> </p>
<p>在 Verilog 中，任务或函数中的多个语句必须使用 begin…end 进行分组。任务还允许使用 fork…join 对多个语句进行分组。</p>
<p><strong>SystemVerilog infers begin…end</strong></p>
<p>SystemVerilog 简化了任务和函数定义，不需要对多个语句进行 begin…end 分组。如果省略分组，则任务或函数中的多个语句将按顺序执行，就像在 begin…end 块中一样。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> states_t NextState(states_t State);</span><br><span class="line">    NextState = State; <span class="comment">// default next state</span></span><br><span class="line">    <span class="keyword">case</span> (State)</span><br><span class="line">        WAITE: <span class="keyword">if</span> (start) NextState = LOAD;</span><br><span class="line">        LOAD: <span class="keyword">if</span> (done) NextState = STORE;</span><br><span class="line">        STORE: NextState = WAITE;</span><br><span class="line">    <span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">endfunction</span></span><br></pre></td></tr></table></figure>



<h4 id="函数返回值"><a href="#函数返回值" class="headerlink" title="函数返回值"></a>函数返回值</h4><p><strong>functions create an implied variable of the same name and type</strong></p>
<p>在 Verilog 中，函数名本身是一个推断变量，与函数的类型相同。函数的返回值是通过为函数的名称赋值来设置的。当执行流程到达函数末尾时，函数退出。写入函数名称的推断变量的最后一个值是函数返回的值。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> [<span class="number">31</span>:<span class="number">0</span>] add_and_inc (<span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] a,b);</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">    	add_and_inc = a + b + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endfunction</span></span><br></pre></td></tr></table></figure>

<p>SystemVerilog adds a <strong>return</strong> statement, which allows functions to return a value using <strong>return</strong>, as in C.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="keyword">int</span> add_and_inc (<span class="keyword">input</span> <span class="keyword">int</span> a, b);</span><br><span class="line">	<span class="keyword">return</span> a + b + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">endfunction</span></span><br></pre></td></tr></table></figure>

<p><strong>return 优先于返回函数名中的值</strong></p>
<p>为了保持与 Verilog 的向后兼容性，可以使用 return 语句或分配给函数名称来指定函数的返回值。 return 语句优先。如果执行了 return 语句，那就是返回的值。如果在没有执行 return 语句的情况下到达函数的末尾，那么分配给函数名的最后一个值就是返回值，就像在 Verilog 中一样。即使在使用return语句时，函数名仍然是一个推断变量，可以在执行return语句之前作为临时存储。例如：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="keyword">int</span> add_and_inc (<span class="keyword">input</span> <span class="keyword">int</span> a, b);</span><br><span class="line">    add_and_inc = a + b;</span><br><span class="line">    <span class="keyword">return</span> ++add_and_inc;</span><br><span class="line"><span class="keyword">endfunction</span></span><br></pre></td></tr></table></figure>

<h4 id="在任务和功能结束前返回"><a href="#在任务和功能结束前返回" class="headerlink" title="在任务和功能结束前返回"></a>在任务和功能结束前返回</h4><p><strong>Verilog 必须到达任务或函数的末尾才能退出</strong></p>
<p>在 Verilog 中，任务或函数在执行流程到达结束时退出，用 endtask 或 endfunction 表示。为了在使用 Verilog 到达任务或函数结束之前退出，必须使用 if…else 等条件语句来强制执行流程跳转到任务或函数的末尾。也可以使用 disable 关键字强制任务跳转到其末尾，但这会影响所有当前正在运行的重入任务调用。<strong>以下示例</strong>需要额外编码以防止在函数的输入小于或等于 1 时执行该函数</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="keyword">automatic</span> <span class="keyword">int</span> log2 (<span class="keyword">input</span> <span class="keyword">int</span> n);</span><br><span class="line">    <span class="keyword">if</span> (n &lt;=<span class="number">1</span>)</span><br><span class="line">    	log2 = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">begin</span> <span class="comment">// skip this code when n&lt;=1</span></span><br><span class="line">        log2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (n &gt; <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">            n = n/<span class="number">2</span>;</span><br><span class="line">            log2 = log2+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">     <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endfunction</span></span><br></pre></td></tr></table></figure>

<p><strong>return 语句可用于在结束前退出 Verilog 函数必须返回值 void 函数不返回值</strong></p>
<p>SystemVerilog <strong>return</strong> 语句可用于在执行流程中随时退出任务或函数，而不必到达任务或函数的末尾。使用<strong>return</strong>，上面的例子可以简化如下：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="keyword">automatic</span> <span class="keyword">int</span> log2 (<span class="keyword">input</span> <span class="keyword">int</span> n);</span><br><span class="line">    <span class="keyword">if</span> (n &lt;=<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// abort function</span></span><br><span class="line">    	log2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n &gt; <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">    	n = n/<span class="number">2</span>;</span><br><span class="line">    	log2++;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endfunction</span></span><br></pre></td></tr></table></figure>

<p>使用 return 在到达结束之前退出任务或函数可以简化任务或函数内的编码，并使执行流程更加直观和可读。</p>
<h2 id="第十章-system-Verilog-Interfaces"><a href="#第十章-system-Verilog-Interfaces" class="headerlink" title="第十章 system Verilog Interfaces"></a>第十章 system Verilog Interfaces</h2><p>SystemVerilog 使用强大的接口结构扩展了 Verilog 语言。接口为建模抽象提供了一种新的范式。使用接口可以简化大型复杂设计的建模和验证任务。</p>
<p>本章包含许多小示例，每个示例都显示了接口的特定功能。这些示例故意保持相对较小和简单，以便专注于界面的特定功能。然后第 11 章展示了一个更大的示例，该示例在更完整的设计环境中使用接口</p>
<h3 id="接口概念"><a href="#接口概念" class="headerlink" title="接口概念"></a>接口概念</h3><p>Verilog 语言通过模块端口将模块连接在一起。这是一种表示设计块之间连接的详细方法，该设计直接映射到实际硬件中的物理连接。然而，对于大型设计，使用模块端口将设计块连接在一起可能会变得乏味和冗余。考虑以下示例，该示例使用称为 main_bus 的基本总线架构将设计的五个模块连接在一起，以及一些设计模块之间的一些附加连接。图 10-1 显示了这个简单设计的框图，示例 10-1 列出了涉及的模块声明的 Verilog 源代码。</p>
<p><img src="/2022/01/19/SystemVerilog-For-Design-note/image-20220203152443820.png" alt="image-20220203152443820"></p>
<p>Example10-1  Verilog module interconnections for a simple design</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/********************** Top-level Netlist ********************/</span></span><br><span class="line"><span class="keyword">module</span> top (<span class="keyword">input</span> <span class="keyword">wire</span> clock, resetN, test_mode);</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] data, address, program_address, jump_address;</span><br><span class="line">    <span class="keyword">wire</span> [ <span class="number">7</span>:<span class="number">0</span>] instruction, next_instruction;</span><br><span class="line">    <span class="keyword">wire</span> [ <span class="number">3</span>:<span class="number">0</span>] slave_instruction;</span><br><span class="line">    <span class="keyword">wire</span> slave_request, slave_ready;</span><br><span class="line">    <span class="keyword">wire</span> bus_request, bus_grant;</span><br><span class="line">    <span class="keyword">wire</span> mem_read, mem_write;</span><br><span class="line">    <span class="keyword">wire</span> data_ready;</span><br><span class="line">    </span><br><span class="line">    processor proc1 ( </span><br><span class="line">        <span class="comment">// main_bus ports			//signals for main_bus must be individually connected  to each module instance</span></span><br><span class="line">        <span class="variable">.data</span>(data),</span><br><span class="line">        <span class="variable">.address</span>(address),</span><br><span class="line">        <span class="variable">.slave_instruction</span>(slave_instruction),</span><br><span class="line">        <span class="variable">.slave_request</span>(slave_request),</span><br><span class="line">        <span class="variable">.bus_grant</span>(bus_grant),</span><br><span class="line">        <span class="variable">.mem_read</span>(mem_read),</span><br><span class="line">        <span class="variable">.mem_write</span>(mem_write),</span><br><span class="line">        <span class="variable">.bus_request</span>(bus_request),</span><br><span class="line">        <span class="variable">.slave_ready</span>(slave_ready),</span><br><span class="line">        <span class="comment">// other ports</span></span><br><span class="line">        <span class="variable">.jump_address</span>(jump_address),</span><br><span class="line">        <span class="variable">.instruction</span>(instruction),</span><br><span class="line">        <span class="variable">.clock</span>(clock),</span><br><span class="line">        <span class="variable">.resetN</span>(resetN),</span><br><span class="line">        <span class="variable">.test_mode</span>(test_mode)</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    slave slave1 (</span><br><span class="line">        <span class="comment">// main_bus ports  main_bus connections</span></span><br><span class="line">        <span class="variable">.data</span>(data),</span><br><span class="line">        <span class="variable">.address</span>(address),</span><br><span class="line">        <span class="variable">.bus_request</span>(bus_request),</span><br><span class="line">        <span class="variable">.slave_ready</span>(slave_ready),</span><br><span class="line">        <span class="variable">.mem_read</span>(mem_read),</span><br><span class="line">        <span class="variable">.mem_write</span>(mem_write),</span><br><span class="line">        <span class="variable">.slave_instruction</span>(slave_instruction),</span><br><span class="line">        <span class="variable">.slave_request</span>(slave_request),</span><br><span class="line">        <span class="variable">.bus_grant</span>(bus_grant),</span><br><span class="line">        <span class="variable">.data_ready</span>(data_ready),</span><br><span class="line">        <span class="comment">// other ports</span></span><br><span class="line">        <span class="variable">.clock</span>(clock),</span><br><span class="line">        <span class="variable">.resetN</span>(resetN)</span><br><span class="line">    );   </span><br><span class="line"></span><br><span class="line">    dual_port_ram ram (</span><br><span class="line">        <span class="comment">// main_bus ports main_bus connections</span></span><br><span class="line">        <span class="variable">.data</span>(data),</span><br><span class="line">        <span class="variable">.data_ready</span>(data_ready),</span><br><span class="line">        <span class="variable">.address</span>(address),</span><br><span class="line">        <span class="variable">.mem_read</span>(mem_read),</span><br><span class="line">        <span class="variable">.mem_write</span>(mem_write),</span><br><span class="line">        <span class="comment">// other ports</span></span><br><span class="line">        <span class="variable">.program_address</span>(program_address),</span><br><span class="line">        <span class="variable">.data_b</span>(next_instruction)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    test_generator test_gen(</span><br><span class="line">        <span class="comment">// main_bus ports //main_bus connections</span></span><br><span class="line">        <span class="variable">.data</span>(data),</span><br><span class="line">        <span class="variable">.address</span>(address),</span><br><span class="line">        <span class="variable">.mem_read</span>(mem_read),</span><br><span class="line">        <span class="variable">.mem_write</span>(mem_write),</span><br><span class="line">        <span class="comment">// other ports</span></span><br><span class="line">        <span class="variable">.clock</span>(clock),</span><br><span class="line">        <span class="variable">.resetN</span>(resetN),</span><br><span class="line">        <span class="variable">.test_mode</span>(test_mode)</span><br><span class="line">    );   </span><br><span class="line">  </span><br><span class="line">    instruction_reg ir (</span><br><span class="line">        <span class="variable">.program_address</span>(program_address),</span><br><span class="line">        <span class="variable">.instruction</span>(instruction),</span><br><span class="line">        <span class="variable">.jump_address</span>(jump_address),</span><br><span class="line">        <span class="variable">.next_instruction</span>(next_instruction),</span><br><span class="line">        <span class="variable">.clock</span>(clock),</span><br><span class="line">        <span class="variable">.resetN</span>(resetN)</span><br><span class="line">    );</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">/********************* Module Definitions ********************/</span></span><br><span class="line"><span class="keyword">module</span> processor (</span><br><span class="line">    <span class="comment">// main_bus ports</span></span><br><span class="line">    <span class="keyword">inout</span> <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] data,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">15</span>:<span class="number">0</span>] address,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [ <span class="number">3</span>:<span class="number">0</span>] slave_instruction,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> slave_request,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> bus_grant,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> mem_read,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> mem_write,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> bus_request,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> slave_ready,</span><br><span class="line">    <span class="comment">// other ports</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">15</span>:<span class="number">0</span>] jump_address,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [ <span class="number">7</span>:<span class="number">0</span>] instruction,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> clock,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> resetN,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> test_mode</span><br><span class="line">);</span><br><span class="line">	... <span class="comment">// module functionality code</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> slave (</span><br><span class="line">    <span class="comment">// main_bus ports</span></span><br><span class="line">    <span class="keyword">inout</span> <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] data,</span><br><span class="line">    <span class="keyword">inout</span> <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] address,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> bus_request,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> slave_ready,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> mem_read,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> mem_write,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [ <span class="number">3</span>:<span class="number">0</span>] slave_instruction,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> slave_request,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> bus_grant,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> data_ready,</span><br><span class="line">    <span class="comment">// other ports</span></span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> clock,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> resetN</span><br><span class="line">    );</span><br><span class="line">    ... <span class="comment">// module functionality code</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> dual_port_ram (</span><br><span class="line">    <span class="comment">// main_bus ports</span></span><br><span class="line">    <span class="keyword">inout</span> <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] data,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> data_ready,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] address,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">tri0</span> mem_read,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">tri0</span> mem_write,</span><br><span class="line">    <span class="comment">// other ports</span></span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] program_address,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [ <span class="number">7</span>:<span class="number">0</span>] data_b</span><br><span class="line">);</span><br><span class="line">    ... <span class="comment">// module functionality code</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> test_generator (</span><br><span class="line">    <span class="comment">// main_bus ports</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] data,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">15</span>:<span class="number">0</span>] address,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> mem_read,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> mem_write,</span><br><span class="line">    <span class="comment">// other ports</span></span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> clock,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> resetN,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> test_mode</span><br><span class="line">);</span><br><span class="line">    ... <span class="comment">// module functionality code</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> instruction_reg (</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">15</span>:<span class="number">0</span>] program_address,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [ <span class="number">7</span>:<span class="number">0</span>] instruction,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] jump_address,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [ <span class="number">7</span>:<span class="number">0</span>] next_instruction,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> clock,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> resetN</span><br><span class="line">);</span><br><span class="line">	... <span class="comment">// module functionality code</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h4 id="Verilog模块端口的缺点"><a href="#Verilog模块端口的缺点" class="headerlink" title="Verilog模块端口的缺点"></a>Verilog模块端口的缺点</h4><p>Verilog 的模块端口提供了一种简单直观的方式来描述设计块之间的互连。然而，在大型、复杂的设计中，Verilog 的模块端口有几个缺点。其中一些是：</p>
<ul>
<li>声明必须在多个模块中重复。 </li>
<li>通信协议必须在多个模块中重复。 </li>
<li>不同模块中存在不匹配声明的风险。 </li>
<li>设计规范的更改可能需要对多个模块进行修改</li>
</ul>
<p><strong>在网表中连接模块需要冗余端口声明</strong></p>
<p>使用 Verilog 的模块端口将设计的主要模块连接在一起的一个缺点在上面的示例代码中很明显。必须在使用总线的每个模块以及将设计连接在一起的顶级网表中声明构成上例中的 main_bus 的信号。在这个简单的例子中，main_bus 中只有少数几个信号，所以多余的声明大多只是一种不便。然而，在大型、复杂的设计中，这种冗余不仅仅是一种不便。一个大型设计可能有几十个模块连接到同一条总线，每个模块中有几十个重复的声明。如果一个模块的端口无意中被声明为与设计的其余部分不同，则可能会出现难以发现的功能错误。</p>
<p>复制的端口声明还意味着，如果总线规范在设计过程中或在下一代设计中发生变化，因此，必须更改共享总线的每个模块。 还必须更改用于使用总线连接模块的所有网表。 hange 的这种广泛传播效果与良好的编码风格背道而驰。 编码的一个目标是以这样一种方式构建代码，即一个地方的微小变化不应该需要改变代码的其他区域。 Verilog 语言的一个弱点是对一个模块中的端口的更改通常需要对其他模块进行更改。 </p>
<p><strong>协议必须在每个模块中重复</strong></p>
<p>Verilog 模块端口的另一个缺点是，必须在每个模块中复制通信协议，以利用模块之间的互连信号。例如，如果三个模块从共享存储设备读取和写入，则必须在每个模块中复制读取和写入控制逻辑。</p>
<p><strong>模块端口抑制抽象的自上而下设计</strong></p>
<p>使用模块端口将设计块连接在一起的另一个缺点是，必须在设计周期的早期确定设计的详细互连。这与自上而下的设计范式背道而驰，在这种范式中，模型首先是在抽象级别编写的，没有广泛的设计细节。在抽象层面上，互连总线不应该需要定义构成总线的每个信号。事实上，在设计规范的早期，我们所知道的只是设计的块将共享某些信息。在第 264 页的图 10-1 所示的框图中，main_bus 表示为单个连接。然而，使用 Verilog 的模块端口将设计块连接在一起，不允许在同一抽象级别进行建模。在对设计的任何模块进行建模之前，必须首先将总线分解为单独的信号。</p>
<h4 id="SystemVerilog-接口的优点"><a href="#SystemVerilog-接口的优点" class="headerlink" title="SystemVerilog 接口的优点"></a>SystemVerilog 接口的优点</h4><p><strong>接口是一种抽象端口类型</strong></p>
<p>SystemVerilog 为 Verilog 添加了一个强大的新端口类型，称为<strong>interface</strong>。interface允许将多个信号组合在一起并表示为单个端口。构成接口的信号声明包含在一个位置。然后，使用这些信号的每个模块都有一个interface类型的端口，而不是许多带有离散信号的端口。</p>
<p>例 10-2 显示了 SystemVerilog 的<strong>interfaces</strong>如何减少为图 10-1 所示的简单设计建模所需的代码量。通过将构成 <strong>main_bus</strong> 的信号封装为接口，消除了每个模块中这些信号的冗余声明。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Example 10-2: SystemVerilog module interconnections using interfaces</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************* Interface Definitions *******************/</span></span><br><span class="line"><span class="keyword">interface</span> main_bus;	<span class="comment">//signals for main_bus are  defined in just one place</span></span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] data;</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] address;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] slave_instruction;</span><br><span class="line">    <span class="keyword">logic</span> slave_request;</span><br><span class="line">    <span class="keyword">logic</span> bus_grant;</span><br><span class="line">    <span class="keyword">logic</span> bus_request;</span><br><span class="line">    <span class="keyword">logic</span> slave_ready;</span><br><span class="line">    <span class="keyword">logic</span> data_ready;</span><br><span class="line">    <span class="keyword">logic</span> mem_read;</span><br><span class="line">    <span class="keyword">logic</span> mem_write;</span><br><span class="line"><span class="keyword">endinterface</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/********************** Top-level Netlist ********************/</span></span><br><span class="line"><span class="keyword">module</span> top (<span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN, test_mode);</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] program_address, jump_address;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] instruction, next_instruction;</span><br><span class="line">    main_bus bus ( ); <span class="comment">// instance of an interface (instance name is bus)</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    processor proc1 (</span><br><span class="line">        <span class="comment">// main_bus ports	</span></span><br><span class="line">        <span class="comment">//each module instance has a single connection for main_bus</span></span><br><span class="line">        <span class="variable">.bus</span>(bus), <span class="comment">// interface connection</span></span><br><span class="line">        <span class="comment">// other ports </span></span><br><span class="line">        <span class="variable">.jump_address</span>(jump_address),</span><br><span class="line">        <span class="variable">.instruction</span>(instruction),</span><br><span class="line">        <span class="variable">.clock</span>(clock),</span><br><span class="line">        <span class="variable">.resetN</span>(resetN),</span><br><span class="line">        <span class="variable">.test_mode</span>(test_mode)</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    slave slave1 (</span><br><span class="line">        <span class="comment">// main_bus ports</span></span><br><span class="line">        <span class="comment">//    main_bus connections</span></span><br><span class="line">        <span class="variable">.bus</span>(bus), <span class="comment">// interface connection</span></span><br><span class="line">        <span class="comment">// other ports</span></span><br><span class="line">        <span class="variable">.clock</span>(clock),</span><br><span class="line">        <span class="variable">.resetN</span>(resetN)</span><br><span class="line">    );</span><br><span class="line">    dual_port_ram ram (</span><br><span class="line">        <span class="comment">// main_bus ports</span></span><br><span class="line">        <span class="comment">//    main_bus connections</span></span><br><span class="line">        <span class="variable">.bus</span>(bus), <span class="comment">// interface connection</span></span><br><span class="line">        <span class="comment">// other ports</span></span><br><span class="line">        <span class="variable">.program_address</span>(program_address),</span><br><span class="line">    	<span class="variable">.data_b</span>(next_instruction)</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    test_generator test_gen(</span><br><span class="line">        <span class="comment">// main_bus ports</span></span><br><span class="line">        <span class="variable">.bus</span>(bus), <span class="comment">// interface connection   main_bus connections</span></span><br><span class="line">        <span class="comment">// other ports</span></span><br><span class="line">        <span class="variable">.clock</span>(clock),</span><br><span class="line">        <span class="variable">.resetN</span>(resetN),</span><br><span class="line">        <span class="variable">.test_mode</span>(test_mode)</span><br><span class="line">    );</span><br><span class="line">    instruction_reg ir (</span><br><span class="line">        <span class="variable">.program_address</span>(program_address),</span><br><span class="line">        <span class="variable">.instruction</span>(instruction),</span><br><span class="line">        <span class="variable">.jump_address</span>(jump_address),</span><br><span class="line">        <span class="variable">.next_instruction</span>(next_instruction),</span><br><span class="line">        <span class="variable">.clock</span>(clock),</span><br><span class="line">        <span class="variable">.resetN</span>(resetN)</span><br><span class="line">    );</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/********************* Module Definitions ********************/</span></span><br><span class="line"><span class="keyword">module</span> processor (</span><br><span class="line">    <span class="comment">// main_bus interface port</span></span><br><span class="line">    main_bus bus, <span class="comment">// interface port  each module definition has a single port for main_bus</span></span><br><span class="line">    <span class="comment">// other ports</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] jump_address,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] instruction,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> clock,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> resetN,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> test_mode</span><br><span class="line">);</span><br><span class="line">    ... <span class="comment">// module functionality code</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> slave (</span><br><span class="line">    <span class="comment">// main_bus interface port</span></span><br><span class="line">    main_bus bus, <span class="comment">// interface port     main_bus port declaration</span></span><br><span class="line">    <span class="comment">// other ports</span></span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> clock,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> resetN</span><br><span class="line">    );</span><br><span class="line">    ... <span class="comment">// module functionality code</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> dual_port_ram (</span><br><span class="line">    <span class="comment">// main_bus interface port</span></span><br><span class="line">    main_bus bus, <span class="comment">// interface port  main_bus port declaration</span></span><br><span class="line">    <span class="comment">// other ports</span></span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] program_address,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] data_b</span><br><span class="line">    );</span><br><span class="line">    ... <span class="comment">// module functionality code</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"><span class="keyword">module</span> test_generator (</span><br><span class="line">    <span class="comment">// main_bus interface port</span></span><br><span class="line">    main_bus bus, <span class="comment">// interface port main_bus port declaration</span></span><br><span class="line">    <span class="comment">// other ports</span></span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> clock,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> resetN,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> test_mode</span><br><span class="line">    );</span><br><span class="line">    ... <span class="comment">// module functionality code</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"><span class="keyword">module</span> instruction_reg (</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] program_address,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] instruction,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] jump_address,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] next_instruction,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> clock,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> resetN</span><br><span class="line">    );</span><br><span class="line">    ... <span class="comment">// module functionality code</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在上面的示例 10-2 中，设计的主要模块之间共有的所有信号都被封装到一个位置——称为 main_bus 的接口声明。顶层模块和构成这些块的所有模块不会重复声明这些公共信号。相反，这些模块只是使用接口作为它们之间的连接。</p>
<p>将通用信号封装到单个位置消除了 Verilog 模块的冗余声明。事实上，在前面的例子中，由于clock和resetN 对所有模块都是通用的，这些信号也可以被带入接口。 这种进一步的简化将在本章后面的第 274 页的示例 10-3 中显示。</p>
<h4 id="SystemVerilog-interface-内容"><a href="#SystemVerilog-interface-内容" class="headerlink" title="SystemVerilog interface 内容"></a>SystemVerilog interface 内容</h4><p><strong>接口可以包含功能</strong></p>
<p>SystemVerilog 接口不仅仅是一束电线。接口可以封装设计块之间通信的全部细节。使用接口：</p>
<ul>
<li>用于通信的离散信号和端口可以在一个位置定义，即接口。</li>
<li>可以在接口中定义通信协议。 </li>
<li>协议检查和其他验证例程可以直接内置到接口中。</li>
</ul>
<p><strong>接口消除了多余的声明</strong></p>
<p>使用 Verilog，必须在共享总线或其他通信架构的每个模块中复制通信细节。 SystemVerlog 允许在单个公共位置定义有关通信架构和架构使用的所有信息。接口可以包含类型声明、任务、函数、过程块、程序块和断言。 SystemVerilog 接口还允许定义接口的多个视图。例如，对于连接到接口的每个模块，data_bus 信号可以定义为输入、输出或双向端口。 SystemVerilog 接口的所有这些功能在本章的以下部分中进行了更详细的描述</p>
<h4 id="模块和接口的区别"><a href="#模块和接口的区别" class="headerlink" title="模块和接口的区别"></a>模块和接口的区别</h4><p><strong>接口与模块不同</strong></p>
<p>接口与模块存在三个根本区别:</p>
<ul>
<li>首先，界面不能包含设计层次结构。与模块不同，接口不能包含会创建新的实现层次结构的模块或原语的实例。</li>
<li>其次，接口可以用作模块端口，它允许接口表示模块之间的通信通道。在端口列表中使用模块是非法的。</li>
<li>第三，接口可以包含 modports，它允许连接到接口的每个模块以不同的方式查看接口。 Modports 在第 281 页的 10.6 节中有详细描述。</li>
</ul>
<h3 id="接口声明"><a href="#接口声明" class="headerlink" title="接口声明"></a>接口声明</h3><p><strong>接口的定义方式与模块类似</strong></p>
<p>从语法上讲，接口的定义与模块的定义非常相似。一个接口可以有端口，就像一个模块一样。这允许将接口外部的信号（例如时钟或复位线）引入接口并成为接口表示的信号束的一部分。接口还可以包含任何 Verilog 或 SystemVerilog 类型的声明，包括所有变量类型、所有网络类型和用户定义类型。</p>
<p>例 10-3 显示了一个名为 main_bus 的接口的定义，三个外部信号进入该<strong>interface</strong>：clock、resetN 和 test_mode。这些外部信号现在可以通过接口连接到每个模块，而无需明确地将信号连接到每个模块。请注意，在此示例中，接口 main_bus 的实例如何将时钟、resetN 和 test_mode 信号连接到它，使用与将信号连接到模块实例相同的语法。</p>
<p>Example 10-3: The interface definition for main_bus, with external inputs</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/******************* Interface Definitions *******************/</span></span><br><span class="line"><span class="keyword">interface</span> main_bus (<span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN, test_mode);</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] data; </span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] address;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] slave_instruction;</span><br><span class="line">    <span class="keyword">logic</span> slave_request;</span><br><span class="line">    <span class="keyword">logic</span> bus_grant;</span><br><span class="line">    <span class="keyword">logic</span> bus_request;</span><br><span class="line">    <span class="keyword">logic</span> slave_ready;</span><br><span class="line">    <span class="keyword">logic</span> data_ready;</span><br><span class="line">    <span class="keyword">logic</span> mem_read;</span><br><span class="line">    <span class="keyword">logic</span> mem_write;</span><br><span class="line"><span class="keyword">endinterface</span></span><br><span class="line"><span class="comment">/********************** Top-level Netlist ********************/</span></span><br><span class="line"><span class="keyword">module</span> top (<span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN, test_mode);</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] program_address, jump_address;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] instruction, next_instruction;</span><br><span class="line">	</span><br><span class="line">    main_bus bus ( <span class="comment">// instance of an interface</span></span><br><span class="line">        			<span class="comment">//discrete signals are connected to the interface instance</span></span><br><span class="line">		<span class="variable">.clock</span>(clock), </span><br><span class="line">        <span class="variable">.resetN</span>(resetN),</span><br><span class="line">        <span class="variable">.test_mode</span>(test_mode) </span><br><span class="line">    );</span><br><span class="line">processor proc1 (</span><br><span class="line">    <span class="comment">// main_bus ports</span></span><br><span class="line">    <span class="variable">.bus</span>(bus), <span class="comment">// interface connection</span></span><br><span class="line">    <span class="comment">// other ports</span></span><br><span class="line">    <span class="comment">//discrete signals do not need to be connected to each design block instance</span></span><br><span class="line">    <span class="variable">.jump_address</span>(jump_address),</span><br><span class="line">    <span class="variable">.instruction</span>(instruction) </span><br><span class="line">    );</span><br><span class="line">    ...</span><br><span class="line"><span class="comment">/*** remainder of netlist and module definitions are not ***/</span></span><br><span class="line"><span class="comment">/*** listed — they are similar to example 10-2, but ***/</span></span><br><span class="line"><span class="comment">/*** clock and resetN do not need to be passed to each ***/</span></span><br><span class="line"><span class="comment">/*** module instance as discrete ports. ***/</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><em><em>接口实例可以使用 .name 和 .</em> 连接</em>*</p>
<p>SystemVerilog 简化的 .name 和 .* 端口连接样式也可用于接口端口连接。这些结构在第 233 页的第 9.4 节中进行了介绍。通过将接口的使用与 .* 端口连接的使用结合起来，可以使前面的示例更加简洁。这在下面的示例 10-4 中进行了说明。</p>
<p>Example 10-4: Using interfaces with  .* connections to simplify complex netlists</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/******************* Interface Definitions *******************/</span></span><br><span class="line"><span class="keyword">interface</span> main_bus (<span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN, test_mode);</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] data;</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] address;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] slave_instruction;</span><br><span class="line">    <span class="keyword">logic</span> slave_request;</span><br><span class="line">    <span class="keyword">logic</span> bus_grant;</span><br><span class="line">    <span class="keyword">logic</span> bus_request;</span><br><span class="line">    <span class="keyword">logic</span> slave_ready;</span><br><span class="line">    <span class="keyword">logic</span> data_ready;</span><br><span class="line">    <span class="keyword">logic</span> mem_read;</span><br><span class="line">    <span class="keyword">logic</span> mem_write;</span><br><span class="line"><span class="keyword">endinterface</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/********************** Top-level Netlist ********************/</span></span><br><span class="line"><span class="keyword">module</span> top (<span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN, test_mode);</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] program_address, jump_address;</span><br><span class="line">    <span class="keyword">logic</span> [ <span class="number">7</span>:<span class="number">0</span>] instruction, next_instruction, data_b;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//.* port connections can significantly reduce a netlist (compare to netlist in  example 10-2 on page 270).</span></span><br><span class="line">    main_bus bus ( .* );</span><br><span class="line">    processor proc1 ( .* ); </span><br><span class="line">    slave slave1 ( .* );</span><br><span class="line">    instruction_reg ir ( .* );</span><br><span class="line">    test_generator test_gen ( .* ); </span><br><span class="line">    dual_port_ram ram ( .*, <span class="variable">.data_b</span>(next_instruction) );</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"><span class="comment">/*** remainder of netlist and module definitions are not ***/</span></span><br><span class="line"><span class="comment">/*** listed — they are similar to example 10-2, but ***/</span></span><br><span class="line"><span class="comment">/*** clock and resetN do not need to be passed to each ***/</span></span><br><span class="line"><span class="comment">/*** module instance as discrete ports.</span></span><br></pre></td></tr></table></figure>

<p><strong>SystemVerilog 极大地简化了网表</strong></p>
<p>在第 264 页的示例 10-1 中列出的这个简单示例的 Verilog 版本中，顶层网表模块顶部需要 65 行代码，不包括空白行和注释。使用 SystemVerilog 接口和 .*，上面的示例 10-4，只需要 10 行代码（不包括空白行和注释）来模拟相同的连接性。</p>
<h4 id="源代码声明顺序"><a href="#源代码声明顺序" class="headerlink" title="源代码声明顺序"></a>源代码声明顺序</h4><p><strong>接口名称可以在定义之前使用</strong></p>
<p>接口的名称可以在两种上下文中引用：</p>
<ul>
<li>在模块的端口中，</li>
<li>在接口的实例中。</li>
</ul>
<p>接口可以用作模块端口，而无需考虑文件顺序依赖性。与模块一样，在软件工具读入包含接口定义的源代码之前，可以引用接口的名称。这意味着任何模块都可以将接口用作模块端口，而无需考虑源代码的编译顺序。</p>
<h4 id="全局和本地接口定义"><a href="#全局和本地接口定义" class="headerlink" title="全局和本地接口定义"></a>全局和本地接口定义</h4><p><strong>接口可以是全局声明</strong></p>
<p>可以使用关键字 <strong>interface</strong> 和 <strong>endinterface</strong> 将接口与模块定义分开定义。接口的名称将在全局模块定义名称范围内，就像模块名称一样。这允许接口定义被设计层次结构中的任何模块用作端口。</p>
<p><strong>接口可以限制在特定的层次结构范围内</strong></p>
<p>接口定义可以嵌套在模块中，使接口的名称成为该模块的本地名称。只有包含模块才能实例化本地声明的接口。这允许接口的使用仅限于设计层次结构的一部分，例如仅限于 IP 模型内。</p>
<h3 id="使用接口作为模块端口"><a href="#使用接口作为模块端口" class="headerlink" title="使用接口作为模块端口"></a>使用接口作为模块端口</h3><p>使用 SystemVerilog，可以将模块的端口声明为<strong>interface</strong>类型，而不是 Verilog  <strong>input</strong>、<strong>output</strong>或<strong>inout</strong>端口方向</p>
<h4 id="显式命名的接口端口"><a href="#显式命名的接口端口" class="headerlink" title="显式命名的接口端口"></a>显式命名的接口端口</h4><p><strong>模块端口可以是接口的名称</strong></p>
<p>模块端口可以显式声明为特定类型的接口。这是通过使用接口名称作为端口类型来完成的。语法是：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//module &lt;module_name&gt; (&lt;interface_name&gt; &lt;port_name&gt;);</span></span><br><span class="line"><span class="comment">//For example:</span></span><br><span class="line"><span class="keyword">interface</span> chip_bus;</span><br><span class="line">	...</span><br><span class="line"><span class="keyword">endinterface</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> CACHE (chip_bus pins, <span class="comment">// interface port</span></span><br><span class="line"><span class="keyword">input</span> clock);</span><br><span class="line">...</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>显式命名的接口端口只能连接到同名的接口。如果任何其他接口定义连接到端口，则会发生错误。明确命名的接口端口可确保永远不会无意中将错误的接口连接到该端口。明确命名可以连接到端口的接口类型还可以在端口声明中直接记录端口的使用方式。</p>
<h4 id="通用接口端口"><a href="#通用接口端口" class="headerlink" title="通用接口端口"></a>通用接口端口</h4><p><strong>可以使用 interface 关键字声明端口</strong></p>
<p>通用接口端口使用关键字 interface 定义端口类型，而不是使用特定接口类型的名称。语法是：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> &lt;module_name&gt; (<span class="keyword">interface</span> &lt;port_name&gt;);</span><br></pre></td></tr></table></figure>

<p>当模块被实例化时，任何接口都可以连接到通用接口端口。这提供了灵活性，因为同一模块可以以多种方式使用，不同的接口连接到模块。在以下示例中，模块 RAM 使用通用接口端口定义：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> RAM (<span class="keyword">interface</span> pins,</span><br><span class="line">			<span class="keyword">input</span> clock);</span><br><span class="line">	... </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>



<h4 id="综合指南-5"><a href="#综合指南-5" class="headerlink" title="综合指南"></a>综合指南</h4><p>两种将接口连接到模块的方式都是可以综合的。</p>
<h3 id="实例化和连接接口"><a href="#实例化和连接接口" class="headerlink" title="实例化和连接接口"></a>实例化和连接接口</h3><p><strong>接口的实例化方式与模块相同</strong></p>
<p>接口实例使用端口连接连接到模块实例的端口，就像离散网络连接到模块实例的端口一样。这要求接口和它所连接的模块都被实例化。</p>
<p>Interface实例的语法与模块实例的语法相同。如果接口的定义有端口，那么可以使用端口顺序连接样式或命名端口连接样式将信号连接到接口实例，就像使用模块实例一样。</p>
<p><strong>接口连接规则</strong></p>
<p><strong>注意</strong>：It is illegal to leave an interface port unconnected.</p>
<p><strong>interface ports must be connected</strong></p>
<p>module <strong>input</strong>、<strong>output</strong>或<strong>inout</strong>端口可以在模块实例上保持未连接状态。对于<strong>interface</strong>端口，情况并非如此。声明为<strong>interface</strong>的端口，无论是通用的还是显式的，都必须连接到<strong>interface</strong>实例或另一个<strong>interface</strong>端口。如果<strong>interface</strong>端口未连接，则会发生错误。</p>
<p>在模块实例上，已声明为接口类型的端口必须连接到接口实例或层次结构中更高的另一个接口端口。如果端口声明具有显式命名的接口类型，则它必须连接到相同类型的接口实例。如果端口声明具有通用接口类型，则它可以连接到任何类型的接口实例。</p>
<p>SystemVerilog <strong>.name</strong> 和 <strong>.</strong>* 端口连接样式也可用于<strong>interface</strong>实例，如第 275 页的示例 10-4 所示。这些端口连接样式在第 233 页的第 9.4 节中讨论。</p>
<p><strong>连接到接口实例的接口</strong></p>
<p>一个接口的端口可以连接到另一个接口</p>
<p>接口的端口也可以定义为接口。此功能允许一个接口连接到另一个接口。例如，设计的主总线可能有一个或多个子总线。主总线及其子总线都可以建模为接口。子总线接口可以表示为主接口的端口。</p>
<h3 id="在接口内引用信号"><a href="#在接口内引用信号" class="headerlink" title="在接口内引用信号"></a>在接口内引用信号</h3><p><strong>使用端口名称引用接口中的信号</strong></p>
<p>在具有接口端口的模块中，必须使用端口名称访问接口内的信号，使用以下语法：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;port_name&gt;.&lt;internal_interface_signal_name&gt;</span><br></pre></td></tr></table></figure>

<p>在第 274 页的示例 10-3 中，main_bus 的接口定义包含时钟和 resetN 的声明。从模块有一个接口端口，端口名称为bus。从模型可以通过将其引用为 bus.clock 来访问接口内的时钟变量。例如：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> bus<span class="variable">.clock</span>, <span class="keyword">negedge</span> bus<span class="variable">.resetN</span>)</span><br><span class="line">	... </span><br></pre></td></tr></table></figure>

<p>示例 10-5 列出了模块从站的部分代码。该模型包含几个对 main_bus 接口中信号的引用。</p>
<p>Example 10-5: Referencing signals within an interface</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> slave (</span><br><span class="line">    <span class="comment">// main_bus interface port</span></span><br><span class="line">    main_bus bus</span><br><span class="line">    <span class="comment">// other ports</span></span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// internal signals </span></span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] slave_data, slave_address;</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">15</span>:<span class="number">0</span>] operand_A, operand_B;</span><br><span class="line">    <span class="keyword">logic</span> mem_select, read, write;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assign</span> bus<span class="variable">.address</span> = mem_select? slave_address: ’z;</span><br><span class="line">    <span class="keyword">assign</span> bus<span class="variable">.data</span> = bus<span class="variable">.slave_ready</span>? slave_data: ’z;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">enum</span> <span class="keyword">logic</span> [<span class="number">4</span>:<span class="number">0</span>] &#123;	RESET = <span class="number">5&#x27;b00001</span>,</span><br><span class="line">                    	START = <span class="number">5&#x27;b00010</span>,</span><br><span class="line">                        REQ_DATA = <span class="number">5&#x27;b00100</span>,</span><br><span class="line">                        EXECUTE = <span class="number">5&#x27;b01000</span>,</span><br><span class="line">                        DONE = <span class="number">5&#x27;b10000</span>&#125; State, NextState;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always_ff</span> @(<span class="keyword">posedge</span> bus<span class="variable">.clock</span>, <span class="keyword">negedge</span> bus<span class="variable">.resetN</span>) <span class="keyword">begin</span>: FSM</span><br><span class="line">        <span class="keyword">if</span> (!bus<span class="variable">.resetN</span>) State &lt;= START;</span><br><span class="line">        <span class="keyword">else</span> State &lt;= NextState;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always_comb</span> <span class="keyword">begin</span> : FSM_decode</span><br><span class="line">    	<span class="keyword">unique</span> <span class="keyword">case</span> (State)</span><br><span class="line">    		START: <span class="keyword">if</span> (!bus<span class="variable">.slave_request</span>) <span class="keyword">begin</span></span><br><span class="line">                        bus<span class="variable">.bus_request</span> = <span class="number">0</span>;</span><br><span class="line">                        NextState = State;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                        operand_A = bus<span class="variable">.data</span>;</span><br><span class="line">                        slave_address = bus<span class="variable">.address</span>;</span><br><span class="line">                        bus<span class="variable">.bus_request</span> = <span class="number">1</span>;</span><br><span class="line">                        NextState = REQ_DATA;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">    	... <span class="comment">// decode other states</span></span><br><span class="line">    <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span>: FSM_decode</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p><strong>注意： Use short names for the names of interface ports.</strong></p>
<p>由于interface中的信号是通过将interface端口名称附加到信号名称来访问的，因此使用短名称作为interface端口名称很方便。这使对interface信号名称的引用保持简短且易于阅读。与任何 Verilog 模块中一样，interface中的名称可以是描述性的和有意义的。</p>
<h3 id="Interface-modports"><a href="#Interface-modports" class="headerlink" title="Interface modports"></a>Interface modports</h3><p><strong>interface</strong>提供了一种实用且直接的方式来简化模块之间的连接。但是，连接到接口的每个模块可能需要查看接口内连接的稍微不同的视图。例如，对于总线上的从机， Interrupt_request 信号可能是从机的输出，而对于同一总线上的处理器，interrupt_request 可能是输入。</p>
<p><strong>modports 从模块的角度定义接口连接</strong></p>
<p>SystemVerilog 接口提供了一种方法来定义每个模块在其接口端口上看到的接口信号的不同视图。使用 <strong>modport</strong> 关键字在接口内进行定义。 <strong>Modport</strong> 是模块端口的缩写。 modport 定义描述了由接口表示的模块端口。一个接口可以有任意数量的 modport 定义，每一个都描述一个或多个其他模块如何查看接口内的信号。</p>
<p>modport 定义了模块在接口中看到的信号的端口方向。两个 <strong>modport</strong> 声明的示例是：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> chip_bus (<span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN);</span><br><span class="line">                    <span class="keyword">logic</span> interrupt_request, grant, ready;</span><br><span class="line">                    <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] address;</span><br><span class="line">                    <span class="keyword">wire</span> [<span class="number">63</span>:<span class="number">0</span>] data;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">modport</span> master (<span class="keyword">input</span> interrupt_request,</span><br><span class="line">                    <span class="keyword">input</span> address,</span><br><span class="line">                    <span class="keyword">output</span> grant, ready,</span><br><span class="line">                    <span class="keyword">inout</span> data,</span><br><span class="line">                    <span class="keyword">input</span> clock, resetN);</span><br><span class="line">    <span class="keyword">modport</span> slave (<span class="keyword">output</span> interrupt_request,</span><br><span class="line">                    <span class="keyword">output</span> address,</span><br><span class="line">                    <span class="keyword">input</span> grant, ready,</span><br><span class="line">                    <span class="keyword">inout</span> data,</span><br><span class="line">                    <span class="keyword">input</span> clock, resetN);</span><br><span class="line"><span class="keyword">endinterface</span></span><br></pre></td></tr></table></figure>

<p><strong>modport</strong> 定义不包含向量大小或类型。此信息被定义为接口中信号类型声明的一部分。 <strong>modport</strong> 声明仅定义连接模块是否将信号视为<strong>input</strong>, <strong>output</strong>,  bidirectional <strong>inout</strong>, or <strong>ref</strong> port。</p>
<h4 id="指定要使用的-modport-视图"><a href="#指定要使用的-modport-视图" class="headerlink" title="指定要使用的 modport 视图"></a>指定要使用的 modport 视图</h4><p>SystemVerilog 提供了两种方法来指定模块接口端口应该使用哪个 modport 视图：</p>
<ul>
<li>作为与模块实例的接口连接的一部分</li>
<li>作为模块定义中模块端口声明的一部分</li>
</ul>
<p>这两种规范风格都是可综合的。</p>
<h5 id="在模块实例中选择-modport"><a href="#在模块实例中选择-modport" class="headerlink" title="在模块实例中选择 modport"></a>在模块实例中选择 modport</h5><p>modport 可以在模块实例中选择</p>
<p>当一个模块被实例化并且一个接口的实例连接到一个模块实例端口时，可以指定该接口的具体modport。与 modport 的连接指定为：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;interface_instance_name&gt;.&lt;modport_name&gt;</span><br></pre></td></tr></table></figure>

<p>For example:</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chip_bus bus; <span class="comment">// instance of an interface</span></span><br><span class="line">primary i1 (bus<span class="variable">.master</span>); <span class="comment">// use master modport</span></span><br></pre></td></tr></table></figure>

<p>以下代码片段说明了将两个模块与一个名为 chip_bus 的<strong>interface</strong>连接在一起。名为primary的模块连接到接口的master视图，名为secondary的模块连接到同一个接口的slave视图：</p>
<p>Example 10-6: Selecting which modport to use at the module instance</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> chip_bus (<span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN);</span><br><span class="line">    <span class="keyword">modport</span> master (...);</span><br><span class="line">    <span class="keyword">modport</span> slave (...);</span><br><span class="line"><span class="keyword">endinterface</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> primary (<span class="keyword">interface</span> pins); <span class="comment">// generic interface port</span></span><br><span class="line">	... </span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">module</span> secondary (chip_bus pins); <span class="comment">// specific interface port</span></span><br><span class="line">... </span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">module</span> chip (<span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN);</span><br><span class="line">    chip_bus bus (clock, resetN); 	<span class="comment">// instance of an interface</span></span><br><span class="line">    primary i1 (bus<span class="variable">.master</span>); 		<span class="comment">// use the master modport view</span></span><br><span class="line">    secondary i2 (bus<span class="variable">.slave</span>); 		<span class="comment">// use the slave modport view</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p>当在模块实例中指定要使用的 <strong>modport</strong> 时，模块定义可以使用通用接口端口类型或显式命名的接口端口类型，如第 278 页的 10.3.2 节和第 277 页的 10.3.1 节所述. 前面的示例显示了主模块的通用接口端口定义，以及辅助模块的明确命名的端口类型。</p>
<h5 id="在模块端口声明中选择-modport"><a href="#在模块端口声明中选择-modport" class="headerlink" title="在模块端口声明中选择 modport"></a>在模块端口声明中选择 modport</h5><p><strong>modport 可以在模块定义中选择</strong></p>
<p>要使用的接口的特定 modport 可以直接指定为模块端口声明的一部分。要连接到接口的 modport 指定为：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;interface_name&gt;.&lt;modport_name&gt;</span><br></pre></td></tr></table></figure>

<p>For example:</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> secondary (chip_bus<span class="variable">.slave</span> pins);</span><br><span class="line">...</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p>当要使用的 modport 被指定为模块定义的一部分时，必须在端口类型中指定显式接口名称。模块实例只是将接口实例连接到模块端口，而不指定模块端口的名称。以下代码片段显示了指定将哪个 modport 连接到模块的更完整上下文，作为模块定义的一部分。</p>
<p>Example 10-7: Selecting which modport to use at the module definition</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> chip_bus (<span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN);</span><br><span class="line">    <span class="keyword">modport</span> master (...);</span><br><span class="line">    <span class="keyword">modport</span> slave (...);</span><br><span class="line"><span class="keyword">endinterface</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> primary (chip_bus<span class="variable">.master</span> pins); <span class="comment">// use master modport</span></span><br><span class="line">	... </span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> secondary (chip_bus<span class="variable">.slave</span> pins); <span class="comment">// use slave modport</span></span><br><span class="line">	... </span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> chip (<span class="keyword">input</span> <span class="keyword">logic</span> clock, resetN);</span><br><span class="line">    chip_bus bus (clock, resetN); <span class="comment">// instance of an interface</span></span><br><span class="line">    primary i1 (bus); <span class="comment">// will use the master modport view</span></span><br><span class="line">    secondary i2 (bus); <span class="comment">// will use the slave modport view</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p><strong>注意：可以在模块实例或模块定义中选择 modport，但不能同时选择两者。</strong></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/01/12/kicad-note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zsz">
      <meta itemprop="description" content="不负光阴韶华">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/01/12/kicad-note/" class="post-title-link" itemprop="url">kicad_note</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-01-12 20:58:18 / 修改时间：22:37:48" itemprop="dateCreated datePublished" datetime="2022-01-12T20:58:18+08:00">2022-01-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/PCB/" itemprop="url" rel="index"><span itemprop="name">PCB</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Kicad-学习笔记"><a href="#Kicad-学习笔记" class="headerlink" title="Kicad 学习笔记"></a>Kicad 学习笔记</h1><h2 id="Kicad-快捷键"><a href="#Kicad-快捷键" class="headerlink" title="Kicad 快捷键"></a>Kicad 快捷键</h2><p><strong>Add a Symbol</strong> button <img src="/2022/01/12/kicad-note/add_symbol_to_schematic_24.png" alt="add symbol to schematic 24"> on the right side of the window or 快捷键 <strong>A</strong>.</p>
<p>选转 r</p>
<p>原理图操作</p>
<table>
<thead>
<tr>
<th>功能</th>
<th>操作</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>添加元件</td>
<td>a</td>
<td></td>
</tr>
<tr>
<td>旋转</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>多选对象</td>
<td>shift + click</td>
<td></td>
</tr>
<tr>
<td>取消多选对象</td>
<td>ctrl + shift + click</td>
<td></td>
</tr>
<tr>
<td>移动元件</td>
<td>m</td>
<td></td>
</tr>
<tr>
<td>拖拽</td>
<td>g</td>
<td></td>
</tr>
<tr>
<td>删除</td>
<td>del</td>
<td></td>
</tr>
<tr>
<td>连线</td>
<td>W</td>
<td></td>
</tr>
<tr>
<td>放置电源</td>
<td>p</td>
<td></td>
</tr>
<tr>
<td>添加网络name</td>
<td>L</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/12/29/IDT-note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zsz">
      <meta itemprop="description" content="不负光阴韶华">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/12/29/IDT-note/" class="post-title-link" itemprop="url">IDT_note</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-12-29 18:08:12" itemprop="dateCreated datePublished" datetime="2021-12-29T18:08:12+08:00">2021-12-29</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-01-11 17:19:49" itemprop="dateModified" datetime="2022-01-11T17:19:49+08:00">2022-01-11</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="IDT-时钟手册学习笔记"><a href="#IDT-时钟手册学习笔记" class="headerlink" title="IDT 时钟手册学习笔记"></a>IDT 时钟手册学习笔记</h1><h2 id="书目"><a href="#书目" class="headerlink" title="书目"></a>书目</h2><ul>
<li>REN_8N3Q001-8N3QV01-8N4Q001-8N4QV0_MAU_20181030.pdf<ul>
<li>订购手册</li>
<li>介绍关于IDT 8Nxxxxx系列晶振的型号手册</li>
<li>命名规则</li>
</ul>
</li>
<li>REN_8N4Q001_DST_20120307_1.pdf<ul>
<li>IDT8N4Q001系列的datasheet</li>
<li>介绍IDT8N4Q001的详细参数</li>
<li>电气特性，pcb特性</li>
</ul>
</li>
<li>REN_CER-5X7-PRG-GD_MAU_20120302_1.pdf<ul>
<li>编程手册</li>
<li>对于IDT8N4Q001FG 只需要关注第一章、第二章的Part1和example即可</li>
</ul>
</li>
</ul>
<h2 id="IDT8N4Q001FG-2059CDI-参数"><a href="#IDT8N4Q001FG-2059CDI-参数" class="headerlink" title="IDT8N4Q001FG-2059CDI 参数"></a>IDT8N4Q001FG-2059CDI 参数</h2><p>命名规则：</p>
<p><img src="/2021/12/29/IDT-note/image-20211229185533847.png" alt="image-20211229185533847"></p>
<p>所以可以得到IDT8N4Q001FG-2059CDI  是</p>
<p>LVDS 型有4个默认的频率，10pins 的XO型，电压为VCC = 2.5V±5%, ±50ppm 的LVDS 差分电平，</p>
<p>2095：Fxtal(MHz)=100.00,使用分数型的pll 反馈。</p>
<p>工业级的</p>
<p>查看表4得到：该晶振的4个默认频率都是644.53125MHz.</p>
<p><img src="/2021/12/29/IDT-note/image-20211229190539542.png" alt="image-20211229190539542"></p>
<p>注意：这个器件使用四组寄存器，可以配置四组不同的参数，通过FSEL1,FSEL0两个引脚的配置选择使用哪一组寄存器配置的频率输出。只有一组时钟输出引脚奥！！！！</p>
<p>编程寄存器框图：</p>
<p><img src="/2021/12/29/IDT-note/image-20211230032622792.png" alt="image-20211230032622792"></p>
<p>IDT8N4Q001FG 使用的Fxtal = 100M。</p>
<p>最终输出的频率由P M N 还有Fxtal 决定。</p>
<p>其中反馈器的系数M是一个25bit的寄存器，</p>
<table>
<thead>
<tr>
<th>整数部分(7bit)MINT</th>
<th>小数部分(18bit)MFRAC</th>
</tr>
</thead>
<tbody><tr>
<td>7bit</td>
<td>18bit</td>
</tr>
</tbody></table>
<p>输出频率计算公式：</p>
<p><img src="/2021/12/29/IDT-note/image-20211230034423255.png" alt="image-20211230034423255"></p>
<h2 id="编程操作"><a href="#编程操作" class="headerlink" title="编程操作"></a>编程操作</h2><h3 id="官方推荐操作方法："><a href="#官方推荐操作方法：" class="headerlink" title="官方推荐操作方法："></a>官方推荐操作方法：</h3><p>如果想要修改输出的频率值，官方推荐修改非当前FSEL选中的寄存器组，当使用IIC操作完成后再使用 FSEL来选择启用新的配置。</p>
<h3 id="计算默认频率的初始-P-M-N的值"><a href="#计算默认频率的初始-P-M-N的值" class="headerlink" title="计算默认频率的初始 P M N的值"></a>计算默认频率的初始 P M N的值</h3><p>644.53125MHz * 4 = 2578.125MHz</p>
<p>假设P = 1</p>
<p>M = 2578.125/100 = 25.78125</p>
<p>所以MINT = 25</p>
<p>MFRAC = [0.78125 - 1/2^19] * 2^18 =204799.5 </p>
<p>MFRAC 取整得到 204799 0x31FFF</p>
<p>MFRAC 四舍五入得到204800 0x32000  通过FPGA通过IIC 读出的数据确实是0x32000</p>
<p>N=4</p>
<h2 id="如何启用XO-Integer-Feedback-Programming-模式"><a href="#如何启用XO-Integer-Feedback-Programming-模式" class="headerlink" title="如何启用XO Integer-Feedback Programming 模式"></a>如何启用XO Integer-Feedback Programming 模式</h2><p>使用Integer mode 可以使用官方提供的一些频率的参数见：REN_CER-5X7-PRG-GD_MAU_20120302_1.pdf P24</p>
<ol>
<li>setting MFRAC to zero</li>
<li>disabling the DSM in the devices register for each pre-set frequency. </li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/26/FPGA-Architecture-Design/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zsz">
      <meta itemprop="description" content="不负光阴韶华">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/26/FPGA-Architecture-Design/" class="post-title-link" itemprop="url">FPGA_Architecture_Design</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-10-26 05:39:57" itemprop="dateCreated datePublished" datetime="2021-10-26T05:39:57+08:00">2021-10-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-04-11 23:30:45" itemprop="dateModified" datetime="2022-04-11T23:30:45+08:00">2022-04-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/FPFA/" itemprop="url" rel="index"><span itemprop="name">FPFA</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="FPGA-架构设计"><a href="#FPGA-架构设计" class="headerlink" title="FPGA 架构设计"></a>FPGA 架构设计</h1><h2 id="层次化设计思想"><a href="#层次化设计思想" class="headerlink" title="层次化设计思想"></a>层次化设计思想</h2><p>第一步：从接口角度出发，去看资料，想问题。</p>
<p>​    如何看资料？</p>
<p>​    1、 从头看到尾？ 错</p>
<p>2、带着问题去看资料。对</p>
<p>接口必定涉及时序，</p>
<p>将接口转化成标准的数据格式</p>
<p><img src="/2021/10/26/FPGA-Architecture-Design/image-20211026055149651.png" alt="image-20211026055149651"></p>
<h2 id="看波形"><a href="#看波形" class="headerlink" title="看波形"></a>看波形</h2><h3 id="如何看FPGA的波形？？？"><a href="#如何看FPGA的波形？？？" class="headerlink" title="如何看FPGA的波形？？？"></a>如何看FPGA的波形？？？</h3><p>记住规则：时钟上升沿看信号，总是看到前面的值。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/14/git-learn-note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zsz">
      <meta itemprop="description" content="不负光阴韶华">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/14/git-learn-note/" class="post-title-link" itemprop="url">git_learn_note</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-10-14 17:19:23" itemprop="dateCreated datePublished" datetime="2021-10-14T17:19:23+08:00">2021-10-14</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-04-11 23:46:31" itemprop="dateModified" datetime="2022-04-11T23:46:31+08:00">2022-04-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/tools/" itemprop="url" rel="index"><span itemprop="name">tools</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>目录</p>
</blockquote>
<p>[TOC]</p>
<h1 id="Git-笔记-1-基础篇"><a href="#Git-笔记-1-基础篇" class="headerlink" title="Git 笔记 1 基础篇"></a>Git 笔记 1 基础篇</h1><h2 id="Git-相关学习网站"><a href="#Git-相关学习网站" class="headerlink" title="Git 相关学习网站"></a>Git 相关学习网站</h2><p>GitHub: <a target="_blank" rel="noopener" href="https://github.com/">https://github.com/</a></p>
<p>Gitee:<a target="_blank" rel="noopener" href="https://gitee.com/">https://gitee.com/</a></p>
<p>GitLab:<a target="_blank" rel="noopener" href="https://about.gitlab.com/">https://about.gitlab.com/</a></p>
<p>学习网站：**<a target="_blank" rel="noopener" href="https://git-scm.com/book">Pro Git book</a>**</p>
<p>​    开源项目网站：</p>
<p>Git:</p>
<p>GitHub:</p>
<h2 id="版本控制"><a href="#版本控制" class="headerlink" title="版本控制"></a>版本控制</h2><blockquote>
<p> 什么是版本控制</p>
</blockquote>
<p>版本控制（Revision control）是一种在开发的过程中用于管理我们对文件、目录或工程等内容的修改历史，方便查看更改历史记录，备份以便恢复以前的版本的软件工程技术。</p>
<ul>
<li>实现跨区域多人协同开发</li>
<li>追踪和记载一个或者多个文件的历史记录</li>
<li>组织和保护你的源代码和文档</li>
<li>统计工作量</li>
<li>并行开发、提高开发效率</li>
<li>跟踪记录整个软件的开发过程</li>
<li>减轻开发人员的负担，节省时间，同时降低人为错误</li>
</ul>
<p>简单说就是用于管理多人协同开发项目的技术。</p>
<p>没有进行版本控制或者版本控制本身缺乏正确的流程管理，在软件开发过程中将会引入很多问题，如软件代码的一致性、软件内容的冗余、软件过程的事物性、软件开发过程中的并发性、软件源代码的安全性，以及软件的整合等问题。</p>
<p>无论是工作还是学习，或者是自己做笔记，都经历过这样一个阶段！我们就迫切需要一个版本控制工具！</p>
<p>多人开发就必须要使用版本控制！</p>
<blockquote>
<p>常见的版本控制工具</p>
</blockquote>
<p>我们学习的东西，一定是当下最流行的！</p>
<p>主流的版本控制器有如下这些：</p>
<ul>
<li><strong>Git</strong></li>
<li><strong>SVN</strong>（Subversion）</li>
<li><strong>CVS</strong>（Concurrent Versions System）</li>
<li><strong>VSS</strong>（Micorosoft Visual SourceSafe）</li>
<li><strong>TFS</strong>（Team Foundation Server）</li>
<li>Visual Studio Online</li>
</ul>
<p>版本控制产品非常的多（Perforce、Rational ClearCase、RCS（GNU Revision Control System）、Serena Dimention、SVK、BitKeeper、Monotone、Bazaar、Mercurial、SourceGear Vault），现在影响力最大且使用最广泛的是Git与SVN</p>
<blockquote>
<p>版本控制分类</p>
</blockquote>
<p><strong>1、本地版本控制</strong></p>
<p>记录文件每次的更新，可以对每个版本做一个快照，或是记录补丁文件，适合个人用，如RCS。</p>
<p><strong>2、集中版本控制  SVN</strong></p>
<p>所有的版本数据都保存在服务器上，协同开发者从服务器上同步更新或上传自己的修改</p>
<p>所有的版本数据都存在服务器上，用户的本地只有自己以前所同步的版本，如果不连网的话，用户就看不到历史版本，也无法切换版本验证问题，或在不同分支工作。而且，所有数据都保存在单一的服务器上，有很大的风险这个服务器会损坏，这样就会丢失所有的数据，当然可以定期备份。代表产品：SVN、CVS、VSS</p>
<p><strong>3、分布式版本控制     Git</strong></p>
<p>每个人都拥有全部的代码！安全隐患！</p>
<p>所有版本信息仓库全部同步到本地的每个用户，这样就可以在本地查看所有版本历史，可以离线在本地提交，只需在连网时push到相应的服务器或其他用户那里。由于每个用户那里保存的都是所有的版本数据，只要有一个用户的设备没有问题就可以恢复所有的数据，但这增加了本地存储空间的占用。</p>
<p>不会因为服务器损坏或者网络问题，造成不能工作的情况！</p>
<blockquote>
<p>Git与SVN的主要区别</p>
</blockquote>
<p>SVN是集中式版本控制系统，版本库是集中放在中央服务器的，而工作的时候，用的都是自己的电脑，所以首先要从中央服务器得到最新的版本，然后工作，完成工作后，需要把自己做完的活推送到中央服务器。集中式版本控制系统是必须联网才能工作，对网络带宽要求较高。</p>
<p>SVN是集中式版本控制系统，版本库是集中放在中央服务器的，而工作的时候，用的都是自己的电脑，所以首先要从中央服务器得到最新的版本，然后工作，完成工作后，需要把自己做完的活推送到中央服务器。集中式版本控制系统是必须联网才能工作，对网络带宽要求较高。</p>
<h2 id="Git-历史"><a href="#Git-历史" class="headerlink" title="Git 历史"></a>Git 历史</h2><p>同生活中的许多伟大事物一样，Git 诞生于一个极富纷争大举创新的年代。</p>
<p>Linux 内核开源项目有着为数众广的参与者。绝大多数的 Linux 内核维护工作都花在了提交补丁和保存归档的繁琐事务上(1991－2002年间)。到 2002 年，整个项目组开始启用一个专有的分布式版本控制系统 BitKeeper 来管理和维护代码。</p>
<p>Linux社区中存在很多的大佬！破解研究 BitKeeper ！</p>
<p>到了 2005 年，开发 BitKeeper 的商业公司同 Linux 内核开源社区的合作关系结束，他们收回了 Linux 内核社区免费使用 BitKeeper 的权力。这就迫使 Linux 开源社区(特别是 Linux 的缔造者 Linus Torvalds)基于使用 BitKeeper 时的经验教训，开发出自己的版本系统。（2周左右！） 也就是后来的 Git！</p>
<p><strong>Git是目前世界上最先进的分布式版本控制系统。</strong></p>
<p>Git是免费、开源的，最初Git是为辅助 Linux 内核开发的，来替代 BitKeeper！</p>
<p>Linux和Git之父李纳斯·托沃兹（Linus Benedic Torvalds）1969、芬兰</p>
<h2 id="Git-环境配置"><a href="#Git-环境配置" class="headerlink" title="Git 环境配置"></a>Git 环境配置</h2><blockquote>
<p>软件下载</p>
</blockquote>
<p>打开 [git官网] <a target="_blank" rel="noopener" href="https://git-scm.com/%EF%BC%8C%E4%B8%8B%E8%BD%BDgit%E5%AF%B9%E5%BA%94%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%89%88%E6%9C%AC%E3%80%82">https://git-scm.com/，下载git对应操作系统的版本。</a></p>
<p>所有东西下载慢的话就可以去找镜像！</p>
<p>官网下载太慢，我们可以使用淘宝镜像下载：<a target="_blank" rel="noopener" href="http://npm.taobao.org/mirrors/git-for-windows/">http://npm.taobao.org/mirrors/git-for-windows/</a></p>
<p><img src="/2021/10/14/git-learn-note/image-20211015040748965.png" alt="image-20211015040748965"></p>
<blockquote>
<p>先卸载</p>
</blockquote>
<p>直接反安装即可，然后清理环境变量，环境变量只是为了全局使用而以！</p>
<p>下载对应的版本即可安装！</p>
<p>安装：无脑下一步即可！安装完毕就可以使用了！</p>
<blockquote>
<p>启动Git</p>
</blockquote>
<p>安装成功后在开始菜单中会有Git项，菜单下有3个程序：任意文件夹下右键也可以看到对应的程序！</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015041239171.png" alt="image-20211015041239171"></p>
<p><strong>Git Bash：</strong>Unix与Linux风格的命令行，使用最多，推荐最多</p>
<p><strong>Git CMD：</strong>Windows风格的命令行</p>
<p><strong>Git GUI</strong>：图形界面的Git，不建议初学者使用，尽量先熟悉常用命令</p>
<blockquote>
<p>常用的Linux命令</p>
</blockquote>
<p>平时一定要多使用这些基础的命令！</p>
<p>1）、cd : 改变目录。</p>
<p>2）、cd . . 回退到上一个目录，直接cd进入默认目录</p>
<p>3）、pwd : 显示当前所在的目录路径。</p>
<p>4）、ls(ll):  都是列出当前目录中的所有文件，只不过ll(两个ll)列出的内容更为详细。</p>
<p>5）、touch : 新建一个文件 如 touch index.js 就会在当前目录下新建一个index.js文件。</p>
<p>6）、rm:  删除一个文件, rm index.js 就会把index.js文件删除。</p>
<p>7）、mkdir:  新建一个目录,就是新建一个文件夹。</p>
<p>8）、rm -r :  删除一个文件夹, rm -r src 删除src目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /  切勿在Linux中尝试！删除电脑中全部文件！</span><br></pre></td></tr></table></figure>

<p>9）、mv 移动文件, mv index.html src index.html 是我们要移动的文件, src 是目标文件夹,当然, 这样写,必须保证文件和目标文件夹在同一目录下。</p>
<p>10）、reset 重新初始化终端/清屏。</p>
<p>11）、linux:clear 清屏。windows:cls</p>
<p>12）、history 查看命令历史。</p>
<p>13）、help 帮助。</p>
<p>14）、exit 退出。</p>
<p>15）、#表示注释</p>
<blockquote>
<p>Git 配置</p>
</blockquote>
<p>所有的配置文件，其实都在本地！</p>
<p>查看胚配置 git config -l</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git config -l</span></span><br><span class="line">diff.astextplain.textconv=astextplain</span><br><span class="line">filter.lfs.clean=git-lfs clean -- %f</span><br><span class="line">filter.lfs.smudge=git-lfs smudge -- %f</span><br><span class="line">filter.lfs.process=git-lfs filter-process</span><br><span class="line">filter.lfs.required=true</span><br><span class="line">http.sslbackend=openssl</span><br><span class="line">http.sslcainfo=D:/Program Files/Git/mingw64/ssl/certs/ca-bundle.crt</span><br><span class="line">core.autocrlf=true</span><br><span class="line">core.fscache=true</span><br><span class="line">core.symlinks=false</span><br><span class="line">credential.helper=manager</span><br><span class="line">user.name=&lt;U+0083&gt;&lt;U+0096&gt;Taurus-ZSZ</span><br><span class="line">user.nemail=taurus_aries@163.com</span><br><span class="line">user.email=&lt;U+0083&gt;taurus_aries@163.com</span><br><span class="line">core.repositoryformatversion=0</span><br><span class="line">core.filemode=false</span><br><span class="line">core.bare=false</span><br><span class="line">core.logallrefupdates=true</span><br><span class="line">core.symlinks=false</span><br><span class="line">core.ignorecase=true</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>查看不同级别的配置文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看系统的配置</span></span><br><span class="line">git config --system --list</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看当前用户(global)配置</span></span><br><span class="line">git config --global --list</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash">git config --system --list</span></span><br><span class="line">diff.astextplain.textconv=astextplain</span><br><span class="line">filter.lfs.clean=git-lfs clean -- %f</span><br><span class="line">filter.lfs.smudge=git-lfs smudge -- %f</span><br><span class="line">filter.lfs.process=git-lfs filter-process</span><br><span class="line">filter.lfs.required=true</span><br><span class="line">http.sslbackend=openssl</span><br><span class="line">http.sslcainfo=D:/Program Files/Git/mingw64/ssl/certs/ca-bundle.crt</span><br><span class="line">core.autocrlf=true</span><br><span class="line">core.fscache=true</span><br><span class="line">core.symlinks=false</span><br><span class="line">credential.helper=manager</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Git-相关的配置文件"><a href="#Git-相关的配置文件" class="headerlink" title="Git 相关的配置文件"></a>Git 相关的配置文件</h3><p>1）、Git\etc\gitconfig  ：Git 安装目录下的 gitconfig   –system 系统级</p>
<p>2）、C:\Users\Administrator\ .gitconfig   只适用于当前登录用户的配置  –global 全局</p>
<p>系统配置</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015035909953.png" alt="image-20211015035909953"></p>
<p>用户配置</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015040001545.png" alt="image-20211015040001545"></p>
<p>这里可以直接编辑配置文件，通过命令设置后会响应到这里。</p>
<blockquote>
<p>设置用户名与邮箱（用户标识，必要）</p>
</blockquote>
<p>当你安装Git后首先要做的事情是设置你的用户名称和e-mail地址。这是非常重要的，因为每次Git提交都会使用该信息。它被永远的嵌入到了你的提交中：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;Taurus-ZSZ&quot;</span><br><span class="line"></span><br><span class="line">git config --global user.email &quot;taurus_aries@163.com&quot;</span><br></pre></td></tr></table></figure>

<p>只需要做一次这个设置，如果你传递了–global 选项，因为Git将总是会使用该信息来处理你在系统中所做的一切操作。如果你希望在一个特定的项目中使用不同的名称或e-mail地址，你可以在该项目中运行该命令而不要–global选项。总之–global为全局配置，不加为某个项目的特定配置。</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015041315044.png" alt="image-20211015041315044"></p>
<h2 id="Git-基本理论基础"><a href="#Git-基本理论基础" class="headerlink" title="Git 基本理论基础"></a>Git 基本理论基础</h2><blockquote>
<p>三个区域</p>
</blockquote>
<p>Git本地有三个工作区域：工作目录（Working Directory）、暂存区(Stage/Index)、资源库(Repository或Git Directory)。如果在加上远程的git仓库(Remote Directory)就可以分为四个工作区域。文件在这四个区域之间的转换关系如下：</p>
<p><img src="/2021/10/14/git-learn-note/git_yuanli.jpg" alt="git_yuanli"></p>
<p><img src="/2021/10/14/git-learn-note/git_1.png" alt="git_1"></p>
<ul>
<li>Workspace：工作区，就是你平时存放项目代码的地方</li>
<li>Index / Stage：暂存区，用于临时存放你的改动，事实上它只是一个文件，保存即将提交到文件列表信息</li>
<li>Repository：仓库区（或本地仓库），就是安全存放数据的位置，这里面有你提交到所有版本的数据。其中HEAD指向最新放入仓库的版本</li>
<li>Remote：远程仓库，托管代码的服务器，可以简单的认为是你项目组中的一台电脑用于远程数据交换</li>
</ul>
<p>本地的三个区域确切的说应该是git仓库中HEAD指向的版本：</p>
<p><img src="/2021/10/14/git-learn-note/640.png" alt="图片"></p>
<ul>
<li>Directory：使用Git管理的一个目录，也就是一个仓库，包含我们的工作空间和Git的管理空间。</li>
<li>WorkSpace：需要通过Git进行版本控制的目录和文件，这些目录和文件组成了工作空间。</li>
<li>.git：存放Git管理信息的目录，初始化仓库的时候自动创建。</li>
<li>Index/Stage：暂存区，或者叫待提交更新区，在提交进入repo之前，我们可以把所有的更新放在暂存区。</li>
<li>Local Repo：本地仓库，一个存放在本地的版本库；HEAD会只是当前的开发分支（branch）。</li>
<li>Stash：隐藏，是一个工作状态保存栈，用于保存/恢复WorkSpace中的临时状态。</li>
</ul>
<blockquote>
<p>工作流程</p>
</blockquote>
<p>git的工作流程一般是这样的：</p>
<p>１、在工作目录中添加、修改文件；</p>
<p>２、将需要进行版本管理的文件放入暂存区域；git add filexxx</p>
<p>３、将暂存区域的文件提交到git仓库。 git commit -m “ 这里是注释”</p>
<p>因此，git管理的文件有三种状态：已修改（modified）,已暂存（staged）,已提交(committed)</p>
<p><img src="/2021/10/14/git-learn-note/640.png" alt="图片"></p>
<h2 id="Git-项目搭建"><a href="#Git-项目搭建" class="headerlink" title="Git 项目搭建"></a>Git 项目搭建</h2><blockquote>
<p>创建工作目录，与常用指令</p>
</blockquote>
<p>工作目录（WorkSpace)一般就是你希望Git帮助你管理的文件夹，可以是你项目的目录，也可以是一个空目录，建议不要有中文。</p>
<p>日常使用只要记住下图6个命令：</p>
<p><img src="/2021/10/14/git-learn-note/641.png" alt="640"></p>
<blockquote>
<p>本地仓库搭建</p>
</blockquote>
<p>创建本地仓库的方法有两种：一种是创建全新的仓库，另一种是克隆远程仓库</p>
<p>1、创建全新的仓库，需要用GIT管理的项目的根目录执行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">在当前目录新建一个Git代码库</span></span><br><span class="line">git init</span><br></pre></td></tr></table></figure>

<p>2、执行后可以看到，仅仅在项目目录多出了一个.git目录，关于版本等的所有信息都在这个目录里面。</p>
<blockquote>
<p>克隆远程仓库</p>
</blockquote>
<p>1、另一种方式是克隆远程目录，由于是将远程服务器上的仓库完全镜像一份至本地！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 克隆一个项目和它的整个代码历史(版本信息)</span></span><br><span class="line">git clone git@192.168.1.200:xx01_fpga/xx01_fpga_proj.git</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2、去gitee 或者github上克隆一个测试！</p>
<h2 id="Git-文件操作"><a href="#Git-文件操作" class="headerlink" title="Git 文件操作"></a>Git 文件操作</h2><blockquote>
<p>文件的四种状态</p>
</blockquote>
<p>版本控制就是对文件的版本控制，要对文件进行修改、提交等操作，首先要知道文件当前在什么状态，不然可能会提交了现在还不想提交的文件，或者要提交的文件没提交上。</p>
<ul>
<li>Untracked: 未跟踪, 此文件在文件夹中, 但并没有加入到git库, 不参与版本控制. 通过git add 状态变为Staged.</li>
<li>Unmodify: 文件已经入库, 未修改, 即版本库中的文件快照内容与文件夹中完全一致. 这种类型的文件有两种去处, 如果它被修改, 而变为Modified. 如果使用git rm移出版本库, 则成为Untracked文件</li>
<li>Modified: 文件已修改, 仅仅是修改, 并没有进行其他的操作. 这个文件也有两个去处, 通过git add可进入暂存staged状态, 使用git  checkout 则丢弃修改过, 返回到unmodify状态, 这个git checkout即从库中取出文件, 覆盖当前修改 !</li>
<li>Staged: 暂存状态. 执行git commit则将修改同步到库中, 这时库中的文件和本地文件又变为一致, 文件为Unmodify状态. 执行git reset HEAD filename取消暂存, 文件状态为Modified</li>
</ul>
<blockquote>
<p>查看文件状态</p>
</blockquote>
<p>上面说文件有4种状态，通过如下命令可以查看到文件的状态：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看指定文件状态</span></span><br><span class="line">git status [filename]</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看所有文件状态</span></span><br><span class="line">git status</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> git add .                  添加所有文件到暂存区</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> git commit -m <span class="string">&quot;消息内容&quot;</span>    提交暂存区中的内容到本地仓库 -m 提交信息</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>忽略文件</p>
</blockquote>
<p>有些时候我们不想把某些文件纳入版本控制中，比如数据库文件，临时文件，设计文件等</p>
<p>在主目录下建立”.gitignore”文件，此文件有如下规则：</p>
<ol>
<li>忽略文件中的空行或以井号（#）开始的行将会被忽略。</li>
<li>可以使用Linux通配符。例如：星号（*）代表任意多个字符，问号（？）代表一个字符，方括号（[abc]）代表可选字符范围，大括号（{string1,string2,…}）代表可选的字符串等。</li>
<li>如果名称的最前面有一个感叹号（!），表示例外规则，将不被忽略。</li>
<li>如果名称的最前面是一个路径分隔符（/），表示要忽略的文件在此目录下，而子目录中的文件不忽略。</li>
<li>如果名称的最后面是一个路径分隔符（/），表示要忽略的是此目录下该名称的子目录，而非文件（默认文件或目录都忽略）。</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">为注释</span></span><br><span class="line">*.txt        #忽略所有 .txt结尾的文件,这样的话上传就不会被选中！</span><br><span class="line">!lib.txt     #但lib.txt除外</span><br><span class="line">/temp        #仅忽略项目根目录下的TODO文件,不包括其它目录temp</span><br><span class="line">build/       #忽略build/目录下的所有文件</span><br><span class="line">doc/*.txt    #会忽略 doc/notes.txt 但不包括 doc/server/arch.txt</span><br></pre></td></tr></table></figure>



<h2 id="使用码云"><a href="#使用码云" class="headerlink" title="使用码云"></a>使用码云</h2><blockquote>
<p>github 是有墙的，比较慢，在国内的话，我们一般使用 gitee ，公司中有时候会搭建自己的gitlab服务器</p>
</blockquote>
<p>这个其实可以作为大家未来找工作的一个重要信息！</p>
<p>1、注册登录码云，完善个人信息</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015045712169.png" alt="image-20211015045712169"></p>
<p>2、设置本机绑定SSH公钥，实现免密码登录！（免密码登录，这一步挺重要的，码云是远程仓库，我们是平时工作在本地仓库！)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 进入 C:\Users\Administrator\.ssh 目录</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成公钥</span></span><br><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure>

<p><img src="/2021/10/14/git-learn-note/642.png" alt="642"></p>
<p>3、将公钥信息public key 添加到码云账户中即可！</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015050840189.png" alt="image-20211015050840189"></p>
<p>4、使用码云创建一个自己的仓库！</p>
<p>许可证：开源是否可以随意转载，开源但是不能商业使用，不能转载，   限制。</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015051320032.png" alt="image-20211015051320032"></p>
<p>克隆远程仓库到本地</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015051536756.png" alt="image-20211015051536756"></p>
<p>本地跟远程的仓库就一样的</p>
<p>测试：</p>
<ul>
<li>添加到暂存区</li>
<li>commit 提交</li>
<li>push到远程仓库</li>
</ul>
<h2 id="Git-分支"><a href="#Git-分支" class="headerlink" title="Git 分支"></a>Git 分支</h2><p>分支在GIT中相对较难，分支就是科幻电影里面的平行宇宙，如果两个平行宇宙互不干扰，那对现在的你也没啥影响。不过，在某个时间点，两个平行宇宙合并了，我们就需要处理一些问题了！</p>
<p><img src="/2021/10/14/git-learn-note/643.png" alt="643"></p>
<p><img src="/2021/10/14/git-learn-note/644.png" alt="644"></p>
<p>git分支中常用指令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 列出所有本地分支</span><br><span class="line">git branch</span><br><span class="line"># 列出所有远程分支</span><br><span class="line">git branch -r</span><br><span class="line"># 新建一个分支，但依然停留在当前分支</span><br><span class="line">git branch [branch-name]</span><br><span class="line"># 新建一个分支，并切换到该分支</span><br><span class="line">git checkout -b [branch]</span><br><span class="line"># 合并指定分支到当前分支</span><br><span class="line">$ git merge [branch]</span><br><span class="line"># 删除分支</span><br><span class="line">$ git branch -d [branch-name]</span><br><span class="line"># 删除远程分支</span><br><span class="line">$ git push origin --delete [branch-name]</span><br><span class="line">$ git branch -dr [remote/branch]</span><br></pre></td></tr></table></figure>

<p>如果同一个文件在合并分支时都被修改了则会引起冲突：解决的办法是我们可以修改冲突文件后重新提交！选择要保留他的代码还是你的代码！</p>
<p>master主分支应该非常稳定，用来发布新版本，一般情况下不允许在上面工作，工作一般情况下在新建的dev分支上工作，工作完后，比如上要发布，或者说dev分支代码稳定后可以合并到主分支master上来。</p>
<p>作业练习：找一个小伙伴，一起搭建一个远程仓库，来练习Git！</p>
<p>1、不要把Git想的很难，工作中多练习使用就自然而然的会了！</p>
<p>2、Git的学习也十分多，看完Git教程之后，可以多去思考，总结到自己博客！</p>
<h1 id="Git-学习笔记-进阶篇"><a href="#Git-学习笔记-进阶篇" class="headerlink" title="Git 学习笔记 - 进阶篇"></a>Git 学习笔记 - 进阶篇</h1><h2 id="Git-理论基础"><a href="#Git-理论基础" class="headerlink" title="Git 理论基础"></a>Git 理论基础</h2><h3 id="初次使用Git前的配置"><a href="#初次使用Git前的配置" class="headerlink" title="初次使用Git前的配置"></a>初次使用Git前的配置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">git config --global user.name &quot;zsz&quot;</span><br><span class="line">git config --global user.email &quot;zsz2668838984@qq.com&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看配置信息：</span></span><br><span class="line">git config --list</span><br><span class="line"><span class="meta">#</span><span class="bash">下面会显示你的配置</span></span><br><span class="line">……</span><br></pre></td></tr></table></figure>



<h3 id="命令行与GUI"><a href="#命令行与GUI" class="headerlink" title="命令行与GUI"></a>命令行与GUI</h3><p>Git 有Git 原生态的命令行模式，也有GUI界面，但是大多数界面只是实现Git常用的命令，而命令行模式拥有Git的所有命令。熟悉命令行模式后，GUI自然也就会了。</p>
<h3 id="理论基础"><a href="#理论基础" class="headerlink" title="理论基础"></a>理论基础</h3><h4 id="Git-记录的是什么"><a href="#Git-记录的是什么" class="headerlink" title="Git 记录的是什么"></a>Git 记录的是什么</h4><p>SVN 记录的是每一次版本的变动内容</p>
<p><img src="/2021/10/14/git-learn-note/image-20211014174251560.png" alt="image-20211014174251560"></p>
<p>Git 则是将每个版本独立保存。</p>
<p><img src="/2021/10/14/git-learn-note/image-20211014174313344.png" alt="image-20211014174313344"></p>
<h4 id="三棵树-："><a href="#三棵树-：" class="headerlink" title="三棵树 ："></a>三棵树 ：</h4><p>工作区域、暂存区域和Git仓库</p>
<p>工作区域：</p>
<p>暂存区域</p>
<p>Git仓库</p>
<p><img src="/2021/10/14/git-learn-note/image-20211014174456570.png" alt="image-20211014174456570"></p>
<h4 id="Git-的工作流程"><a href="#Git-的工作流程" class="headerlink" title="Git 的工作流程"></a>Git 的工作流程</h4><p>Git 的工作流程一般是这样的：</p>
<ol>
<li>在工作目录中添加、修改文件</li>
<li>将需要进行版本管理的文件放入暂存区域</li>
<li>将暂存区域的文件提交到Git仓库</li>
</ol>
<h4 id="Git-管理的文件有三种状态"><a href="#Git-管理的文件有三种状态" class="headerlink" title="Git 管理的文件有三种状态"></a>Git 管理的文件有三种状态</h4><ul>
<li>已修改（modified）</li>
<li>已暂存（staged)</li>
<li>已提交（committed）</li>
</ul>
<h3 id="实战演练"><a href="#实战演练" class="headerlink" title="实战演练"></a>实战演练</h3><h4 id="创建一个文件夹"><a href="#创建一个文件夹" class="headerlink" title="创建一个文件夹"></a>创建一个文件夹</h4><p>​    E:\my_test</p>
<p>​    打开文件夹my_test</p>
<h4 id="初始化创建一个本地仓库"><a href="#初始化创建一个本地仓库" class="headerlink" title="初始化创建一个本地仓库"></a>初始化创建一个本地仓库</h4><p>1、右键点击git bash here 进入一个小的黑框框</p>
<p><img src="/2021/10/14/git-learn-note/image-20211014175418247.png" alt="image-20211014175418247"></p>
<p>2、输入命令初始化</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git init </span><br><span class="line"><span class="meta">#</span><span class="bash">初始化空的仓库</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/10/14/git-learn-note/image-20211014175557446.png" alt="image-20211014175557446"></p>
<p><img src="/2021/10/14/git-learn-note/image-20211014175628899.png" alt="image-20211014175628899"></p>
<p>3、 创建README.md</p>
<p>建议使用utf-8 无BOM 格式 兼容性设置</p>
<p>4、添加文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git add README.md</span><br><span class="line"><span class="meta">#</span><span class="bash">将文件添加到暂存区</span></span><br><span class="line"><span class="meta">#</span><span class="bash">添加到暂存区的操作时比较频繁的所以没有报告状态</span></span><br><span class="line"><span class="meta">#</span><span class="bash">而git commit 是一个版本的最后议题提交，所以报告一下状态。</span></span><br></pre></td></tr></table></figure>

<p>5、将暂存区的文件提交到Git仓库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&quot;add a readme file&quot;</span></span></span><br><span class="line">[master (root-commit) dac16cc] add a readme file</span><br><span class="line"> 1 file changed, 2 insertions(+)</span><br><span class="line"> create mode 100644 README.md</span><br><span class="line"></span><br><span class="line">-m 参数为添加注释</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><blockquote>
<p>将工作目录的文件放到Git仓库只需要两步：</p>
</blockquote>
<ol>
<li>创建初始化仓库使用 git inint </li>
<li>将工作区中文件添加到暂存区使用:git add 文件名</li>
<li>将暂存区的文件提交到本地仓库使用:git commit -m “这里填写你的注释”</li>
</ol>
<h2 id="查看工作状态和历史提交"><a href="#查看工作状态和历史提交" class="headerlink" title="查看工作状态和历史提交"></a>查看工作状态和历史提交</h2><h3 id="查看状态-git-status"><a href="#查看状态-git-status" class="headerlink" title="查看状态 git status"></a>查看状态 git status</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master		#提示所在的分支，master</span><br><span class="line">nothing to commit, working tree clean #提示 说你的工作目录是干净的，你的工作目录在上次提交后没有改动。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>协议：</p>
<p>MIT 协议：协议里最开放的一个。</p>
<blockquote>
<p>被许可人权利</p>
</blockquote>
<p>特此授予任何人免费获得本软件和相关文档文件（“软件”）副本的许可，不受限制地处理本软件，包括但不限于使用、复制、修改、合并 、发布、分发、再许可的权利， 被许可人有权利使用、复制、修改、合并、出版发行、散布、再许可和/或贩售软件及软件的副本，及授予被供应人同等权利，惟服从以下义务。</p>
<blockquote>
<p>被许可人义务</p>
</blockquote>
<p>在软件和软件的所有副本中都必须包含以上著作权声明和本许可声明</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Copyright (C) &lt;year&gt; &lt;copyright holders&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</span><br><span class="line"></span><br><span class="line">The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</span><br><span class="line"></span><br><span class="line">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span><br></pre></td></tr></table></figure>

<h4 id="在工作目录创建一个MIT的LICENSE"><a href="#在工作目录创建一个MIT的LICENSE" class="headerlink" title="在工作目录创建一个MIT的LICENSE"></a>在工作目录创建一个MIT的LICENSE</h4><p>再次查看状态:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$git status</span><br><span class="line">On branch master</span><br><span class="line">Untracked files:	#提示未追踪的文件</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span><br><span class="line">        LICENSE</span><br><span class="line"></span><br><span class="line">nothing added to commit but untracked files present (use &quot;git add&quot; to track)#提示的推荐命令</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2021/10/14/git-learn-note/image-20211014203430288.png" alt="image-20211014203430288"></p>
<h4 id="添加文件到暂存区"><a href="#添加文件到暂存区" class="headerlink" title="添加文件到暂存区"></a>添加文件到暂存区</h4><p><img src="/2021/10/14/git-learn-note/image-20211014203622903.png" alt="image-20211014203622903"></p>
<h4 id="将暂存区的文件取消暂存"><a href="#将暂存区的文件取消暂存" class="headerlink" title="将暂存区的文件取消暂存"></a>将暂存区的文件取消暂存</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git restore --staged &lt;file&gt;</span><br></pre></td></tr></table></figure>



<p><img src="/2021/10/14/git-learn-note/image-20211014203946471.png" alt="image-20211014203946471"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&quot;add a LICENSE file&quot;</span></span></span><br><span class="line">[master 0c533b6] add a LICENSE file</span><br><span class="line"> 1 file changed, 8 insertions(+)</span><br><span class="line"> create mode 100644 LICENSE</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"></span></span><br><span class="line"><span class="bash"></span></span><br></pre></td></tr></table></figure>

<h4 id="修改LICENSE文件后查看状态"><a href="#修改LICENSE文件后查看状态" class="headerlink" title="修改LICENSE文件后查看状态"></a>修改LICENSE文件后查看状态</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">修改LICENSE文件</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   LICENSE</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="从暂存区回退工作区git-restore-file"><a href="#从暂存区回退工作区git-restore-file" class="headerlink" title="从暂存区回退工作区git restore file"></a>从暂存区回退工作区git restore file</h4><p>这个命令会将我们工作区的修改给覆盖掉</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash">git restore LICENSE</span></span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash">git status</span></span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>原文件</p>
<p><img src="/2021/10/14/git-learn-note/image-20211014205718972.png" alt="image-20211014205718972"></p>
<p>执行 git restore LICENSE 后修改被覆盖</p>
<p><img src="/2021/10/14/git-learn-note/image-20211014205602349.png" alt="image-20211014205602349"></p>
<p>再次修改原文件，</p>
<p><img src="/2021/10/14/git-learn-note/image-20211014205858311.png" alt="image-20211014205858311"></p>
<p>添加到暂存区：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git add LICENSE</span></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span><br><span class="line">        modified:   LICENSE</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>暂时先不提交，再次修改</p>
<p><img src="/2021/10/14/git-learn-note/image-20211014210208023.png" alt="image-20211014210208023"></p>
<p>再次查看状态：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:#等待被提交到仓库</span><br><span class="line">  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span><br><span class="line">        modified:   LICENSE#在暂存区</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   LICENSE	##在工作目录中，等待添加到暂存区</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment">#上面这个情况是这样的：</span></span></span><br><span class="line">上面第一个是在暂存区中的文件，下面的这个是在工作目录中的文件 </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">如果这个时候直接使用git commit -m <span class="string">&quot;&quot;</span> 这个时候是只将暂存区中的文件提交到本地仓库。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">如果这个时候使用git add LICENSE 这时是将工作目录中的LICENSE覆盖暂存区中的文件，然后再使用git commit -m <span class="string">&quot;  &quot;</span>就是将之前工作目录中的最新修改提交到了git仓库中了。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="查看历史提交-git-log"><a href="#查看历史提交-git-log" class="headerlink" title="查看历史提交 git log"></a>查看历史提交 git log</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span></span></span><br><span class="line">commit 0c533b6c3f50773947d28f884d1cfce0431fc251 (HEAD -&gt; master)</span><br><span class="line">Author: &lt;U+0083&gt;&lt;U+0096&gt;Taurus-ZSZ &lt;&lt;U+0083&gt;taurus_aries@163.com&gt;#作者 #邮箱</span><br><span class="line">Date:   Thu Oct 14 20:42:24 2021 +0800</span><br><span class="line"></span><br><span class="line">    add a LICENSE file  #注释</span><br><span class="line"></span><br><span class="line">commit dac16cca7dc9bcea305f7c873633b3d2511a7cb2#ID 这是唯一的</span><br><span class="line">Author: &lt;U+0083&gt;&lt;U+0096&gt;Taurus-ZSZ &lt;&lt;U+0083&gt;taurus_aries@163.com&gt;</span><br><span class="line">Date:   Thu Oct 14 18:01:56 2021 +0800</span><br><span class="line"></span><br><span class="line">    add a readme file</span><br><span class="line"></span><br><span class="line"> </span><br></pre></td></tr></table></figure>



<h2 id="回到过去"><a href="#回到过去" class="headerlink" title="回到过去"></a>回到过去</h2><p><img src="/2021/10/14/git-learn-note/image-20211014212905247.png" alt="image-20211014212905247"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git reset HEAD~ <span class="comment">#回退到上一个版本，回滚到上一个快照（HEAD的上一个版本）</span></span></span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span></span></span><br><span class="line">commit dac16cca7dc9bcea305f7c873633b3d2511a7cb2 (HEAD -&gt; master)</span><br><span class="line">Author: &lt;U+0083&gt;&lt;U+0096&gt;Taurus-ZSZ &lt;&lt;U+0083&gt;taurus_aries@163.com&gt;</span><br><span class="line">Date:   Thu Oct 14 18:01:56 2021 +0800</span><br><span class="line"></span><br><span class="line">    add a readme file</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Untracked files:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span><br><span class="line">        LICENSE</span><br><span class="line"></span><br><span class="line">nothing added to commit but untracked files present (use &quot;git add&quot; to track)</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/my_test (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment">#之前的快照并没有丢，只是HEAD 指向了前一个，</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>reset 命令的选项</p>
<p>git reset –mixed HEAD~</p>
<ul>
<li>移动HEAD的指向，将其指向上一个快照</li>
<li>将HEAD移动后指向的快照回滚到暂存区</li>
</ul>
<p>git reset –soft HEAD~</p>
<ul>
<li>移动HEAD的指向，将其指向上一个快照(相当于撤销一次错误的提交)</li>
</ul>
<p>git reset –hard HEAD~</p>
<ul>
<li>移动HEAD的指向，将其指向上一个快照</li>
<li>将HEAD移动后指向的快照回滚到暂存区</li>
<li>将暂存区域的文件还原到工作目录</li>
</ul>
<p>reset 命令回滚快照三部曲</p>
<ol>
<li><p>移动HEAD的指向（–soft）</p>
</li>
<li><p>将快照回滚到暂存区域（[–mixed], 默认）</p>
</li>
<li><p>将快照暂存区还原到工作目录（–hard）==有危险奥==</p>
</li>
</ol>
<h4 id="回滚到指定的快照"><a href="#回滚到指定的快照" class="headerlink" title="回滚到指定的快照"></a>回滚到指定的快照</h4><p>git reset 快照ID</p>
<h4 id="回滚个别文件"><a href="#回滚个别文件" class="headerlink" title="回滚个别文件"></a>回滚个别文件</h4><p>git reset  版本快照ID    文件名/路径</p>
<h4 id="还可以往前滚"><a href="#还可以往前滚" class="headerlink" title="还可以往前滚"></a>还可以往前滚</h4><p>git reset  版本快照ID</p>
<h2 id="版本对比"><a href="#版本对比" class="headerlink" title="版本对比"></a>版本对比</h2><ol>
<li><p>新建一个文件夹Myproject2,并初始化为本地仓库</p>
<p>进入文件夹并右键git bash here </p>
<p>输入: git init</p>
</li>
<li><p>第二步</p>
<ul>
<li>我们我们创建一个.py的代码，</li>
<li>在创建一个README.md文件，写清楚这是一个课后作业项目</li>
</ul>
</li>
<li><p>第三步</p>
<ul>
<li><p>执行git add README.md test.py 命令将两个文件都添加到暂存区</p>
</li>
<li><p>接着执行git commit -m “hello world 打印”提交项目的第一个快照</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git add *</span></span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line"></span><br><span class="line">No commits yet</span><br><span class="line"></span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git rm --cached &lt;file&gt;...&quot; to unstage)</span><br><span class="line">        new file:   README.md</span><br><span class="line">        new file:   test.py</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&quot;hello world 打印&quot;</span></span></span><br><span class="line">[master (root-commit) 8ddfea5] hello world 打印</span><br><span class="line"> 2 files changed, 6 insertions(+)</span><br><span class="line"> create mode 100644 README.md</span><br><span class="line"> create mode 100644 test.py</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"></span></span><br><span class="line"><span class="bash"></span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>第四步</p>
<ul>
<li>接着我们改写一下test.py代码</li>
<li>README.md文件也要改一下</li>
</ul>
<h4 id="比较暂存区与工作目录-git-diff"><a href="#比较暂存区与工作目录-git-diff" class="headerlink" title="比较暂存区与工作目录 git diff"></a>比较暂存区与工作目录 git diff</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git diff</span></span><br><span class="line">diff --git a/README.md b/README.md #比较暂存区域的文件 和工作区域的文件，分别拷贝到了 a b两个文件夹</span><br><span class="line">index 0f2c569..970f910 100644	#0f2c569..970f910 表示两个文件的ID 100644表示文件类型与权限</span><br><span class="line">--- a/README.md #暂存区的文件 ---表示旧文件</span><br><span class="line">+++ b/README.md #工作区的文件 +++表示新文件</span><br><span class="line">@@ -1 +1,2 @@ #-1 表示旧文件的第1行 +1，2表示新文件的开始行数，持续的行数</span><br><span class="line">-﻿课后作业：文字游戏#旧文件</span><br><span class="line">\ No newline at end of file#git的善意提醒，git添加的换行符</span><br><span class="line">+﻿零基础入门学习git第5讲#新文件的添加</span><br><span class="line">+课后作业：文字游戏#新文件的添加</span><br><span class="line">\ No newline at end of file</span><br><span class="line">diff --git a/test.py b/test.py</span><br><span class="line">index c936972..670104c 100644</span><br><span class="line">--- a/test.py</span><br><span class="line">+++ b/test.py</span><br><span class="line">@@ -2,4 +2,5 @@</span><br><span class="line"> import os</span><br><span class="line"></span><br><span class="line"> print(&#x27;hello world!!!!&#x27;)</span><br><span class="line">-print(&#x27;当前文件夹是：&#x27; + os.getcwd())</span><br><span class="line">\ No newline at end of file</span><br><span class="line">+print(&#x27;当前文件夹是：&#x27; + os.getcwd())</span><br><span class="line">+print(&#x27;你好棒！！&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<p>linux vim 查找 /查找的内容 回车 n下一个 N 上一个</p>
<p>使用 h 产看help</p>
<h3 id="比较两个历史快照"><a href="#比较两个历史快照" class="headerlink" title="比较两个历史快照"></a>比较两个历史快照</h3><p>git diff 快照ID1 快照ID2 </p>
<p>1、添加上次修改到暂存区，commit 提交到本地仓库。</p>
<p>2、使用git log可以看到有两个快照啦！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git add *</span></span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&quot;第二次修改&quot;</span></span></span><br><span class="line">[master 75b12fa] 第二次修改</span><br><span class="line"> 2 files changed, 4 insertions(+), 2 deletions(-)</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span></span></span><br><span class="line">commit 75b12fa12d66fcfc64b66a71c0f2ccffacaf8964 (HEAD -&gt; master)</span><br><span class="line">Author: Taurus-ZSZ &lt;taurus_aries@163.com&gt;</span><br><span class="line">Date:   Fri Oct 15 15:41:07 2021 +0800</span><br><span class="line"></span><br><span class="line">    第二次修改</span><br><span class="line"></span><br><span class="line">commit 8ddfea5df21b5c6a37b341bd56c21abbae3f15b0</span><br><span class="line">Author: Taurus-ZSZ &lt;taurus_aries@163.com&gt;</span><br><span class="line">Date:   Fri Oct 15 06:59:08 2021 +0800</span><br><span class="line"></span><br><span class="line">    hello world 打印</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>3、比较两个快照</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">![image-20211015155554209](git-learn-note/image-20211015155554209.png)</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## 比较当前工作目录和Git 仓库中的快照</span></span></span><br><span class="line"></span><br><span class="line">git diff 快照ID #比较当前工作区与仓库中的历史快照ID</span><br><span class="line"></span><br><span class="line">git diff HEAD  #比较当前工作区与仓库中HEAD指向的快照，一般是上一次提交的快照</span><br><span class="line"></span><br><span class="line">![image-20211015160255592](git-learn-note/image-20211015160255592.png)</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## 比较暂存区与仓库快照</span></span></span><br><span class="line"></span><br><span class="line">1、添加新的修改到暂存区：git add README.md</span><br><span class="line"></span><br><span class="line">2、使用：git diff --cached #比较仓库最新的快照与暂存区文件</span><br><span class="line"></span><br><span class="line">![image-20211015160721317](git-learn-note/image-20211015160721317.png)</span><br><span class="line"></span><br><span class="line">3、 指定快照与暂存区进行对比：</span><br><span class="line"></span><br><span class="line">git diff --cached 快照ID</span><br><span class="line"></span><br><span class="line">![image-20211015160943289](git-learn-note/image-20211015160943289.png)</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## 终极对比命令(diff)图谱</span></span></span><br><span class="line"></span><br><span class="line">![image-20211015161032762](git-learn-note/image-20211015161032762.png)</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 修改最后一次提交，删除文件和重命名文件</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## 修改最后一次提交</span></span></span><br><span class="line"></span><br><span class="line">继续使用Myproject2</span><br><span class="line"></span><br><span class="line">- 在实际开发中你可能会遇到一下两种情景：</span><br><span class="line">  - 情景一：版本刚一提交(commit)到仓库，突然想起漏掉两个文件还没有添加(add)。</span><br><span class="line">  - 情景二：版本杠一提交(commit)到仓库，突然想起版本说明写的不够全面，无法彰显你本次修改的重大意义……</span><br><span class="line">- 执行带 --amend 选项的commit 提交命令，Git就会&#x27;更正&#x27;最近的一次提交。</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">### 案例</span></span></span><br><span class="line"></span><br><span class="line">- 前提条件</span><br><span class="line"></span><br><span class="line">![image-20211015162051247](git-learn-note/image-20211015162051247.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 要求：</span><br><span class="line"></span><br><span class="line">​	我们把README.md提交上去，但不希望再添加一个新的版本，</span><br><span class="line"></span><br><span class="line">- 方法</span><br><span class="line"></span><br><span class="line">  ```shell</span><br><span class="line">  git commit --amend</span><br><span class="line">  git commit --amend -m &quot;你的说明&quot;</span><br></pre></td></tr></table></figure>

<p>  进入下面的这个界面，其实就是让我们修改说明而已：</p>
<p>  <img src="/2021/10/14/git-learn-note/image-20211015162652159.png" alt="image-20211015162652159"></p>
<p>编辑修改操作跟linux里的vim一样。输入i 切换到插入模式，编辑说明，如果什么都不动，直接:q是进行退出，不会有修改。</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015163306814.png" alt="image-20211015163306814"></p>
<p><img src="/2021/10/14/git-learn-note/image-20211015163153892.png" alt="image-20211015163153892"></p>
<p><img src="/2021/10/14/git-learn-note/image-20211015163729373.png" alt="image-20211015163729373"></p>
<p>说明： –amend 命令可以进行提交，并修改注释，但不会增加新的版本。</p>
<h3 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h3><p>继续使用Myproject2,</p>
<p>1、从工作目录里==手动删除==README文件，</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015164228819.png" alt="image-20211015164228819"></p>
<p><img src="/2021/10/14/git-learn-note/image-20211015164250897.png" alt="image-20211015164250897"></p>
<p>使用 git restore README.md 可以从暂存区中恢复这个文件到工作目录。</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015164520678.png" alt="image-20211015164520678"></p>
<h4 id="如何从Git中删除文件？？"><a href="#如何从Git中删除文件？？" class="headerlink" title="如何从Git中删除文件？？"></a>如何从Git中删除文件？？</h4><p>git rm 文件名</p>
<ul>
<li><p>该命令删除的只是工作目录和暂存区的文件，也就是取消跟踪，在下次提交时不纳入版本管理。但是如果你之前提交过，那么在历时提交的快照版本里还会存在奥。</p>
</li>
<li><p>当工作目录和暂存区的同一个文件存在不同内容时，执行git rm -f 文件名 命令可以把两个文件都删除掉。</p>
<p>1、在工目录中添加一个ceshi.py的文件，并编辑。</p>
<p>2、将ceshi.py提交到暂存区，</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015165532297.png" alt="image-20211015165532297"></p>
<p>3、修改ceshi.py,使用git status 查看状态</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015165849101.png" alt="image-20211015165849101"></p>
<p>使用强制删除：$ git rm -f ceshi.py  git rm -f 命令，强制删除暂存区与工作目录中的文件</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015170005016.png" alt="image-20211015170005016"></p>
<p><img src="/2021/10/14/git-learn-note/image-20211015170112139.png" alt="image-20211015170112139"></p>
</li>
<li><p>只删除暂存区的文件保留工作目录中的 git rm –cached ceshi.py</p>
</li>
</ul>
<h3 id="重命名文件名"><a href="#重命名文件名" class="headerlink" title="重命名文件名"></a>重命名文件名</h3><p>1、将test.py 改为test_print.py</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015170912199.png" alt="image-20211015170912199"></p>
<p>2、手动将名字再改回来使用git status</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015171002109.png" alt="image-20211015171002109"></p>
<p><img src="/2021/10/14/git-learn-note/image-20211015171034861.png" alt="image-20211015171034861"></p>
<p>3、如果你想重命名文件，让git 来帮我们搞</p>
<p>git mv test.py test_print.py </p>
<p>使用git status 查看状态：提示进行了重命名操作。</p>
<p><img src="/2021/10/14/git-learn-note/image-20211015171317170.png" alt="image-20211015171317170"></p>
<p>git mv 旧文件名 新文件名</p>
<ul>
<li>ren/mv 进文件名 新文件名</li>
<li>git rm 旧文件</li>
<li>git add 新文件</li>
</ul>
<h2 id="Git-分支-1"><a href="#Git-分支-1" class="headerlink" title="Git 分支"></a>Git 分支</h2><h3 id="什么是分支？"><a href="#什么是分支？" class="headerlink" title="什么是分支？"></a>什么是分支？</h3><p><img src="/2021/10/14/git-learn-note/image-20211016041737568.png" alt="image-20211016041737568"></p>
<p>如果不使用分支，所有的工作都都放在一个分支上</p>
<h3 id="其他版本控制系统的分支："><a href="#其他版本控制系统的分支：" class="headerlink" title="其他版本控制系统的分支："></a>其他版本控制系统的分支：</h3><p>Git 每个版本独立存放，</p>
<h3 id="创建分支"><a href="#创建分支" class="headerlink" title="创建分支"></a>创建分支</h3><blockquote>
<p> 继续使用Myproject2项目</p>
</blockquote>
<p><img src="/2021/10/14/git-learn-note/image-20211016031347388.png" alt="image-20211016031347388"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">创建了一新分支</span></span><br><span class="line">git branch 分支名称 </span><br><span class="line"><span class="meta">#</span><span class="bash">创建新分支并切换到新创建的分支：</span></span><br><span class="line">git checkout -b 分支名</span><br><span class="line"></span><br><span class="line">git branch feature</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> --decorate</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2021/10/14/git-learn-note/image-20211016032036280.png" alt="image-20211016032036280"></p>
<h3 id="切换分支-git-checkout-分支名"><a href="#切换分支-git-checkout-分支名" class="headerlink" title="切换分支 git checkout 分支名"></a>切换分支 git checkout 分支名</h3><blockquote>
<p>继续使用Myproject2项目</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git checkout 分支名</span><br><span class="line">git checkout fearture</span><br><span class="line"></span><br><span class="line">git log --oneline #只显示快照的ID与快照的说明</span><br><span class="line">--oneline #只显示快照的ID与快照的说明</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2021/10/14/git-learn-note/image-20211016032621666.png" alt="image-20211016032621666"></p>
<p>将README 文件修改一下，再次提交</p>
<p><img src="/2021/10/14/git-learn-note/image-20211016033005885.png" alt="image-20211016033005885"></p>
<p>再次切回主分支：</p>
<p><img src="/2021/10/14/git-learn-note/image-20211016033432900.png" alt="image-20211016033432900"></p>
<p>再次修改EADME文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git add README.md</span></span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&quot;在主分支里修改了README 文件&quot;</span></span></span><br><span class="line">[master 4a04905] 在主分支里修改了README 文件</span><br><span class="line"> 1 file changed, 3 insertions(+), 1 deletion(-)</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="/2021/10/14/git-learn-note/image-20211016033841098.png" alt="image-20211016033841098"></p>
<p>查看所有分支：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">git log --decorate --oneline --graph --all</span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> --decorate --oneline --graph --all</span></span><br><span class="line">* 4a04905 (HEAD -&gt; master) 在主分支里修改了README 文件</span><br><span class="line">| * 7b0ec43 (feature) change the READMEfile</span><br><span class="line">|/</span><br><span class="line">* d0c10e9 重命名文件的名字# 两个分支的共同部分</span><br><span class="line">* a666828 修改README文件，测试使用 --amend 方法</span><br><span class="line">* 8ddfea5 hello world 打印</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2021/10/14/git-learn-note/image-20211016034156220.png" alt="image-20211016034156220"></p>
<h3 id="分支的合并"><a href="#分支的合并" class="headerlink" title="分支的合并"></a>分支的合并</h3><p>实际使用</p>
<p><img src="/2021/10/14/git-learn-note/image-20211016034404323.png" alt="image-20211016034404323"></p>
<blockquote>
<p>继续使用Myproject2项目</p>
</blockquote>
<h4 id="合并分支发生冲突："><a href="#合并分支发生冲突：" class="headerlink" title="合并分支发生冲突："></a>合并分支发生冲突：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 将指定的分支合并到当前的分支</span></span><br><span class="line">git merge 分支名  </span><br></pre></td></tr></table></figure>

<p><img src="/2021/10/14/git-learn-note/image-20211016035402470.png" alt="image-20211016035402470"></p>
<p><img src="/2021/10/14/git-learn-note/image-20211016035426268.png" alt="image-20211016035426268"></p>
<p>手动修改完成之后：</p>
<p><img src="/2021/10/14/git-learn-note/image-20211016035518818.png" alt="image-20211016035518818"></p>
<p>继续使用 git add README.md 将文件添加到暂存区</p>
<p>然后提交：git commit -m “ 说明”</p>
<p>查看分支：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master|MERGING)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git add README.md</span></span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master|MERGING)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&quot;手动合并了README 文件&quot;</span></span></span><br><span class="line">[master 626bc9d] 手动合并了README 文件</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash">  git <span class="built_in">log</span> --decorate --oneline --graph --all</span></span><br><span class="line">*   626bc9d (HEAD -&gt; master) 手动合并了README 文件</span><br><span class="line">|\</span><br><span class="line">| * 7b0ec43 (feature) change the READMEfile</span><br><span class="line">* | 4a04905 在主分支里修改了README 文件</span><br><span class="line">|/</span><br><span class="line">* d0c10e9 重命名文件的名字</span><br><span class="line">* a666828 修改README文件，测试使用 --amend 方法</span><br><span class="line">* 8ddfea5 hello world 打印</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="/2021/10/14/git-learn-note/image-20211016035903892.png" alt="image-20211016035903892"></p>
<h4 id="合并分支未发生冲突"><a href="#合并分支未发生冲突" class="headerlink" title="合并分支未发生冲突"></a>合并分支未发生冲突</h4><p>当合并的分支不会发生冲突时就不用这么麻烦啦：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">创建新分支并切换到新创建的分支：</span></span><br><span class="line">git checkout -b 分支名</span><br><span class="line"></span><br><span class="line">git checkout -b feature2</span><br><span class="line">git log --decorate --oneline --graph --all</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2021/10/14/git-learn-note/image-20211016040720350.png" alt="image-20211016040720350"></p>
<p><img src="/2021/10/14/git-learn-note/image-20211016041322437.png" alt="image-20211016041322437"></p>
<h3 id="删除分支"><a href="#删除分支" class="headerlink" title="删除分支"></a>删除分支</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d 分支名</span><br></pre></td></tr></table></figure>

<p>删除两个分支：feature feature2</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -d feature</span></span><br><span class="line">Deleted branch feature (was 7b0ec43).</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject2 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -d feature2</span></span><br><span class="line">Deleted branch feature2 (was 69d791a).</span><br></pre></td></tr></table></figure>



<p><img src="/2021/10/14/git-learn-note/image-20211016041650806.png" alt="image-20211016041650806"></p>
<h3 id="匿名分支"><a href="#匿名分支" class="headerlink" title="匿名分支"></a>匿名分支</h3><p>使用Myproject3项目</p>
<p>1、新建一个Myproject 文件夹</p>
<p>2、使用git init 初始化本地仓库</p>
<p>3、 新建三个文件、文件格式随意，文件类型随意每创建一个就提交一次。</p>
<p>4、</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git checkout HEAD~</span></span><br><span class="line">Note: switching to &#x27;HEAD~&#x27;.</span><br><span class="line"></span><br><span class="line">You are in &#x27;detached HEAD&#x27; state. You can look around, make experimental</span><br><span class="line">changes and commit them, and you can discard any commits you make in this</span><br><span class="line">state without impacting any branches by switching back to a branch.</span><br><span class="line"></span><br><span class="line">If you want to create a new branch to retain commits you create, you may</span><br><span class="line">do so (now or later) by using -c with the switch command. Example:</span><br><span class="line"></span><br><span class="line">  git switch -c &lt;new-branch-name&gt;</span><br><span class="line"></span><br><span class="line">Or undo this operation with:</span><br><span class="line"></span><br><span class="line">  git switch -</span><br><span class="line"></span><br><span class="line">Turn off this advice by setting config variable advice.detachedHead to false</span><br><span class="line"></span><br><span class="line">HEAD is now at 827bfee 2.txt</span><br><span class="line"><span class="meta">#</span><span class="bash">翻译成人话：</span></span><br><span class="line">你使用checkout 命令但是没有指定分支名，所以git会帮我们创建一个匿名分支的东西，什么是匿名分支？？？就是没有名字的分支，当你切换到别的分支的时候，你所做的所有操作提交修改都会丢弃，所以你可以使用匿名分支做一些实验。</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject3 ((827bfee...))</span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> --decorate --oneline --graph --all</span></span><br><span class="line">* dc8f887 (master) 3.txt</span><br><span class="line">* 827bfee (HEAD) 2.txt</span><br><span class="line">* a1c3b22 1.txt</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>目前的工作区：</p>
<p><img src="/2021/10/14/git-learn-note/image-20211016054312371.png" alt="image-20211016054312371"></p>
<p>创建一个4.txt 添加并提交：</p>
<p><img src="/2021/10/14/git-learn-note/image-20211016054528368.png" alt="image-20211016054528368"></p>
<p>Git 的log 匿名分支在前进</p>
<p><img src="/2021/10/14/git-learn-note/image-20211016054558558.png" alt="image-20211016054558558"></p>
<p>切换回主分支：</p>
<p>git checkout master</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject3 ((0a40346...))</span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout master</span></span><br><span class="line">Warning: you are leaving 1 commit behind, not connected to</span><br><span class="line">any of your branches:</span><br><span class="line"></span><br><span class="line">  0a40346 4.txt</span><br><span class="line"></span><br><span class="line">If you want to keep it by creating a new branch, this may be a good time</span><br><span class="line">to do so with:</span><br><span class="line"></span><br><span class="line"> git branch &lt;new-branch-name&gt; 0a40346</span><br><span class="line"></span><br><span class="line">Switched to branch &#x27;master&#x27;</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject3 (master)</span><br><span class="line"><span class="meta">$</span><span class="bash">git clog --decorate --oneline --graph --all</span></span><br><span class="line">* dc8f887 (HEAD -&gt; master) 3.txt</span><br><span class="line">* 827bfee 2.txt</span><br><span class="line">* a1c3b22 1.txt</span><br><span class="line"></span><br><span class="line">zsz@DESKTOP-IL5F40K MINGW64 /e/git_test/Myproject3 (master)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="checkout-功能"><a href="#checkout-功能" class="headerlink" title="checkout 功能"></a>checkout 功能</h3><p>待完善</p>
<ol>
<li>从历史快照或者暂存区中拷贝文件到工作目录     <ol>
<li>在回到过去里有讲</li>
</ol>
</li>
<li>切换分支</li>
</ol>
<p>reset与checkout 的区别：</p>
<p>reset 只能将文件恢复到暂存区，</p>
<p>checkout :可以将暂存区和工作目录覆盖掉</p>
<p>所以reset命令比checkout更安全一些。</p>
<p>重点：</p>
<p><img src="/2021/10/14/git-learn-note/image-20211016060148594.png" alt="image-20211016060148594"></p>
<p><img src="/2021/10/14/git-learn-note/image-20211016060343997.png" alt="image-20211016060343997"></p>
<h2 id="远程仓库"><a href="#远程仓库" class="headerlink" title="远程仓库"></a>远程仓库</h2><h1 id="Git-常用命令"><a href="#Git-常用命令" class="headerlink" title="Git 常用命令"></a>Git 常用命令</h1><h2 id="仓库"><a href="#仓库" class="headerlink" title="仓库"></a>仓库</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 在当前目录新建一个Git代码库</span><br><span class="line">$ git init</span><br><span class="line"></span><br><span class="line"># 新建一个目录，将其初始化为Git代码库</span><br><span class="line">$ git init [project-name]</span><br><span class="line"></span><br><span class="line"># 下载一个项目和它的整个代码历史</span><br><span class="line">$ git clone [url]</span><br></pre></td></tr></table></figure>

<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 显示当前的Git配置</span><br><span class="line">$ git config --list</span><br><span class="line"></span><br><span class="line"># 编辑Git配置文件</span><br><span class="line">$ git config -e [--global]</span><br><span class="line"></span><br><span class="line"># 设置提交代码时的用户信息</span><br><span class="line">$ git config [--global] user.name &quot;[name]&quot;</span><br><span class="line">$ git config [--global] user.email &quot;[email address]&quot;</span><br></pre></td></tr></table></figure>

<h2 id="增加-删除文件"><a href="#增加-删除文件" class="headerlink" title="增加/删除文件"></a>增加/删除文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 添加指定文件到暂存区</span><br><span class="line">$ git add [file1] [file2] ...</span><br><span class="line"></span><br><span class="line"># 添加指定目录到暂存区，包括子目录</span><br><span class="line">$ git add [dir]</span><br><span class="line"></span><br><span class="line"># 添加当前目录的所有文件到暂存区</span><br><span class="line">$ git add .</span><br><span class="line"></span><br><span class="line"># 添加每个变化前，都会要求确认</span><br><span class="line"># 对于同一个文件的多处变化，可以实现分次提交</span><br><span class="line">$ git add -p</span><br><span class="line"></span><br><span class="line"># 删除工作区文件，并且将这次删除放入暂存区</span><br><span class="line">$ git rm [file1] [file2] ...</span><br><span class="line"></span><br><span class="line"># 停止追踪指定文件，但该文件会保留在工作区</span><br><span class="line">$ git rm --cached [file]</span><br><span class="line"></span><br><span class="line"># 改名文件，并且将这个改名放入暂存区</span><br><span class="line">$ git mv [file-original] [file-renamed]</span><br></pre></td></tr></table></figure>

<h2 id="代码提交"><a href="#代码提交" class="headerlink" title="代码提交"></a>代码提交</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 提交暂存区到仓库区</span><br><span class="line">$ git commit -m [message]</span><br><span class="line"></span><br><span class="line"># 提交暂存区的指定文件到仓库区</span><br><span class="line">$ git commit [file1] [file2] ... -m [message]</span><br><span class="line"></span><br><span class="line"># 提交工作区自上次commit之后的变化，直接到仓库区</span><br><span class="line">$ git commit -a</span><br><span class="line"></span><br><span class="line"># 提交时显示所有diff信息</span><br><span class="line">$ git commit -v</span><br><span class="line"></span><br><span class="line"># 使用一次新的commit，替代上一次提交</span><br><span class="line"># 如果代码没有任何新变化，则用来改写上一次commit的提交信息</span><br><span class="line">$ git commit --amend -m [message]</span><br><span class="line"></span><br><span class="line"># 重做上一次commit，并包括指定文件的新变化</span><br><span class="line">$ git commit --amend [file1] [file2] ...</span><br></pre></td></tr></table></figure>

<h2 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"># 列出所有本地分支</span><br><span class="line">$ git branch</span><br><span class="line"></span><br><span class="line"># 列出所有远程分支</span><br><span class="line">$ git branch -r</span><br><span class="line"></span><br><span class="line"># 列出所有本地分支和远程分支</span><br><span class="line">$ git branch -a</span><br><span class="line"></span><br><span class="line"># 新建一个分支，但依然停留在当前分支</span><br><span class="line">$ git branch [branch-name]</span><br><span class="line"></span><br><span class="line"># 新建一个分支，并切换到该分支</span><br><span class="line">$ git checkout -b [branch]</span><br><span class="line"></span><br><span class="line"># 新建一个分支，指向指定commit</span><br><span class="line">$ git branch [branch] [commit]</span><br><span class="line"></span><br><span class="line"># 新建一个分支，与指定的远程分支建立追踪关系</span><br><span class="line">$ git branch --track [branch] [remote-branch]</span><br><span class="line"></span><br><span class="line"># 切换到指定分支，并更新工作区</span><br><span class="line">$ git checkout [branch-name]</span><br><span class="line"></span><br><span class="line"># 切换到上一个分支</span><br><span class="line">$ git checkout -</span><br><span class="line"></span><br><span class="line"># 建立追踪关系，在现有分支与指定的远程分支之间</span><br><span class="line">$ git branch --set-upstream [branch] [remote-branch]</span><br><span class="line"></span><br><span class="line"># 合并指定分支到当前分支</span><br><span class="line">$ git merge [branch]</span><br><span class="line"></span><br><span class="line"># 选择一个commit，合并进当前分支</span><br><span class="line">$ git cherry-pick [commit]</span><br><span class="line"></span><br><span class="line"># 删除分支</span><br><span class="line">$ git branch -d [branch-name]</span><br><span class="line"></span><br><span class="line"># 删除远程分支</span><br><span class="line">$ git push origin --delete [branch-name]</span><br><span class="line">$ git branch -dr [remote/branch]</span><br></pre></td></tr></table></figure>

<h2 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># 列出所有tag</span><br><span class="line">$ git tag</span><br><span class="line"></span><br><span class="line"># 新建一个tag在当前commit</span><br><span class="line">$ git tag [tag]</span><br><span class="line"></span><br><span class="line"># 新建一个tag在指定commit</span><br><span class="line">$ git tag [tag] [commit]</span><br><span class="line"></span><br><span class="line"># 删除本地tag</span><br><span class="line">$ git tag -d [tag]</span><br><span class="line"></span><br><span class="line"># 删除远程tag</span><br><span class="line">$ git push origin :refs/tags/[tagName]</span><br><span class="line"></span><br><span class="line"># 查看tag信息</span><br><span class="line">$ git show [tag]</span><br><span class="line"></span><br><span class="line"># 提交指定tag</span><br><span class="line">$ git push [remote] [tag]</span><br><span class="line"></span><br><span class="line"># 提交所有tag</span><br><span class="line">$ git push [remote] --tags</span><br><span class="line"></span><br><span class="line"># 新建一个分支，指向某个tag</span><br><span class="line">$ git checkout -b [branch] [tag]</span><br></pre></td></tr></table></figure>

<h2 id="查看信息"><a href="#查看信息" class="headerlink" title="查看信息"></a>查看信息</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"># 显示有变更的文件</span><br><span class="line">$ git status</span><br><span class="line"></span><br><span class="line"># 显示当前分支的版本历史</span><br><span class="line">$ git log</span><br><span class="line"></span><br><span class="line"># 显示commit历史，以及每次commit发生变更的文件</span><br><span class="line">$ git log --stat</span><br><span class="line"></span><br><span class="line"># 搜索提交历史，根据关键词</span><br><span class="line">$ git log -S [keyword]</span><br><span class="line"></span><br><span class="line"># 显示某个commit之后的所有变动，每个commit占据一行</span><br><span class="line">$ git log [tag] HEAD --pretty=format:%s</span><br><span class="line"></span><br><span class="line"># 显示某个commit之后的所有变动，其&quot;提交说明&quot;必须符合搜索条件</span><br><span class="line">$ git log [tag] HEAD --grep feature</span><br><span class="line"></span><br><span class="line"># 显示某个文件的版本历史，包括文件改名</span><br><span class="line">$ git log --follow [file]</span><br><span class="line">$ git whatchanged [file]</span><br><span class="line"></span><br><span class="line"># 显示指定文件相关的每一次diff</span><br><span class="line">$ git log -p [file]</span><br><span class="line"></span><br><span class="line"># 显示过去5次提交</span><br><span class="line">$ git log -5 --pretty --oneline</span><br><span class="line"></span><br><span class="line"># 显示所有提交过的用户，按提交次数排序</span><br><span class="line">$ git shortlog -sn</span><br><span class="line"></span><br><span class="line"># 显示指定文件是什么人在什么时间修改过</span><br><span class="line">$ git blame [file]</span><br><span class="line"></span><br><span class="line"># 显示暂存区和工作区的差异</span><br><span class="line">$ git diff</span><br><span class="line"></span><br><span class="line"># 显示暂存区和上一个commit的差异</span><br><span class="line">$ git diff --cached [file]</span><br><span class="line"></span><br><span class="line"># 显示工作区与当前分支最新commit之间的差异</span><br><span class="line">$ git diff HEAD</span><br><span class="line"></span><br><span class="line"># 显示两次提交之间的差异</span><br><span class="line">$ git diff [first-branch]...[second-branch]</span><br><span class="line"></span><br><span class="line"># 显示今天你写了多少行代码</span><br><span class="line">$ git diff --shortstat &quot;@&#123;0 day ago&#125;&quot;</span><br><span class="line"></span><br><span class="line"># 显示某次提交的元数据和内容变化</span><br><span class="line">$ git show [commit]</span><br><span class="line"></span><br><span class="line"># 显示某次提交发生变化的文件</span><br><span class="line">$ git show --name-only [commit]</span><br><span class="line"></span><br><span class="line"># 显示某次提交时，某个文件的内容</span><br><span class="line">$ git show [commit]:[filename]</span><br><span class="line"></span><br><span class="line"># 显示当前分支的最近几次提交</span><br><span class="line">$ git reflog</span><br></pre></td></tr></table></figure>

<h2 id="远程同步"><a href="#远程同步" class="headerlink" title="远程同步"></a>远程同步</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 下载远程仓库的所有变动</span><br><span class="line">$ git fetch [remote]</span><br><span class="line"></span><br><span class="line"># 显示所有远程仓库</span><br><span class="line">$ git remote -v</span><br><span class="line"></span><br><span class="line"># 显示某个远程仓库的信息</span><br><span class="line">$ git remote show [remote]</span><br><span class="line"></span><br><span class="line"># 增加一个新的远程仓库，并命名</span><br><span class="line">$ git remote add [shortname] [url]</span><br><span class="line"></span><br><span class="line"># 取回远程仓库的变化，并与本地分支合并</span><br><span class="line">$ git pull [remote] [branch]</span><br><span class="line"></span><br><span class="line"># 上传本地指定分支到远程仓库</span><br><span class="line">$ git push [remote] [branch]</span><br><span class="line"></span><br><span class="line"># 强行推送当前分支到远程仓库，即使有冲突</span><br><span class="line">$ git push [remote] --force</span><br><span class="line"></span><br><span class="line"># 推送所有分支到远程仓库</span><br><span class="line">$ git push [remote] --all</span><br></pre></td></tr></table></figure>

<h2 id="撤销"><a href="#撤销" class="headerlink" title="撤销"></a>撤销</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># 恢复暂存区的指定文件到工作区</span><br><span class="line">$ git checkout [file]</span><br><span class="line"></span><br><span class="line"># 恢复某个commit的指定文件到暂存区和工作区</span><br><span class="line">$ git checkout [commit] [file]</span><br><span class="line"></span><br><span class="line"># 恢复暂存区的所有文件到工作区</span><br><span class="line">$ git checkout .</span><br><span class="line"></span><br><span class="line"># 重置暂存区的指定文件，与上一次commit保持一致，但工作区不变</span><br><span class="line">$ git reset [file]</span><br><span class="line"></span><br><span class="line"># 重置暂存区与工作区，与上一次commit保持一致</span><br><span class="line">$ git reset --hard</span><br><span class="line"></span><br><span class="line"># 重置当前分支的指针为指定commit，同时重置暂存区，但工作区不变</span><br><span class="line">$ git reset [commit]</span><br><span class="line"></span><br><span class="line"># 重置当前分支的HEAD为指定commit，同时重置暂存区和工作区，与指定commit一致</span><br><span class="line">$ git reset --hard [commit]</span><br><span class="line"></span><br><span class="line"># 重置当前HEAD为指定commit，但保持暂存区和工作区不变</span><br><span class="line">$ git reset --keep [commit]</span><br><span class="line"></span><br><span class="line"># 新建一个commit，用来撤销指定commit</span><br><span class="line"># 后者的所有变化都将被前者抵消，并且应用到当前分支</span><br><span class="line">$ git revert [commit]</span><br><span class="line"></span><br><span class="line">暂时将未提交的变化移除，稍后再移入</span><br><span class="line">$ git stash</span><br><span class="line">$ git stash pop</span><br></pre></td></tr></table></figure>

<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h2 id><a href="#" class="headerlink" title></a></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 生成一个可供发布的压缩包</span><br><span class="line">$ git archive</span><br></pre></td></tr></table></figure>



<p>关于git clone 只有master分支的问题：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">克隆指定的分支 到指定文件夹</span></span><br><span class="line">git clone -b dev git@github.com:Taurus-ZSZ/Taurus-ZSZ.github.io.git /e/200-Learning/240_myblog/123</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/07/learn-LiteX/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zsz">
      <meta itemprop="description" content="不负光阴韶华">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/07/learn-LiteX/" class="post-title-link" itemprop="url">认识 LiteX</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-10-07 05:01:01" itemprop="dateCreated datePublished" datetime="2021-10-07T05:01:01+08:00">2021-10-07</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-04-11 23:30:45" itemprop="dateModified" datetime="2022-04-11T23:30:45+08:00">2022-04-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/FPGA/" itemprop="url" rel="index"><span itemprop="name">FPGA</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>目录</p>
</blockquote>
<p>[TOC]</p>
<h1 id="认识-LiteX"><a href="#认识-LiteX" class="headerlink" title="认识 LiteX"></a>认识 LiteX</h1><p>LiteX <a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litex">GitHub项目地址</a></p>
<p>LiteX <a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litex/wiki">Wiki文档</a></p>
<p>LiteX <a target="_blank" rel="noopener" href="https://github.com/litex-hub">Community</a></p>
<p>LiteX 框架为创建 FPGA 内核/SoC、探索各种数字设计架构和创建完整的基于 FPGA 的系统提供了一个方便高效的基础设施。</p>
<p>LiteX 提供了轻松创建 FPGA 内核/SoC 所需的所有通用组件：</p>
<ul>
<li>✔️ Buses and Streams (Wishbone, AXI, Avalon-ST) and their  interconnect.</li>
<li>✔️ Simple cores: RAM, ROM, Timer, UART, JTAG, etc….</li>
<li>✔️ Complex cores through the ecosystem of cores: <a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litedram">LiteDRAM</a>, <a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litepcie">LitePCIe</a>, <a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/liteeth">LiteEth</a>, <a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litesata">LiteSATA</a>, etc…</li>
<li>✔️ Various CPUs &amp; ISAs: RISC-V, OpenRISC, LM32, Zynq, X86 (through a PCIe), etc…</li>
<li>✔️ Mixed languages support with VHDL/Verilog/(n)Migen/Spinal-HDL/etc… integration capabilities.</li>
<li>✔️ Powerful debug infractrusture through the various <a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litex/wiki/Use-Host-Bridge-to-control-debug-a-SoC">bridges</a> and <a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litescope">Litescope</a>.</li>
<li>✔️ Direct/Fast simulation through <a target="_blank" rel="noopener" href="https://www.veripool.org/verilator/">Verilator</a>.</li>
<li>✔️ Build backends for open-source and vendors toolchains.</li>
<li>✔️ And a lot more… :)</li>
</ul>
<p>通过将 LiteX 与内核生态系统相结合，创建复杂的 SoC 变得比使用传统方法容易得多，同时提供更好的可移植性和灵活性：例如，基于  VexRiscv-SMP CPU、LiteDRAM、LiteSATA 构建的多核 Linux Capable SoC 和与 LiteX  集成，在廉价的 Acorn CLE215+ 挖矿板上运行：</p>
<h2 id="安装-LiteX-环境"><a href="#安装-LiteX-环境" class="headerlink" title="安装 LiteX 环境"></a>安装 LiteX 环境</h2><h3 id="ubuntu-安装-Litex"><a href="#ubuntu-安装-Litex" class="headerlink" title="ubuntu 安装 Litex"></a>ubuntu 安装 Litex</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">安装环境：Python3.6+</span></span><br><span class="line"><span class="meta">#</span><span class="bash">安装 python3-setuptools</span></span><br><span class="line">apt-get install python3-setuptools</span><br><span class="line"><span class="meta">#</span><span class="bash">安装python  pip</span></span><br><span class="line"><span class="meta">  #</span><span class="bash"><span class="comment">#使用脚本安装pip</span></span></span><br><span class="line">      ### 下载get-pip.py 脚本</span><br><span class="line">      wget  https://bootstrap.pypa.io/get-pip.py</span><br><span class="line">      ### 改变执行权限</span><br><span class="line">      chmod +x ./get-pip.py</span><br><span class="line">      ### 运行安装pip</span><br><span class="line">      python get-pip.py</span><br><span class="line"><span class="meta">  #</span><span class="bash"><span class="comment"># 使用包管理器安装</span></span></span><br><span class="line">     apt-get install python3-pip</span><br><span class="line"><span class="meta">#</span><span class="bash">安装LiteX</span> </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">1、Install Python 3.6+ and FPGA vendor<span class="string">&#x27;s development tools and/or Verilator.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string">2、Install Migen/LiteX and the LiteX&#x27;</span>s cores:</span></span><br><span class="line"></span><br><span class="line">https://raw.githubusercontent.com/enjoy-digital/litex/master/litex_setup.py</span><br><span class="line">chmod +x litex_setup.py</span><br><span class="line">./litex_setup.py init install --user (--user to install to user directory)</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#Later, if you need to update all repositories:</span></span></span><br><span class="line">./litex_setup.py update</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">3、Install a RISC-V toolchain (Only <span class="keyword">if</span> you want to <span class="built_in">test</span>/create a SoC with a CPU):</span></span><br><span class="line">pip3 install meson</span><br><span class="line">./litex_setup.py gcc</span><br><span class="line"></span><br><span class="line">添加环境变量：</span><br><span class="line">vim  ~/.bashrc</span><br><span class="line">将下面的这一行加到最后</span><br><span class="line">export PATH=$PATH:/opt/python_fpga_tools/riscv64-unknown-elf-gcc-8.3.0-2019.08.0-x86_64-linux-ubuntu14/bin</span><br><span class="line"></span><br><span class="line">如果出现下面的这个错误</span><br><span class="line">Could not detect Ninja v1.8.2 or newer</span><br><span class="line">安装 ninja</span><br><span class="line">pip3 install ninja</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">4、Build the target of your board...:</span></span><br><span class="line"></span><br><span class="line">	Go to litex-boards/litex_boards/targets and execute the target you want to build.</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">5、    ... and/or install Verilator and <span class="built_in">test</span> LiteX directly on your computer without any FPGA board:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#On Linux (Ubuntu):</span></span></span><br><span class="line">sudo apt install libevent-dev libjson-c-dev verilator</span><br><span class="line">lxsim --cpu-type=vexriscv</span><br></pre></td></tr></table></figure>

<h3 id="Archlinux-安装-Litex"><a href="#Archlinux-安装-Litex" class="headerlink" title="Archlinux 安装 Litex"></a>Archlinux 安装 Litex</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">安装环境：Python3.6+</span></span><br><span class="line"><span class="meta">#</span><span class="bash">安装 python3-setuptools</span></span><br><span class="line">pacman -S python-setuptools</span><br><span class="line"><span class="meta">#</span><span class="bash">这条命令安装后，执行./litex_setup.py init install --user 时出错。 又试了一遍又可以了！！！！</span></span><br><span class="line"><span class="meta">#</span><span class="bash">也可以通过安装pip使用pip install setuptools 后成功安装。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">安装python  pip</span></span><br><span class="line"><span class="meta">  #</span><span class="bash"><span class="comment">#使用脚本安装pip</span></span></span><br><span class="line">      ### 下载get-pip.py 脚本</span><br><span class="line">      wget  https://bootstrap.pypa.io/get-pip.py</span><br><span class="line">      ### 改变执行权限</span><br><span class="line">      chmod +x ./get-pip.py</span><br><span class="line">      ### 运行安装pip</span><br><span class="line">      python get-pip.py</span><br><span class="line"><span class="meta">  #</span><span class="bash"><span class="comment"># 使用包管理器安装</span></span></span><br><span class="line">  pacman -S python-pip</span><br><span class="line"><span class="meta">#</span><span class="bash">安装LiteX</span> </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">1、Install Python 3.6+ and FPGA vendor<span class="string">&#x27;s development tools and/or Verilator.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string">2、Install Migen/LiteX and the LiteX&#x27;</span>s cores:</span></span><br><span class="line"></span><br><span class="line">https://raw.githubusercontent.com/enjoy-digital/litex/master/litex_setup.py</span><br><span class="line">chmod +x litex_setup.py</span><br><span class="line">./litex_setup.py init install --user (--user to install to user directory)</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#Later, if you need to update all repositories:</span></span></span><br><span class="line">./litex_setup.py update</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">4、Build the target of your board...:</span></span><br><span class="line"></span><br><span class="line">	Go to litex-boards/litex_boards/targets and execute the target you want to build.</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">3、Install a RISC-V toolchain (Only <span class="keyword">if</span> you want to <span class="built_in">test</span>/create a SoC with a CPU):</span></span><br><span class="line">pip3 install meson</span><br><span class="line">./litex_setup.py gcc</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">5、    ... and/or install Verilator and <span class="built_in">test</span> LiteX directly on your computer without any FPGA board:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#On Linux (Ubuntu):</span></span></span><br><span class="line">sudo apt install libevent-dev libjson-c-dev verilator</span><br><span class="line">lxsim --cpu-type=vexriscv</span><br></pre></td></tr></table></figure>

<p>未完待续~~</p>
<h2 id="教程资源"><a href="#教程资源" class="headerlink" title="教程资源"></a>教程资源</h2><p>资源链接：<a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litex/wiki/Tutorials-Resources">https://github.com/enjoy-digital/litex/wiki/Tutorials-Resources</a></p>
<h3 id="LiteX教程"><a href="#LiteX教程" class="headerlink" title="LiteX教程"></a>LiteX教程</h3><h4 id="FPGA-101"><a href="#FPGA-101" class="headerlink" title="FPGA 101"></a><a target="_blank" rel="noopener" href="https://github.com/litex-hub/fpga_101">FPGA 101</a></h4><p>为学生提供的课程/实验室通过动手方法发现 FPGA 并学习 Migen/LiteX。这些教程通过常见的 SoC 内核涵盖了 Migen  的基础知识（语法/模拟）：时钟生成、7 段显示等……然后通过在 SoC 中集成这些内核来介绍 LiteX  的基础知识。它演示并解释了如何从主机 PC 通过桥接器 (UART) 控制这些内核，然后直接从 FPGA 中实现的 RISC-V 软 CPU  控制这些内核。  这些教程应帮助用户了解 Migen/LiteX 的可能性，并提供创建自己的 Migen 内核/LiteX SoC 的基础知识。      </p>
<p>注意：这些实验室基于 Nexys4DDR（现命名为 NexysA7），但可以轻松适应其他板。由于编写了这些教程，新的较便宜的开源  FPGA 板也与开源 FPGA 工具链兼容，广泛可用。这些教程可能会在未来进行调整以支持此类板。</p>
<p>Xilinx Vivado</p>
<p>吐槽vivado之LiteX vs. Vivado: First Impressions :<a target="_blank" rel="noopener" href="https://www.bunniestudios.com/blog/?p=5018">https://www.bunniestudios.com/blog/?p=5018</a></p>
<p>Vivado 之所以强大，是因为我不必在 Verilog 中编写复杂的 SoC，而是可以使用他们的伪 GUI/TCL  接口来创建框图，从而在很大程度上自动化构建 AXI 路由结构的任务。此外，我可以访问 Xilinx 广泛的 IP 库，其中包括一个非常灵活的  DDR 内存控制器和一个经过严格审查的 PCI-express 控制器。由于这种设计自动化水平和可用 IP，仅使用 Verilog  可能需要数月才能完成的任务在 Vivado 的帮助下可以在几天内完成。</p>
<p>Vivado 的缺点是它不是开源的（可以免费下载，但不能免费修改），而且它的效率和速度不是特别好。除了对 Vivado  的封闭源代码性质的意识形态上的反对之外，缺乏源代码访问还有一些实际的、务实的影响。在高层次上，赛灵思通过销售  FPGA——硅芯片来赚钱。然而，为了吸引设计成功，他们必须提供设计工具和 IP 生态系统。该软件的开发由芯片的销售直接补贴。</p>
<p>当涉及到工具的效率时，这会产生有趣的利益冲突——也就是说，它们在优化设计以消耗尽可能少的硅方面有多好。花钱创建面积高效的工具会减少收入，因为这会鼓励客户购买更便宜的芯片。</p>
<p>因此，Vivado 工具在优化面积设计方面非常糟糕。例如，即使您不使用该接口，PCI express  内核（虽然可配置性极强且经过严格审查）也无法关闭 AXI  从桥。即使输入未连接或接地，逻辑优化器也不会删除未使用的门。不幸的是，这块死逻辑消耗了我的目标 FPGA 容量的 20%  左右。我只能通过手动编辑机器生成的 VHDL  来注释掉从桥来回收该空间。这是一件足够简单的事情，并且对内核的功能没有负面影响。但赛灵思没有动力添加 GUI  开关来禁用逻辑，因为如果您的设计使用 PCI express 内核，额外的门会鼓励您“升级”一个 FPGA 尺寸。同样，DDR3 内存核心将其  70% 的大量占用空间用于“校准”块。校准通常只在启动时运行一次，因此逻辑在正常操作期间处于空闲状态。使用 FPGA  时，明智的做法是运行校准、存储值，然后将预先测量的值塞入应用程序设计中，从而消除校准块的开销。但是，我无法实现此优化，因为 DDR3  块是作为不透明网表提供的。最后，AXI 结构自动化（虽然很神奇）在端口数量上的扩展性很差。在我最近使用 Vivado 完成的基准设计中，50%  的芯片用于路由结构，25% 用于 DDR3 块，其余用于我的实际应用逻辑。</p>
<p>Tim 提到他认为在使用 LiteX 时相同的设计将适合更小的 FPGA。他一直在使用 LiteX 生成  FPGA“门件”（比特流）以支持他在各种平台上的 HDMI2USB 视频处理管道，从 Numato-Opsis 到 Atlys，他甚至为  NeTV2 启动了一个端口。出于好奇，我决定将我的 Vivado 设计之一移植到 LiteX，以便我可以对两种设计流程进行逐个比较。</p>
<p>LiteX 是 Migen/MiSoC 的软分叉——一个基于 Python 的框架，用于管理硬件 IP 和自动生成 HDL。 LiteX 中的  IP 模块是完全开源的，因此可以针对多个 FPGA  架构。然而，对于低级综合、布局布线和比特流生成，它仍然依赖于专有的芯片特定供应商工具，例如面向 Artix FPGA 时的  Vivado。它有点像一个吐出汇编的开源 C 编译器，因此它仍然需要特定于供应商的汇编器、链接器和  binutils。虽然在汇编程序之前打开编译器似乎有些落后，但请记住，对于软件而言，汇编程序的工作范围很简单——主要是在定义良好的 32  位左右的操作码中。然而，对于 FPGA  而言，“汇编器”（布局布线工具）的任务是确定在实际上有几百万位长的“操作码”中放置一位原语的位置，每一位之间都有潜在的交叉依赖性。抽象层虽然是并行的，但不能直接比较。</p>
<p>让我用我与 Python 爱恨交加的声明来开始我的体验。我曾多次将 Python 用于“娱乐”项目和小工具，以及驱动一些自动化框架。但我发现  Python  非常令人沮丧。如果您可以从头开始使用他们的框架，那将是直观、有趣，甚至是强大的。但是如果你的应用程序天生就不是“Pythonic”，那你就惨了。而且我有很多需要进行位碰撞、操作二进制文件或处理低级硬件寄存器，这些活动绝对不是 Pythonic。我也花了很多时间与 Python 类型系统和语法的“可爱”作斗争：我更像是一个 Rust  人。我喜欢严格类型的语言。我不喜欢使用“-1”作为最后一个元素数组索引和使用魔术方法重载二元运算符之类的新奇事物。</p>
<p>令人惊讶的是，我能够在一天内启动并运行 LiteX。这在很大程度上要归功于 Tim 努力创建一个真正全面的引导脚本，该脚本检查 git  存储库、所有子模块（谢谢！），并管理您的构建环境。它刚刚奏效；我遇到的唯一问题是关于安装 Xilinx 工具链的一些不一致的文档（对于  Artix 构建，您需要获取 Vivado；而 Spartan 则需要获取 ISE）。整个过程占用了大约 19GiB 的硬盘空间，其中  18GiB 是 Vivado 工具链。</p>
<p>我得到了一个用于定义 SoC 的令人惊讶的强大和成熟的框架。由于 MiSoC 和 LiteX 人群的大量工作，已经有用于 DRAM、PCI  express、以太网、视频、软核 CPU（您选择 or1k 或 lm32）等的 IP  核。公平地说，我无法将它们加载到真实硬件上并验证它们的规范合规性或功能，但它们似乎可以编译为正确的原语，因此它们具有正确的形状和大小。他们没有使用 AXI，而是将 Wishbone 用于面料。我还不清楚 MiSoC 结构生成器的带宽效率如何，但它已经用于将 4x HDMI 连接路由到  Numato-Opsis 上的 DRAM 的事实表明它为我的应用程序提供了足够的马力（这只需要3 个 HDMI 连接）。</p>
<p>作为一个高级框架，它非常神奇。大型 IP 实例和相应的总线端口是按需分配的，基于 Python  中非常高级的描述。我感觉有点像一个蹒跚学步的孩子，他在安全关闭的情况下收到了一把上膛的枪。我祈祷底层正在做出理智的推论。但是，至少在 LiteX 的情况下，如果我不同意这些决定，它已经足够开源，我可以尝试修复问题，假设我有时间和勇气这样做。</p>
<p>对于我的工具流程比较，我在 Vivado 和 LiteX 中实现了一个简单的 2x HDMI-in 到 DDR3 到 1x HDMI-out  设计。创建设计在两个流程上的工作量大致相同——一旦您拥有基本的 IP  块，在每种情况下，实例化总线结构和寻址分配在很大程度上都是自动化的。由于其图形规划工具，Vivado  在引脚/封装布局方面更胜一筹（我发现封装布局的图示比球栅坐标的文本列表直观得多），而 LiteX 的设计创建速度要快一些，尽管我对 Python 的常见挫折（取决于读者的偏见，决定是我有不同的看待事物的方式，还是我的智力不足以完全理解 Python 的优点）。</p>
<p>但从那里开始，两者之间的经验迅速分歧。让我对 LiteX 感到兴奋的主要事情是其高级综合的速度和效率。<strong>LiteX 产生的设计使用了大约 20% 的 XC7A50 FPGA，运行时间约为 10 分钟，而 Vivado 产生的设计消耗了相同 FPGA 的 85%，运行时间约为 30-45  分钟。</strong></p>
<p>值得注意的是，LiteX 倾向于“快速失败”，因此语法错误或配置的小问题在几秒钟内（如果不是几分钟）就会变得明显。然而，Vivado  往往会“迟到失败”——一个小的配置问题可能要到运行大约 20  分钟后才会出现，因为它管理脱离上下文的块综合和构建依赖项的方式很笨拙。这意味着，尽管我对 Python  语法感到沮丧，但在时间方面为小错误付出的代价要少得多——所以总的来说，我的工作效率更高。</p>
<p>但真正引人注目的是效率。 LiteX 生成更高效的 HDL 的事实意味着我可以通过使用更小的 FPGA  来从设计中节省大量成本。请记住，LiteX 和 Vivado  都使用相同的后端进行低级综合以及布局和布线。不同之处完全在于高级设计自动化——我认为这是一个非常适合基于 Python  的框架的级别。你并不是真正用 Python 设计硬件（最终它都变成了 Verilog），而是管理和配置 IP 库，这是 Python  非常适合的东西。也就是说，我在 MiSoC 库中挖掘了一些，似乎有一些使用这种 Python  语法的严肃逻辑设计。我不确定我是否想围绕这种编码风格，但好消息是我仍然可以在 Verilog 中编写叶单元并从高级 Python  集成框架中调用它们。</p>
<p>因此，我谨慎地继续使用 LiteX 作为 NeTV2  未来的主要设计流程。一旦我的下一代硬件可用，我们将看到比特流如何在时序和功能方面得到证明，但我很乐观。我对调试的工作方式有一些担忧——我发现  Xilinx ILA 内核是非常强大的工具，并且能够自动将任何复杂设计逆向工程到原理图（Vivado  中内置的一项功能）有助于查找时序和逻辑错误。但是有了内置的软 CPU 内核、“LiteScope”逻辑分析器（即将支持  sigrok）和快速的构建时间，我觉得有足够的机会在 LiteX 中开发新的、甚至更强大的方法来跟踪解决棘手的错误。</p>
<p>我的最后一个想法是  LiteX，在目前的状态下，可能最适合那些受过编写软件培训并想要设计硬件的人，而不是那些受过经典电路设计培训但想要工具升级的人。 LiteX  中内置的设计习惯用法和直觉强烈地借鉴了软件设计师的实践，这意味着许多“显而易见”的事情没有记录在案，这会让局外人（例如像我这样的硬件设计师）陷入困境。毫无疑问，设计流程的功能和实用性——因此，随着工具链的成熟和文档的改进，我乐观地认为这可能成为各种规模硬件项目的流行设计流程。</p>
<p>Interested? Tim has suggested the following links for further reading:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/timvideos/HDMI2USB-litex-firmware/blob/master/getting-started.md">Getting started</a> with LiteX</li>
<li>Tim ‘mithro’ Ansell’s <a target="_blank" rel="noopener" href="http://j.mp/pyhw-pycon2017">talk at Linux.conf.au 2017 about why he finds LiteX / MiSoC so powerful</a>.</li>
<li><a target="_blank" rel="noopener" href="https://m-labs.hk/migen/manual/">Migen Manual</a></li>
<li>Tim ‘mithro’ Ansell (and friends) are running <a target="_blank" rel="noopener" href="https://linux.conf.au/programme/miniconfs/fpga/">a day long tutorial on using LiteX and Linux together at Linux.conf.au 2018</a> – If you are in Australia, I recommend checking it out. I’ll be speaking at the full conference too!</li>
<li><a target="_blank" rel="noopener" href="https://www.wdj-consulting.com/blog/migen-port.html">Cr1901’s tutorial for adding a new FPGA board to Migen</a></li>
<li><a target="_blank" rel="noopener" href="http://m-labs.hk/gateware.html">M-Lab’s the creators of Migen + MiSoC</a> &amp; <a target="_blank" rel="noopener" href="http://enjoy-digital.fr/cores.html">Enjoy Digital, creators of LiteX and the other Lite cores</a></li>
<li><a target="_blank" rel="noopener" href="https://lab.whitequark.org/notes/2016-10-19/implementing-a-simple-soc-in-migen/">Implementing a simple SoC using Migen and Project IceStorm (the fully open source FPGA toolchain for the Ice40)</a></li>
</ul>
<p>Tags: <a target="_blank" rel="noopener" href="https://www.bunniestudios.com/blog/?tag=fpga">fpga</a>, <a target="_blank" rel="noopener" href="https://www.bunniestudios.com/blog/?tag=netv2">netv2</a>, <a target="_blank" rel="noopener" href="https://www.bunniestudios.com/blog/?tag=open-source">open source</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/mithro/HDMI2USB-litex-firmware/">HDMI2USB video processing pipelines</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.mithis.net/">https://blog.mithis.net/</a></p>
<p> <a target="_blank" rel="noopener" href="https://github.com/mithro/HDMI2USB-litex-firmware/blob/master/scripts/bootstrap.sh">really comprehensive bootstrapping script</a></p>
<h2 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h2><p><a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litex">liteX</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/litex-hub">litex-hub</a>    </p>
<p><a target="_blank" rel="noopener" href="https://github.com/litex-hub/fpga_101">litex-lesson</a>    </p>
<p><a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litex/wiki">litex Wiki</a></p>
<p><a target="_blank" rel="noopener" href="https://osda.gitlab.io/">https://osda.gitlab.io/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/06/hexo-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zsz">
      <meta itemprop="description" content="不负光阴韶华">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/06/hexo-notes/" class="post-title-link" itemprop="url">Hexo 博客学习笔记</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-10-06 07:31:12" itemprop="dateCreated datePublished" datetime="2021-10-06T07:31:12+08:00">2021-10-06</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-04-11 23:46:16" itemprop="dateModified" datetime="2022-04-11T23:46:16+08:00">2022-04-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/blog/" itemprop="url" rel="index"><span itemprop="name">blog</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Hexo-博客学习笔记"><a href="#Hexo-博客学习笔记" class="headerlink" title="Hexo 博客学习笔记"></a>Hexo 博客学习笔记</h1><h2 id="诡异的部分图片不显示"><a href="#诡异的部分图片不显示" class="headerlink" title="诡异的部分图片不显示"></a>诡异的部分图片不显示</h2><p>在写的博客中添加了图片并在hexo中添加了一个图片路径转换的插件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install https://github.com/CodeFalling/hexo-asset-image --save</span><br></pre></td></tr></table></figure>

<p>但是在我的markdown写的blog中设置了图片缩放的图片可以正常显示，但是含有中文路径的图片在typroa中不缩放设置在本地浏览中图片不会显示。</p>
<blockquote>
<p>解决方法：</p>
</blockquote>
<p>将*.md文件重命名，将存放图片的相对文件夹重命名 全都重命名成英文的，但是在.md中设置title时可以设置成中文的名字。在重新生成一下就可以了！！！！！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo genertae</span><br><span class="line">hexo server</span><br><span class="line">hexo deploy # 可以简写 hexo d</span><br></pre></td></tr></table></figure>



<h2 id="更换电脑后如何重新部署hexo"><a href="#更换电脑后如何重新部署hexo" class="headerlink" title="更换电脑后如何重新部署hexo"></a>更换电脑后如何重新部署hexo</h2><p>1、安装nodejs</p>
<p>2、 npm install hexo</p>
<p>3、创建文件夹然后运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>4、拉取远程dev分支</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone -b dev git@github.com:Taurus-ZSZ/Taurus-ZSZ.github.io.git /e/200-Learning/240_myblog/123</span><br></pre></td></tr></table></figure>

<p> 5、复制123文件下的所有到Taurus-ZSZ.github.io文件夹下，覆盖掉hexo init 生成的文件</p>
<p>就可以了</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/06/migen-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zsz">
      <meta itemprop="description" content="不负光阴韶华">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/06/migen-notes/" class="post-title-link" itemprop="url">migen-notes</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-10-06 01:40:18" itemprop="dateCreated datePublished" datetime="2021-10-06T01:40:18+08:00">2021-10-06</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-04-11 23:30:45" itemprop="dateModified" datetime="2022-04-11T23:30:45+08:00">2022-04-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/FPGA/" itemprop="url" rel="index"><span itemprop="name">FPGA</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>目录</p>
</blockquote>
<p>[TOC]</p>
<h1 id="Migen-学习笔记"><a href="#Migen-学习笔记" class="headerlink" title="Migen 学习笔记"></a>Migen 学习笔记</h1><blockquote>
<p>Migen是什么？？？</p>
</blockquote>
<p>Migen 是一种基于 Python 的工具，可进一步自动化 VLSI 设计过程。</p>
<p>Migen 是 MiSoC 的基础。</p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>&ensp;&ensp;Migen是一个基于Python的工具，目的是实现自动化VLSI设计过程。</p>
<p><strong>VLSI: 超大规模集成电路</strong>（英语：very-large-scale integration，<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%B8%AE%E5%AF%AB">缩写</a>：VLSI</p>
<p>Migen使面向对象和元编程设计硬件的现代编程模式成为可能！这个结果使设计更加简单与优雅，并且可以减少人为错误的发生。</p>
<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>虽然Milkymist 片上系统有 <a target="_blank" rel="noopener" href="http://m-labs.hk/">mm</a>取得了许多成功，但由于在手动编写的 Verilog HDL 中的实现，它仍存在一些限制：</p>
<p>……</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>github 地址：<a target="_blank" rel="noopener" href="https://github.com/m-labs/migen">https://github.com/m-labs/migen</a></p>
<p>下载项目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Either run the setup.py installation script or simply set PYTHONPATH to the root of the source directory.</span><br><span class="line"></span><br><span class="line">If you wish to contribute patches, the suggest way to install is;</span><br><span class="line"></span><br><span class="line">        Clone from the git repository at http://github.com/m-labs/migen</span><br><span class="line">        Install using python3 ./setup.py develop --user</span><br><span class="line">        Edit the code in your git checkout.</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解压到一个文件夹，</p>
<p>使用powershell在该文件夹下打开，运行：要求使用python3.6+</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pyhton ./setup.py develop -<span class="literal">-user</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#这样在windows下就安装好了</span></span><br></pre></td></tr></table></figure>

<h2 id="特定于FHDL域的语言"><a href="#特定于FHDL域的语言" class="headerlink" title="特定于FHDL域的语言"></a>特定于FHDL域的语言</h2><p>这个Fragmented Hardware Description Language (FHDL)是Migen的基础。</p>
<p>它由一个描述信号的正式系统，以及对它们进行操作的组合语句和同步语句组成。</p>
<p><strong>MyHDL</strong></p>
<p>MyHDL遵循传统的HDL的事件驱动；而FHDL将代码分成组合语句、同步语句和重置语句。</p>
<p>FHDL 由几个元素组成，下面将对其进行简要说明。它们都可以直接从 migen 模块导入。</p>
<h3 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h3><h4 id="常量-constants"><a href="#常量-constants" class="headerlink" title="常量 constants"></a>常量 constants</h4><p>这个<code>Constant</code>对象被解释为常量。他可以指定整型和布尔型，它也支持切片和指定位宽，并且可以表明符号。</p>
<p>明确的支持负数，跟MyHDL一样，算数操作返回==自然==结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">True</span> 	<span class="comment">#被解释为1</span></span><br><span class="line"><span class="literal">False</span> 	<span class="comment">#被解释为0</span></span><br></pre></td></tr></table></figure>

<p>为了简化语法，赋值和运算符会自动将 Python 整数和布尔值包装到 Constant 中。此外，Constant 是 C 的别名。以下是有效的 Migen 语句：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a.eq(<span class="number">0</span>), a.eq(a + <span class="number">1</span>), a.eq(C(<span class="number">42</span>)[<span class="number">0</span>:<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<h4 id="信号-Signal"><a href="#信号-Signal" class="headerlink" title="信号 Signal"></a>信号 Signal</h4><p>signal 对象表示电路中预期会发生变化的值。他完全符合Verilog中的wire 和reg 和VHDL中的signal的作用。</p>
<p>信号对象的要点是它由它的 Python ID（由 id() 函数返回）标识，没有别的。</p>
<p><strong>信号对象的属性是：</strong></p>
<ol>
<li>一个整数或一个（integer，boolean）对，用于定义位数以及信号的较高索引位是否为符号位（即信号有符号）。默认值为一位且无符号。或者，可以指定 min 和 max 参数来定义信号的范围并确定其位宽和符号。与 Python 范围一样，min 是包含的，默认为 0，max 是不包含的，默认为 2</li>
<li>name，用作 V*HDL 后端名称管理器的提示。</li>
<li>信号的复位值。它必须是一个整数，默认为0。当用同步语句修改信号的值时，复位值是关联寄存器的初始化值。当在条件组合语句（If 或  Case）中分配信号时，重置值是当没有验证导致信号被驱动的条件时信号具有的值。这强制设计中没有锁存器。如果使用组合语句永久驱动信号，则重置值无效。</li>
</ol>
<p>name 属性的唯一目的是使生成的 V*HDL 代码更易于理解和调试。从纯粹的功能角度来看，拥有多个具有相同名称属性的信号是完全可以的。后端将为每个对象生成一个唯一的名称。如果未指定 name 属性，Migen 将分析创建信号对象的代码，并尝试从中提取变量或成员名称。例如，以下语句将创建一个或多个名为“bar”的信号：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bar = Signal()</span><br><span class="line">self.bar = Signal()</span><br><span class="line">self.baz.bar = Signal()</span><br><span class="line">bar = [Signal() <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>)]</span><br></pre></td></tr></table></figure>

<p>如果发生冲突，Migen 首先尝试通过使用创建它们的类和模块层次结构中的名称作为标识符前缀来解决这种情况。如果冲突仍然存在（如果在同一上下文中创建了两个具有相同名称的信号对象，就会出现这种情况），它最终会添加数字后缀。</p>
<h4 id="运算符-Operators"><a href="#运算符-Operators" class="headerlink" title="运算符 Operators"></a>运算符 Operators</h4><p>运算符由 <strong>_Operator</strong> 对象表示，一般不应直接使用。相反，大多数 FHDL 对象重载了通常的 Python 逻辑和算术运算符，这允许使用更轻的语法。例如，表达式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a * b + c</span><br><span class="line"><span class="comment">#上式等价于</span></span><br><span class="line">_Operator(<span class="string">&quot;+&quot;</span>,[_Operator(<span class="string">&quot;*&quot;</span>,[a,b]),c])</span><br></pre></td></tr></table></figure>



<h4 id="切片-Slices"><a href="#切片-Slices" class="headerlink" title="切片 Slices"></a>切片 Slices</h4><p>同样的，切片由***<code>_Slice</code>**<em>对象表示,同样，通常不应该使用它来支持 Python 切片操作 [x:y]。支持使用 [x]、[x:] 和 [:y]  形式的隐式索引。谨防！切片的工作方式类似于 Python 切片，而不是 VHDL 或 Verilog 切片。第一个界限是 LSB  的索引并且是包含的。第二个界限是 MSB 的索引，是唯一的。在 V</em>HDL 中，界限是 MSB:LSB 并且两者都包含在内。</p>
<h4 id="连接-Concatenations"><a href="#连接-Concatenations" class="headerlink" title="连接 Concatenations"></a>连接 Concatenations</h4><p>连接是使用 Cat 对象完成的。为了使语法更简洁，它的构造函数采用可变数量的参数，这些参数是要连接在一起的信号（您可以使用 Python  的“*”运算符来代替传递列表）。为了与切片一致，第一个信号连接到结果中具有最低索引的位。这与 Verilog 中“{}”构造的工作方式相反。</p>
<p>==跟Verilog中的{}拼接语法功能一致==</p>
<h4 id="复制-Replications"><a href="#复制-Replications" class="headerlink" title="复制 Replications"></a>复制 Replications</h4><p>Replicate 对象表示==相当于 Verilog 中的 {count{expression}}==。例如，表达式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Replicate(<span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line"><span class="comment">#上式等价于</span></span><br><span class="line">cat(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure>



<h3 id="声明-Statements"><a href="#声明-Statements" class="headerlink" title="声明 Statements"></a>声明 Statements</h3><h4 id="分配-Assignment"><a href="#分配-Assignment" class="headerlink" title="分配 Assignment"></a>分配 Assignment</h4><p>分配由 <em><strong>_Assign</strong></em> 对象表示。由于直接使用它会导致语法混乱，因此首选的赋值技术是使用可以为其分配值的对象提供的 ==eq() 方法==。它们是信号，以及它们与切片和连接运算符的组合。例如，声明：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">0</span>].eq(b)</span><br><span class="line"><span class="comment">#上式等价于</span></span><br><span class="line">_Assign(_Slice(a,<span class="number">0</span>,<span class="number">1</span>),b)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="If"><a href="#If" class="headerlink" title="If"></a>If</h4><p>If 对象需要第一个参数，该参数必须是表示条件的表达式（Constant、Signal、_Operator、_Slice 等对象的组合），然后是表示语句（_Assign、If、Case 等）的可变数量的参数。对象）在条件得到验证时执行。</p>
<p>If 对象定义了一个 Else() 方法，该方法在调用时定义了在条件不为真时要执行的语句。这些语句作为参数传递给可变参数方法。</p>
<p>为方便起见，还有一个 Elif() 方法。</p>
<p>Example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">If(tx_count16 == <span class="number">0</span>,</span><br><span class="line">  tx_bitcount.eq(tx_bitcount + <span class="number">1</span>),</span><br><span class="line">  If(tx_bitcount == <span class="number">8</span>,</span><br><span class="line">    self.tx.eq(<span class="number">1</span>)</span><br><span class="line">  ).Elif(tx_bitcount == <span class="number">9</span>,</span><br><span class="line">        self.tx.eq(<span class="number">1</span>),</span><br><span class="line">        tx.busy.eq(<span class="number">0</span>)</span><br><span class="line">  ).Else(</span><br><span class="line">  	  self.tx.eq(tx_reg[<span class="number">0</span>]),</span><br><span class="line">      tx_reg.eq(Cat(tx_reg[<span class="number">1</span>:],<span class="number">0</span>))</span><br><span class="line">  )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="Case"><a href="#Case" class="headerlink" title="Case"></a>Case</h4><p>Case 对象构造函数将要测试的表达式和一个字典作为第一个参数，其键是要匹配的值，以及在匹配的情况下要执行的语句的值。特殊值“default”可以用作匹配值，这意味着只要没有其他匹配项就应该执行语句。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cases = &#123;</span><br><span class="line">            <span class="number">0x1</span>: abcdefg.eq(<span class="number">0b0000110</span>),</span><br><span class="line">            <span class="number">0x2</span>: abcdefg.eq(<span class="number">0b1011011</span>),</span><br><span class="line">            <span class="number">0x3</span>: abcdefg.eq(<span class="number">0b1001111</span>),</span><br><span class="line">            <span class="number">0x4</span>: abcdefg.eq(<span class="number">0b1100110</span>),</span><br><span class="line">            <span class="number">0x5</span>: abcdefg.eq(<span class="number">0b1101101</span>),</span><br><span class="line">            <span class="number">0x6</span>: abcdefg.eq(<span class="number">0b1111101</span>),</span><br><span class="line">            <span class="number">0x7</span>: abcdefg.eq(<span class="number">0b0000111</span>),</span><br><span class="line">            <span class="number">0x8</span>: abcdefg.eq(<span class="number">0b1111111</span>),</span><br><span class="line">            <span class="number">0x9</span>: abcdefg.eq(<span class="number">0b1101111</span>),</span><br><span class="line">            <span class="number">0xa</span>: abcdefg.eq(<span class="number">0b1110111</span>),</span><br><span class="line">            <span class="number">0xb</span>: abcdefg.eq(<span class="number">0b1111100</span>),</span><br><span class="line">            <span class="number">0xc</span>: abcdefg.eq(<span class="number">0b0111001</span>),</span><br><span class="line">            <span class="number">0xd</span>: abcdefg.eq(<span class="number">0b1011110</span>),</span><br><span class="line">            <span class="number">0xe</span>: abcdefg.eq(<span class="number">0b1111001</span>),</span><br><span class="line">            <span class="number">0xf</span>: abcdefg.eq(<span class="number">0b1110001</span>),</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Combinatorial assignement</span></span><br><span class="line">        self.comb += Case(value, cases)</span><br></pre></td></tr></table></figure>



<h4 id="数组-Arrays"><a href="#数组-Arrays" class="headerlink" title="数组 Arrays"></a>数组 Arrays</h4><p>Array 对象表示可以由 FHDL 表达式索引的其他对象的列表。明确可以：</p>
<ul>
<li>嵌套 Array 对象以创建多维表。</li>
<li>列出 Array 中的任何 Python 对象，只要出现在模块中的每个表达式最终都对索引的所有可能值计算为 Signal。这允许创建结构化数据列表。</li>
<li>在两个方向（赋值和读取）使用涉及 Array 对象的表达式。</li>
</ul>
<p>For example, this creates a 4x4 matrix of 1-bit signals:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">my_2d_array = Array(Array(Signal() <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>))</span><br></pre></td></tr></table></figure>

<p>然后，您可以使用（x 和 y 是 2 位信号）读取矩阵：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">读取矩阵：</span><br><span class="line">out.eq(my_2d_array[x][y])</span><br><span class="line"><span class="comment">#and write it with:</span></span><br><span class="line">my_2d_array[x][y].eq(inp)</span><br></pre></td></tr></table></figure>

<p>由于它们在 Verilog 中没有直接等价物，因此在实际转换发生之前，Array 对象被降低到多路复用器和条件语句中。这种降低自动发生，无需任何用户干预。  </p>
<p>对 Array 对象执行的任何越界访问都将引用最后一个元素。</p>
<h3 id="Specials"><a href="#Specials" class="headerlink" title="Specials"></a>Specials</h3><h4 id="三态IO-Tri-state-I-O"><a href="#三态IO-Tri-state-I-O" class="headerlink" title="三态IO Tri-state I/O"></a>三态IO Tri-state I/O</h4><p>定义三态 I/O 端口的单向信号的三元组 (O, OE, I) 由 TSTriple 对象表示。此类对象只是用于稍后连接到三态 I/O 缓冲区的信号的容器，==不能用作模块专用。==但是，此类对象应尽可能长时间地保留在设计中，因为它们允许以明确的方式处理单个单向信号。</p>
<p>可以用作特殊模块的对象是 Tristate，它的行为与三态 I/O 缓冲区的实例完全一样，定义如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Instance(<span class="string">&quot;Tristate&quot;</span>,</span><br><span class="line">        io_target=target,</span><br><span class="line">        i_o=o,</span><br><span class="line">        i_oe=oe,</span><br><span class="line">        o_i=i</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<p>信号目标，<font color="red">o </font>和 <font color="red">i  </font>可以有任何宽度，而<font color="red">oe </font>是 1 位宽。目标信号应该进入一个端口，而不是在设计的其他地方使用。与现代 FPGA 架构一样，Migen 不支持内部三态。</p>
<p>可以通过调用 get_tristate 方法从 TSTriple 对象创建 Tristate 对象。</p>
<p>默认情况下，Migen 为三态缓冲区发出与技术无关的行为代码。如果需要特定代码，可以使用 V*HDL 转换函数的适当参数覆盖三态处理程序。</p>
<h4 id="Instances-实例"><a href="#Instances-实例" class="headerlink" title="Instances 实例"></a>Instances 实例</h4><p>实例对象代表 V*HDL 模块的参数化实例，以及其端口与 FHDL 信号的连接。它们在许多情况下很有用：</p>
<ul>
<li>重用旧版或第三方 V*HDL 代码。</li>
<li>使用特殊的 FPGA 功能（DCM、ICAP 等）</li>
<li> 实现无法用 FHDL 表达的逻辑（例如锁存器）</li>
<li> 将 Migen 系统分解为多个子系统。</li>
</ul>
<p>实例对象构造函数采用实例的类型（即实例化模块的名称），然后是描述如何连接和参数化实例的多个参数。</p>
<p><strong>这些参数可以是：</strong></p>
<ul>
<li><font color="red">Instance.Input</font>、<font color="red">Instance.Output</font> 或 <font color="red">Instance.InOut</font> 来描述与实例的信号连接。参数是实例中端口的名称，以及它应该连接到的 FHDL 表达式。 </li>
<li><font color="red">Instance.Parameter</font> 设置实例的参数（带有名称和值）。</li>
<li> <font color="red">Instance.ClockPort </font>和 <font color="red">Instance.ResetPort </font>用于将时钟和复位信号连接到实例。唯一的强制参数是实例端口的名称。或者，可以指定时钟域名，并且可以使用<font color="red"> invert </font>选项连接到那些需要 180 度时钟或低电平有效复位的模块。</li>
</ul>
<h4 id="Memories-存储器"><a href="#Memories-存储器" class="headerlink" title="Memories 存储器"></a>Memories 存储器</h4><p>被支持使用类似于实例的机制支持Memories（on chip SRAM）。</p>
<p>Memory对象有以下参数：</p>
<ul>
<li>宽度，即每个字中的位数。</li>
<li>深度，表示内存中的单词数。</li>
<li>用于初始化内存的可选整数列表。</li>
</ul>
<p>要访问硬件中的内存，可以通过调用 get_port 方法获取端口。一个端口总是有一个地址信号a和一个数据读取信号dat_r。根据端口的配置，其他信号可能可用。</p>
<p><strong>get_port 的选项是：</strong></p>
<ul>
<li>write_capable（默认值：False）：如果端口可用于写入内存。这会产生一个额外的 we 信号。 </li>
<li>async_read（默认值：False）：读取是异步（组合）还是同步（注册）。 </li>
<li>has_re（默认值：False）：添加读取时钟使能信号 re（异步端口忽略）。 </li>
<li>we_granularity（默认值：0）：如果非零，则可能发生小于内存字的写入。 </li>
<li>we 信号的宽度增加以用作子字的选择信号。 </li>
<li>模式（默认值：WRITE_FIRST，异步端口忽略）。有可能：<ul>
<li>READ_FIRST：在写入期间，读取前一个值。   </li>
<li>WRITE_FIRST：返回写入的值。     </li>
<li>NO_CHANGE：数据读取信号在写入时保持其先前值。  </li>
</ul>
</li>
<li>clock_domain（默认值：“sys”）：用于从此端口读取和写入的时钟域。</li>
</ul>
<p>Migen 生成的行为 V<em>HDL 代码应该与所有模拟器兼容，如果端口数 &lt;= 2，则大多数 FPGA 合成器。如果需要特定代码，可以使用 V</em>HDL 转换函数的适当参数覆盖内存处理程序。</p>
<h3 id="模块-Modules"><a href="#模块-Modules" class="headerlink" title="模块 Modules"></a>模块 Modules</h3><p>模块的作用与 Verilog 模块和 VHDL 实体相同。同样，它们以树状结构组织。 FHDL 模块是派生自 Module 类的 Python 对象。这个类定义了派生类使用的特殊属性来描述它们的逻辑。它们在下面解释。</p>
<h4 id="组合语句-Combinatorial-statements"><a href="#组合语句-Combinatorial-statements" class="headerlink" title="组合语句 Combinatorial statements"></a>组合语句 Combinatorial statements</h4><p>组合语句是在其输入之一发生变化时执行的语句。  组合语句通过使用 comb 特殊属性添加到模块中。像大多数模块特殊属性一样，它必须使用 += 递增运算符访问，并且单个语句、语句元组或语句列表可以出现在右侧。  例如，下面的模块实现了一个或门：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ORGate</span>(<span class="params">Module</span>):</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">    self.a = Signal()</span><br><span class="line">    self.b = Signal()</span><br><span class="line">    self.x = Signal()</span><br><span class="line"></span><br><span class="line">    <span class="comment">###</span></span><br><span class="line"></span><br><span class="line">    self.comb += self.x.eq(self.a | self.b)</span><br></pre></td></tr></table></figure>

<p>为了提高代码可读性，建议将模块的接口放在 <strong>init</strong> 函数的开头，并使用三个井号将其与实现分开。</p>
<h4 id="时序逻辑-Synchronous-statements"><a href="#时序逻辑-Synchronous-statements" class="headerlink" title="时序逻辑 Synchronous statements"></a>时序逻辑 Synchronous statements</h4><p>同步语句是在某个时钟信号的每个边沿执行的语句。</p>
<p>在一个模块中通过使用<font color="red">sync</font> 指定同步属性，他跟组合逻辑一样，组合逻辑通过使用<font color="red">com</font>来指定组合逻辑的属性。</p>
<p><font color="red">sync</font> 同步属性可以指定使用的时钟域，比如：向foo时钟域添加一条语句，self.sync.foo += statement。默认的时钟域是==sys==下面的两条语句是等价的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">self.sync += statement</span><br><span class="line"><span class="comment">#等价于</span></span><br><span class="line">self.sync.sys +=statement</span><br></pre></td></tr></table></figure>

<h4 id="子模块和特殊项-Submodules-and-specials"><a href="#子模块和特殊项-Submodules-and-specials" class="headerlink" title="子模块和特殊项 Submodules and specials"></a>子模块和特殊项 Submodules and specials</h4><p>可以分别使用 submodules 和 specials 属性添加子模块和特殊项。这可以通过两种方式完成：</p>
<ol>
<li>匿名，通过直接在特殊属性上使用 += 运算符，例如self.submodules += some_other_module。与 comb 和 sync 属性一样，可以指定单个模块/特殊或元组或列表。</li>
<li>通过使用子模块或特殊属性的子属性命名子模块/特殊，例如self.submodules.foo =  module_foo。然后可以将子模块/特殊作为对象的属性访问，例如self.foo（而不是  self.submodules.foo）。使用此表单一次只能添加一个子模块/特殊项。</li>
</ol>
<h4 id="时钟域-Clock-domains"><a href="#时钟域-Clock-domains" class="headerlink" title="时钟域 Clock domains"></a>时钟域 Clock domains</h4><p>指定时钟域的实现是使用<font color="red"> ClockDomain </font>对象完成的。它包含时钟域的名称、可以像设计中的任何其他信号一样驱动的时钟信号（例如，使用 PLL 实例），以及可选的复位信号。没有复位信号的时钟域使用例如复位。 Verilog 中的初始语句，在许多 FPGA  系列中，它在配置期间初始化寄存器。</p>
<p>如果可以从变量名称中提取名称，则可以省略名称。使用此自动命名功能时，会删除前缀 <em>、cd</em> 和 _cd_。</p>
<p>然后使用 <font color="red">clock_domains </font>特殊属性将时钟域添加到模块中，该属性的行为与<font color="red">Submodules </font>和<font color="red">specials</font>完全相同。</p>
<h4 id="Summary-of-special-attributes"><a href="#Summary-of-special-attributes" class="headerlink" title="Summary of special attributes"></a>Summary of special attributes</h4><table>
<thead>
<tr>
<th>Syntax</th>
<th>Action</th>
</tr>
</thead>
<tbody><tr>
<td>self.comb += stmt</td>
<td>Add combinatorial statement to current module.</td>
</tr>
<tr>
<td>self.comb += stmtA, stmtB self.comb += [stmtA, stmtB]</td>
<td>Add combinatorial statements A and B to current module.</td>
</tr>
<tr>
<td>self.sync += stmt</td>
<td>Add synchronous statement to current module, in default clock domain sys.</td>
</tr>
<tr>
<td>self.sync.foo += stmt</td>
<td>Add synchronous statement to current module, in clock domain foo.</td>
</tr>
<tr>
<td>self.sync.foo += stmtA, stmtB self.sync.foo += [stmtA, stmtB]</td>
<td>Add synchronous statements A and B to current module, in clock domain foo.</td>
</tr>
<tr>
<td>self.submodules += mod</td>
<td>Add anonymous submodule to current module.</td>
</tr>
<tr>
<td>self.submodules += modA, modB self.submodules += [modA, modB]</td>
<td>Add anonymous submodules A and B to current module.</td>
</tr>
<tr>
<td>self.submodules.bar = mod</td>
<td>Add submodule named bar to current module. The submodule can then be accessed using self.bar.</td>
</tr>
<tr>
<td>self.specials += spe</td>
<td>Add anonymous special to current module.</td>
</tr>
<tr>
<td>self.specials += speA, speB self.specials += [speA, speB]</td>
<td>Add anonymous specials A and B to current module.</td>
</tr>
<tr>
<td>self.specials.bar = spe</td>
<td>Add special named bar to current module. The special can then be accessed using self.bar.</td>
</tr>
<tr>
<td>self.clock_domains += cd</td>
<td>Add clock domain to current module.</td>
</tr>
<tr>
<td>self.clock_domains += cdA, cdB self.clock_domains += [cdA, cdB]</td>
<td>Add clock domains A and B to current module.</td>
</tr>
<tr>
<td>self.clock_domains.pix = ClockDomain() self.clock_domains._pix = ClockDomain() self.clock_domains.cd_pix = ClockDomain() self.clock_domains._cd_pix = ClockDomain()</td>
<td>Create and add clock domain pix to current module. The clock domain name is pix in all cases. It can be accessed using self.pix, self._pix, self.cd_pix and self._cd_pix, respectively.</td>
</tr>
</tbody></table>
<h4 id="时钟域管理-Clock-domain-management"><a href="#时钟域管理-Clock-domain-management" class="headerlink" title="时钟域管理 Clock domain management"></a>时钟域管理 Clock domain management</h4><p>当一个模块命名了定义一个或多个同名时钟域的子模块时，这些时钟域名称的前缀是每个子模块的名称加上下划线。</p>
<p>此功能的一个示例用例是具有两个独立视频输出的系统。每个视频输出模块由定义时钟域pix并驱动时钟信号的时钟发生器模块，加上具有同步语句和时钟域pix中的其他元素的驱动模块组成。视频输出模块的设计者可以简单地使用该模块中的时钟域名pix。在顶层系统模块中，视频输出子模块分别命名为video0和video1。然后 Migen 自动将每个模块的 pix 时钟域重命名为 video0_pix 和  video1_pix。请注意，发生这种情况只是因为时钟域是定义的（使用 ClockDomain  对象），而不是在视频输出模块中简单地引用（使用例如同步语句）。  </p>
<p>当定义时钟域的任何子模块是匿名的时，时钟域名称重叠是一种错误情况。</p>
<h4 id="定稿机制-Finalization-mechanism"><a href="#定稿机制-Finalization-mechanism" class="headerlink" title="定稿机制 Finalization mechanism"></a>定稿机制 Finalization mechanism</h4><p>有时，希望仅在用户完成操作该模块后才创建某些模块逻辑。例如，FSM  模块支持动态定义状态，状态信号的宽度只有在添加所有状态后才能知道。一种解决方案是在 FSM  构造函数中声明最终的状态数，但这对用户不友好。更好的解决方案是在 FSM 模块转换为 V*HDL 之前自动创建状态信号。 Migen  使用所谓的终结机制来支持这一点。</p>
<p>模块可以重载可以创建逻辑并使用以下算法调用的 do_finalize 方法：</p>
<ol>
<li>当前模块的完成开始。 </li>
<li>如果模块已经完成（例如手动），则程序在此处停止。 </li>
<li>当前模块的子模块被递归确定。 </li>
<li>为当前模块调用 do_finalize。 </li>
<li>由当前模块的 do_finalize 创建的任何新子模块都将递归完成。</li>
</ol>
<p>在 V*HDL 转换和仿真时自动调用终结。可以通过调用其 finalize 方法为任何模块手动调用它。</p>
<p>上面解释的时钟域管理机制发生在最终确定期间。</p>
<h3 id="转换合成-Conversion-for-synthesis"><a href="#转换合成-Conversion-for-synthesis" class="headerlink" title="转换合成 Conversion for synthesis"></a>转换合成 Conversion for synthesis</h3><p>任何 FHDL 模块都可以转换为可综合的 Verilog HDL。这是通过使用 migen.fhdl.verilog 模块中的 convert 函数来完成的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># define FHDL module MyDesign here</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">  <span class="keyword">from</span> migen.fhdl.verilog <span class="keyword">import</span> convert</span><br><span class="line">  convert(MyDesign()).write(<span class="string">&quot;my_design.v&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>migen.build 组件提供将第三方 FPGA 工具（来自 Xilinx、Altera 和 Lattice）连接到 Migen 的脚本，以及用于轻松部署设计的电路板数据库。</p>
<h2 id="仿真Migen-设计-Simulating-a-Migen-design"><a href="#仿真Migen-设计-Simulating-a-Migen-design" class="headerlink" title="仿真Migen 设计 Simulating a Migen design"></a>仿真Migen 设计 Simulating a Migen design</h2><p>Migen 允许您轻松模拟 FHDL 设计并将其与任意 Python 代码连接。该模拟器是用纯 Python 编写的，无需使用外部 Verilog 模拟器即可直接解释 FHDL 结构。</p>
<p>Migen 允许您使用 Python 的生成器函数编写测试平台。此类测试平台与 FHDL 仿真器同时执行，并使用 <font color="red"> yield </font> 语句与其通信。有四种基本模式：</p>
<ol>
<li>Reads：可以使用(yield signal)查询当前时间信号的状态；</li>
<li> 写入：可以使用 (yield signal.eq(value)) 设置下一个时钟周期后的信号状态；</li>
<li> 时钟：模拟可以使用yield提前一个时钟周期；</li>
<li> 组成：可以使用<code>yield from run_other()</code>将控制权转移到另一个测试平台函数。</li>
</ol>
<p>可以使用 migen.sim 中的 run_simulation 函数运行测试平台； run_simulation(dut, bench) 根据 FHDL 模块 dut 中定义的逻辑运行生成器函数工作台。</p>
<p>将 vcd_name=”file.vcd” 参数传递给 run_simulation 将使其将 dut 内的信号的 VCD 转储写入 file.vcd。</p>
<h4 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h4><p>For example, consider this module:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ORGate</span>(<span class="params">Module</span>):</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">    self.a = Signal()</span><br><span class="line">    self.b = Signal()</span><br><span class="line">    self.x = Signal()</span><br><span class="line"></span><br><span class="line">    <span class="comment">###</span></span><br><span class="line"></span><br><span class="line">    self.comb += self.x.eq(self.a | self.b)</span><br></pre></td></tr></table></figure>

<p>It could be simulated together with the following testbench:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">dut = ORGate()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">testbench</span>():</span></span><br><span class="line">  <span class="keyword">yield</span> dut.a.eq(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">yield</span> dut.b.eq(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">yield</span></span><br><span class="line">  <span class="keyword">assert</span> (<span class="keyword">yield</span> dut.x) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">yield</span> dut.a.eq(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">yield</span> dut.b.eq(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">yield</span></span><br><span class="line">  <span class="keyword">assert</span> (<span class="keyword">yield</span> dut.x) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">run_simulation(dut, testbench())</span><br></pre></td></tr></table></figure>

<p>当然，这非常冗长，可以将各个步骤分解为单独的函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dut = ORGate()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_case</span>(<span class="params">a, b, x</span>):</span></span><br><span class="line">  <span class="keyword">yield</span> dut.a.eq(a)</span><br><span class="line">  <span class="keyword">yield</span> dut.b.eq(b)</span><br><span class="line">  <span class="keyword">yield</span></span><br><span class="line">  <span class="keyword">assert</span> (<span class="keyword">yield</span> dut.x) == x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">testbench</span>():</span></span><br><span class="line">  <span class="keyword">yield</span> <span class="keyword">from</span> check_case(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">  <span class="keyword">yield</span> <span class="keyword">from</span> check_case(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">yield</span> <span class="keyword">from</span> check_case(<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">yield</span> <span class="keyword">from</span> check_case(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">run_simulation(dut, testbench())</span><br></pre></td></tr></table></figure>

<h4 id="陷阱-Pitfalls"><a href="#陷阱-Pitfalls" class="headerlink" title="陷阱 Pitfalls"></a>陷阱 Pitfalls</h4><p>不幸的是，有一些基本错误会产生非常令人费解的结果。  </p>
<p>在调用其他测试平台时，重要的是不要忘记 yield from。如果省略，则调用将无声地执行任何操作。  </p>
<p>写入信号时，重要的是没有其他任何东西应该同时驱动信号。如果不是这种情况，写入将无声地做任何事情。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>只是大概的了解了Migen,可以使用python开发FPGA，还没有实际使用，处于基础的了解阶段。</p>
<h1 id="Python-FPGA"><a href="#Python-FPGA" class="headerlink" title="Python FPGA"></a>Python FPGA</h1><blockquote>
<p>使用python开发FPGA的方法：</p>
</blockquote>
<ol>
<li><a target="_blank" rel="noopener" href="https://m-labs.hk/gateware/migen/">Migen</a> </li>
<li><a target="_blank" rel="noopener" href="http://www.myhdl.org/">MyHDL</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/PyHDI/Pyverilog">Pyverilog</a> </li>
</ol>
<p>YouTube上的视频资料：</p>
<p>MyHDL:</p>
<p>​        <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=aTi35MMAVLs&amp;t=22s">https://www.youtube.com/watch?v=aTi35MMAVLs&amp;t=22s</a></p>
<h1 id="litex"><a href="#litex" class="headerlink" title="litex"></a>litex</h1><p>关于litex的相内容请参考我的learn-LiteX</p>
<p><a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litex">liteX</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/litex-hub">litex-hub</a>    </p>
<p><a target="_blank" rel="noopener" href="https://github.com/litex-hub/fpga_101">litex-lesson</a>    </p>
<p><a target="_blank" rel="noopener" href="https://github.com/enjoy-digital/litex/wiki">litex Wiki</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/09/22/Docker-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zsz">
      <meta itemprop="description" content="不负光阴韶华">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/09/22/Docker-notes/" class="post-title-link" itemprop="url">Docker 学习笔记</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-09-22 01:25:59" itemprop="dateCreated datePublished" datetime="2021-09-22T01:25:59+08:00">2021-09-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-04-11 23:30:45" itemprop="dateModified" datetime="2022-04-11T23:30:45+08:00">2022-04-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>[TOC]</p>
<h1 id="Docker-学习笔记"><a href="#Docker-学习笔记" class="headerlink" title="Docker 学习笔记"></a>Docker 学习笔记</h1><h2 id="Docker-概述"><a href="#Docker-概述" class="headerlink" title="Docker 概述"></a>Docker 概述</h2><h3 id="docker-可以干什么？"><a href="#docker-可以干什么？" class="headerlink" title="docker 可以干什么？"></a>docker 可以干什么？</h3><p>更快速的交付与部署，</p>
<p>docker 打包运行，一键运行。</p>
<p><strong>更便捷的升级和扩容</strong></p>
<p>使用docker 之后，我们部署应用更搭积木一样。</p>
<p><strong>更简单的运维</strong></p>
<p><strong>更高效的计算机资源利用</strong></p>
<p>docker是内核级的虚拟化，一个实体机上可以运行很多个容器。</p>
<h2 id="Docker-安装"><a href="#Docker-安装" class="headerlink" title="Docker 安装"></a>Docker 安装</h2><h3 id="Docker-的基本组成"><a href="#Docker-的基本组成" class="headerlink" title="Docker 的基本组成"></a>Docker 的基本组成</h3><p><img src="/2021/09/22/Docker-notes/image-20210916040839977.png" alt="image-20210916040839977"></p>
<p><strong>镜像(image)：</strong></p>
<p>docker 镜像好比是一个模板，可以通过这个创建容器服务， tomcat 镜像====》run ===&gt;tomcat01容器(提供服务)，通过这个镜像可以创建多个容器，（最终服务运行或项目运行就在这个容器中）</p>
<p><strong>容器(container)</strong></p>
<p>Docker 利用容器技术可以独立运行一个或一组应用，通过镜像来创建的，</p>
<p>启动，停止，删除，基本命令 </p>
<p>目前，可以把容器理解成一个简易的linux系统。</p>
<p><strong>仓库(repository)</strong></p>
<p>仓库就是用来存放镜像的地方。</p>
<p>仓库分为公有仓库和私有仓库！</p>
<p>Docker Hub （默认是国外的）</p>
<p>阿里云   都有容器服务。（配置镜像加速！）</p>
<h3 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">环境准备</span><br></pre></td></tr></table></figure>

<ol>
<li>需要会一点点的linux 的基础</li>
<li>Centos7</li>
<li>使用Xshell连接远程服务器进行操作</li>
</ol>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">环境查看</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">系统内核是5.14.3-arch1-1</span><br><span class="line">uname -r</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">系统版本</span><br><span class="line">zsz@zsz-pc ~]$ cat /etc/os-release </span><br><span class="line">NAME=&quot;Arch Linux&quot;</span><br><span class="line">PRETTY_NAME=&quot;Arch Linux&quot;</span><br><span class="line">ID=arch</span><br><span class="line">BUILD_ID=rolling</span><br><span class="line">ANSI_COLOR=&quot;38;2;23;147;209&quot;</span><br><span class="line">HOME_URL=&quot;https://archlinux.org/&quot;</span><br><span class="line">DOCUMENTATION_URL=&quot;https://wiki.archlinux.org/&quot;</span><br><span class="line">SUPPORT_URL=&quot;https://bbs.archlinux.org/&quot;</span><br><span class="line">BUG_REPORT_URL=&quot;https://bugs.archlinux.org/&quot;</span><br><span class="line">LOGO=archlinux</span><br><span class="line">[zsz@zsz-pc ~]$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Centos7-安装-Docker"><a href="#Centos7-安装-Docker" class="headerlink" title="Centos7 安装 Docker"></a>Centos7 安装 Docker</h4><ol>
<li><p>卸载</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure></li>
<li><p>使用官方仓库安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">安装环境</span></span><br><span class="line">sudo yum install -y yum-utils</span><br><span class="line"><span class="meta">#</span><span class="bash">设置仓库</span></span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta">#</span><span class="bash">在国内推荐使用阿里的</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>安装docker 相关的 docker-ce 社区 -ee 企业版 推荐使用ce</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">更新软件包索引</span></span><br><span class="line">yum makecache fast</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">安装</span></span><br><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure></li>
<li><p>启动Docker </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<p>帮助文档</p>
<h4 id="Archlinux-安装Docker"><a href="#Archlinux-安装Docker" class="headerlink" title="Archlinux 安装Docker"></a>Archlinux 安装Docker</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">安装 docker</span></span><br><span class="line">sudo pacman  -S docker</span><br><span class="line"><span class="meta">#</span><span class="bash">启动 docker 服务</span></span><br><span class="line">systemctl start docker.service</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看docker的信息</span></span><br><span class="line"></span><br><span class="line">sudo docker version</span><br><span class="line"></span><br><span class="line">Client:</span><br><span class="line"> Version:           20.10.8</span><br><span class="line"> API version:       1.41</span><br><span class="line"> Go version:        go1.16.6</span><br><span class="line"> Git commit:        3967b7d28e</span><br><span class="line"> Built:             Wed Aug  4 10:59:01 2021</span><br><span class="line"> OS/Arch:           linux/amd64</span><br><span class="line"> Context:           default</span><br><span class="line"> Experimental:      true</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          20.10.8</span><br><span class="line">  API version:      1.41 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.16.6</span><br><span class="line">  Git commit:       75249d88bc</span><br><span class="line">  Built:            Wed Aug  4 10:58:48 2021</span><br><span class="line">  OS/Arch:          linux/amd64</span><br><span class="line">  Experimental:     false</span><br><span class="line"> containerd:</span><br><span class="line">  Version:          v1.5.5</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">免sudo执行docker</span></span><br><span class="line">sudo gpasswd -a $&#123;USER&#125; docker</span><br><span class="line"><span class="meta">#</span><span class="bash">重新登录，重新开启docker服务，systemctl start docker.service</span></span><br><span class="line"><span class="meta">	#</span><span class="bash">在centos7中 需要刷新docker 组</span></span><br><span class="line">	newgrp docker</span><br><span class="line"><span class="meta">#</span><span class="bash">重新开启docker服务，</span></span><br><span class="line">systemctl start docker.service</span><br><span class="line"></span><br><span class="line">docker info </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">运行hello world</span> </span><br><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210916053831188.png" alt="image-20210916053831188" style="zoom:150%;">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">查看一下下载的这个hello-world 镜像</span><br><span class="line">[zsz@zsz-pc ~]$ docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    d1165f221234   6 months ago   13.3kB</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>卸载docker </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1、卸载依赖</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2、删除资源</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="回顾Hello-world"><a href="#回顾Hello-world" class="headerlink" title="回顾Hello world"></a>回顾Hello world</h3><h3 id="底层原理"><a href="#底层原理" class="headerlink" title="底层原理"></a>底层原理</h3><p><strong>Docker是怎么工作的？</strong></p>
<p>Docker 是一个Client-Server结构的服务，Docker的守护进程运行在主机上，通过Socket从客户端访问。</p>
<p>DockerServer 接受到Docker-Client的指令，就会执行这个命令。</p>
<p><img src="/2021/09/22/Docker-notes/image-20210916060909003.png" alt="image-20210916060909003"></p>
<p><strong>Docker为什么比虚拟机快</strong></p>
<ol>
<li>Docker 有着比虚拟机更少的抽象层。</li>
<li>Docker 利用的是宿主机的内核，VM需要的是guest os。</li>
</ol>
<p><img src="/2021/09/22/Docker-notes/image-20210916061429374.png" alt="image-20210916061429374"></p>
<p>所以说，新建一个容器的时候，docker不需要像虚拟机一样重新加载一个操作系统的内核，避免引导，虚拟机是加载Guest OS，分钟级别的，而Docker利用的是宿主机的操作系统，省略了这个过程，秒级的响应速度。</p>
<p>之后学习完毕所有的命令，再回过头来看这段理论，就会非常清晰。    </p>
<h2 id="Docker-的常用命令"><a href="#Docker-的常用命令" class="headerlink" title="Docker 的常用命令"></a>Docker 的常用命令</h2><h3 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker.service	#启动docker服务</span><br><span class="line">docker version 	#显示docker 的版本信息</span><br><span class="line">docker info		#显示docker的系统信息，包括镜像与容器的数量。</span><br><span class="line">docker --help	#帮助命令</span><br></pre></td></tr></table></figure>

<p>帮助文档的地址：<a target="_blank" rel="noopener" href="https://docs.docker.com/reference/">https://docs.docker.com/reference/</a></p>
<h3 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h3><h4 id="docker-images"><a href="#docker-images" class="headerlink" title="docker images"></a><strong>docker images</strong></h4><p><strong>查看所有本地的主机上的镜像</strong>。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[zsz@zsz-pc ~]$ docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    d1165f221234   6 months ago   13.3kB</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">解释</span></span><br><span class="line">REPOSITORY	镜像的仓库源</span><br><span class="line">TAG			镜像的标签</span><br><span class="line">IMAG ID		镜像的ID</span><br><span class="line">CREATE		镜像创建的时间</span><br><span class="line">SIZE		镜像的大小</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">常用可选项</span></span><br><span class="line">Options:</span><br><span class="line">  -a, --all            #列出所有的镜像 Show all images (default hides intermediate images)</span><br><span class="line">  -q, --quiet           #只显示镜像的ID Only show image IDs</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="docker-search"><a href="#docker-search" class="headerlink" title="**docker search **"></a>**docker search **</h4><p><strong>搜索命令</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[zsz@zsz-pc ~]$ docker search mysql</span><br><span class="line">NAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql                             MySQL is a widely used, open-source relation…   11419     [OK]       </span><br><span class="line">mariadb                           MariaDB Server is a high performing open sou…   4339      [OK]       </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">可选项</span></span><br><span class="line">-f, --filter filter   Filter output based on conditions provided</span><br><span class="line">	--format string   Pretty-print search using a Go template</span><br><span class="line">    --limit int       Max number of search results (default 25)</span><br><span class="line">	--no-trunc        Don&#x27;t truncate output</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">可选项 通过收藏来过滤</span></span><br><span class="line"> --filter=STARS=3000	#搜索出来的就是STARS大于3000的</span><br><span class="line"> </span><br><span class="line"> docker search mysql --filter=STARS=3000</span><br><span class="line">NAME      DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql     MySQL is a widely used, open-source relation…   11419     [OK]       </span><br><span class="line">mariadb   MariaDB Server is a high performing open sou…   4339      [OK]       </span><br><span class="line">[zsz@zsz-pc ~]$ docker search mysql --filter=STARS=5000</span><br><span class="line">NAME      DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql     MySQL is a widely used, open-source relation…   11419     [OK] </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="docker-pull"><a href="#docker-pull" class="headerlink" title="docker pull"></a><strong>docker pull</strong></h4><p><strong>拉取镜像</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">下载镜像，docker pull 镜像名[:tag]</span></span><br><span class="line">[zsz@zsz-pc ~]$ docker pull mysql</span><br><span class="line">Using default tag: latest	#如果不写tag,默认就是latest</span><br><span class="line">latest: Pulling from library/mysql</span><br><span class="line">a330b6cecb98: Pull complete #分层下载，docker image 的核心，联合文件系统</span><br><span class="line">9c8f656c32b8: Pull complete </span><br><span class="line">88e473c3f553: Pull complete </span><br><span class="line">062463ea5d2f: Pull complete </span><br><span class="line">daf7e3bdf4b6: Pull complete </span><br><span class="line">1839c0b7aac9: Pull complete </span><br><span class="line">cf0a0cfee6d0: Pull complete </span><br><span class="line">1b42041bb11e: Pull complete </span><br><span class="line">10459d86c7e6: Pull complete </span><br><span class="line">b7199599d5f9: Pull complete </span><br><span class="line">1d6f51e17d45: Pull complete </span><br><span class="line">50e0789bacad: Pull complete </span><br><span class="line">Digest: sha256:99e0989e7e3797cfbdb8d51a19d32c8d286dd8862794d01a547651a896bcf00c	#docker 签名，防伪标志</span><br><span class="line">Status: Downloaded newer image for mysql:latest</span><br><span class="line">docker.io/library/mysql:latest	#真实地址</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">等价于</span></span><br><span class="line">docker pull mysql</span><br><span class="line">docker pull docker.io/library/mysql:latest	</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">指定版本下载</span></span><br><span class="line">docker pull mysql:5.7</span><br><span class="line">5.7: Pulling from library/mysql</span><br><span class="line">a330b6cecb98: Already exists </span><br><span class="line">9c8f656c32b8: Already exists </span><br><span class="line">88e473c3f553: Already exists </span><br><span class="line">062463ea5d2f: Already exists </span><br><span class="line">daf7e3bdf4b6: Already exists </span><br><span class="line">1839c0b7aac9: Already exists </span><br><span class="line">cf0a0cfee6d0: Already exists </span><br><span class="line">fae7a809788c: Pull complete </span><br><span class="line">dae5a82a61f0: Pull complete </span><br><span class="line">7063da9569eb: Pull complete </span><br><span class="line">51a9a9b4ef36: Pull complete </span><br><span class="line">Digest: sha256:d9b934cdf6826629f8d02ea01f28b2c4ddb1ae27c32664b14867324b3e5e1291</span><br><span class="line">Status: Downloaded newer image for mysql:5.7</span><br><span class="line">docker.io/library/mysql:5.7</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="docker-rmi"><a href="#docker-rmi" class="headerlink" title="docker rmi"></a><strong>docker rmi</strong></h4><p>删除镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[zsz@zsz-pc ~]$ docker rmi -f 镜像ID 	#删除指定的容器</span><br><span class="line">[zsz@zsz-pc ~]$ docker rmi -f 镜像1ID 镜像1ID 镜像2ID 	#删除多个容器</span><br><span class="line">[zsz@zsz-pc ~]$ docker rmi -f $(docker images -aq)	#删除所有的容器</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h3><p>说明：我们有了镜像才可以创建容器，linux,下载一个centos镜像来测试学习。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull centos</span><br></pre></td></tr></table></figure>

<h4 id="新建容器并启动"><a href="#新建容器并启动" class="headerlink" title="新建容器并启动"></a><strong>新建容器并启动</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">docker run [可选参数] image </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">参数说明</span></span><br><span class="line">--name=&quot;Name&quot;	容器的名字，用来区分容器</span><br><span class="line">-d				后台运行</span><br><span class="line">-it				使用交互方式运行，进入容器查看内容。</span><br><span class="line">-p				指定容器的端口	-p 8080:8080</span><br><span class="line">	-p ip:主机端口:容器端口</span><br><span class="line">	-p	主机端口:容器端口(常用的)</span><br><span class="line">	-p	容器端口</span><br><span class="line">	容器端口	</span><br><span class="line">-P				随机指定端口</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">测试 启动并进入容器</span></span><br><span class="line">[zsz@zsz-pc ~]$ docker run -it centos /bin/bash</span><br><span class="line">[root@a67ea1104291 /]# 			#主机名就是images的镜像ID</span><br><span class="line">[root@a67ea1104291 /]# ls		#查看容器内的centos,基础版本，的命令可能都是不完善的</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line">[root@a67ea1104291 /]# exit		#从容器中退回主机</span><br><span class="line">exit</span><br><span class="line">[zsz@zsz-pc ~]$ ls</span><br><span class="line">Desktop    Downloads  Pictures  Templates  VMwareTools-10.3.10-13959562.tar.gz</span><br><span class="line">Documents  Music      Public    Videos     vmware-tools-distrib</span><br></pre></td></tr></table></figure>

<h4 id="列出正在运行的容器"><a href="#列出正在运行的容器" class="headerlink" title="列出正在运行的容器"></a><strong>列出正在运行的容器</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> docker ps 命令</span></span><br><span class="line"><span class="meta">	#</span><span class="bash">列出当前正在运行的容器</span></span><br><span class="line">-a 	#列出当前正在运行的容器+ 带出历史运行过的容器</span><br><span class="line">-n=?	#显示最近创建的容器。</span><br><span class="line">-q	#只显示容器的编号</span><br><span class="line"></span><br><span class="line">[zsz@zsz-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line">[zsz@zsz-pc ~]$ docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND       CREATED         STATUS                     PORTS     NAMES</span><br><span class="line">a67ea1104291   centos         &quot;/bin/bash&quot;   5 minutes ago   Exited (0) 2 minutes ago             eloquent_wiles</span><br><span class="line">86c173decece   d1165f221234   &quot;/hello&quot;      25 hours ago    Exited (0) 25 hours ago              sharp_shtern</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="退出容器"><a href="#退出容器" class="headerlink" title="退出容器"></a><strong>退出容器</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exit 	#直接停止容器并退出</span><br><span class="line">crtl+P+Q 	#容器不停止退出</span><br></pre></td></tr></table></figure>

<h4 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a><strong>删除容器</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器ID				#删除指定的镜像 ，不能删除正在运行的容器，如果要强制删除使用 rm -f</span><br><span class="line">docker rm -f $(docker ps -aq)#删除所有的容器</span><br><span class="line">docker ps -a -q |xargs docker rm #也可删除所有的容器</span><br></pre></td></tr></table></figure>

<h4 id="启动和停止容器操作"><a href="#启动和停止容器操作" class="headerlink" title="启动和停止容器操作"></a><strong>启动和停止容器操作</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker start 	容器ID	#启动容器</span><br><span class="line">docker	rstart	容器ID	#重启容器</span><br><span class="line">docker  stop	容器ID	#停止当前正在运行的容器</span><br><span class="line">docker kill		容器ID	#强制停止当前的容器</span><br></pre></td></tr></table></figure>



<h3 id="常用的其他命令"><a href="#常用的其他命令" class="headerlink" title="常用的其他命令"></a>常用的其他命令</h3><h4 id="后台启动容器"><a href="#后台启动容器" class="headerlink" title="后台启动容器"></a>后台启动容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">命令 docker run -d 镜像名！</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d archlinux</span><br><span class="line">c8419e6e8b0d040e66efba9b4d212752648b47379761811afd680cd288630fca</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">问题 docker ps 发现archlinux 停止了</span></span><br><span class="line">[proton@proton-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">常见的坑，docker 容器用后台运行，就必须要有一个进程，docker发现没有应用就会自动停止。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Nignx 容器启动后发现自己没有提供服务，就会立刻停止，就是没有程序。</span></span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h4 id="查看日志命令"><a href="#查看日志命令" class="headerlink" title="查看日志命令"></a>查看日志命令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> docker logs -f -t --tail 容器 没有日志</span><br><span class="line"><span class="meta"> </span></span><br><span class="line"><span class="meta"> #</span><span class="bash">自己写一段shell脚本</span></span><br><span class="line"> “while true;do echo nihao;sleep 1;done”</span><br><span class="line"> [proton@proton-pc ~]$ docker run -d archlinux /bin/sh -c &quot;while true;do echo hihao;sleep 1;done&quot; </span><br><span class="line">00fd93c63788ca4880b1ef87345977c696d2f275a73083911894883bf8d72353</span><br><span class="line">[proton@proton-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE       COMMAND                  CREATED         STATUS         PORTS     NAMES</span><br><span class="line">00fd93c63788   archlinux   &quot;/bin/sh -c &#x27;while t…&quot;   3 seconds ago   Up 3 seconds             zealous_lichterman</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">显示日志</span></span><br><span class="line">-tf			#显示日志 -t 时间戳 -f 跟踪日志输出</span><br><span class="line">--tail number #要显示的日志条数</span><br><span class="line"> docker logs -f -t --tail 10 00fd93c63788</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h4 id="查看容器中的进程信息-ps"><a href="#查看容器中的进程信息-ps" class="headerlink" title="查看容器中的进程信息 ps"></a>查看容器中的进程信息 ps</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">命令 docker top 容器ID</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker top d084a3f8133d</span><br><span class="line">UID                 PID                 PPID                C                   STIME               TTY   </span><br><span class="line">root                4613                4593                0                   07:13               ?     </span><br><span class="line">root                4697                4613                0                   07:14               ?     </span><br><span class="line">[proton@proton-pc ~]$ </span><br><span class="line"><span class="meta">#</span><span class="bash"> UID 用户ID</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PID 进程ID</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PPID 是父进程ID</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="查看镜像-这里是容器？？-的元数据"><a href="#查看镜像-这里是容器？？-的元数据" class="headerlink" title="查看镜像(这里是容器？？)的元数据"></a>查看镜像(这里是容器？？)的元数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line">docker inspect --hellp</span><br><span class="line"><span class="meta">#</span><span class="bash"> 命令</span></span><br><span class="line">docker inspect 容器ID</span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line">[proton@proton-pc ~]$ docker inspect d084a3f8133d</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2021-09-19T23:13:45.41748822Z&quot;,</span><br><span class="line">        &quot;Path&quot;: &quot;/bin/sh&quot;,</span><br><span class="line">        &quot;Args&quot;: [</span><br><span class="line">            &quot;-c&quot;,</span><br><span class="line">            &quot;while true;do echo hihao;sleep 1;done&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;State&quot;: &#123;</span><br><span class="line">            &quot;Status&quot;: &quot;running&quot;,</span><br><span class="line">            &quot;Running&quot;: true,</span><br><span class="line">            &quot;Paused&quot;: false,</span><br><span class="line">            &quot;Restarting&quot;: false,</span><br><span class="line">            &quot;OOMKilled&quot;: false,</span><br><span class="line">            &quot;Dead&quot;: false,</span><br><span class="line">            &quot;Pid&quot;: 4613,</span><br><span class="line">            &quot;ExitCode&quot;: 0,</span><br><span class="line">            &quot;Error&quot;: &quot;&quot;,</span><br><span class="line">            &quot;StartedAt&quot;: &quot;2021-09-19T23:13:45.855531374Z&quot;,</span><br><span class="line">            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Image&quot;: &quot;sha256:1d6f90387c134e502f5579c8c7ded65a5eaf25b9b2a5dce29a844e9290d4853c&quot;,</span><br><span class="line">        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f/resolv.conf&quot;,</span><br><span class="line">        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f/hostname&quot;,</span><br><span class="line">        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f/hosts&quot;,</span><br><span class="line">        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f/d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f-json.log&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;/nice_dewdney&quot;,</span><br><span class="line">        &quot;RestartCount&quot;: 0,</span><br><span class="line">        &quot;Driver&quot;: &quot;overlay2&quot;,</span><br><span class="line">        &quot;Platform&quot;: &quot;linux&quot;,</span><br><span class="line">        &quot;MountLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ProcessLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;AppArmorProfile&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ExecIDs&quot;: null,</span><br><span class="line">        &quot;HostConfig&quot;: &#123;</span><br><span class="line">            &quot;Binds&quot;: null,</span><br><span class="line">            &quot;ContainerIDFile&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LogConfig&quot;: &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;json-file&quot;,</span><br><span class="line">                &quot;Config&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;NetworkMode&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;PortBindings&quot;: &#123;&#125;,</span><br><span class="line">            &quot;RestartPolicy&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;no&quot;,</span><br><span class="line">                &quot;MaximumRetryCount&quot;: 0</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;AutoRemove&quot;: false,</span><br><span class="line">            &quot;VolumeDriver&quot;: &quot;&quot;,</span><br><span class="line">            &quot;VolumesFrom&quot;: null,</span><br><span class="line">            &quot;CapAdd&quot;: null,</span><br><span class="line">            &quot;CapDrop&quot;: null,</span><br><span class="line">            &quot;CgroupnsMode&quot;: &quot;host&quot;,</span><br><span class="line">            &quot;Dns&quot;: [],</span><br><span class="line">            &quot;DnsOptions&quot;: [],</span><br><span class="line">            &quot;DnsSearch&quot;: [],</span><br><span class="line">            &quot;ExtraHosts&quot;: null,</span><br><span class="line">            &quot;GroupAdd&quot;: null,</span><br><span class="line">            &quot;IpcMode&quot;: &quot;private&quot;,</span><br><span class="line">            &quot;Cgroup&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Links&quot;: null,</span><br><span class="line">            &quot;OomScoreAdj&quot;: 0,</span><br><span class="line">            &quot;PidMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Privileged&quot;: false,</span><br><span class="line">            &quot;PublishAllPorts&quot;: false,</span><br><span class="line">            &quot;ReadonlyRootfs&quot;: false,</span><br><span class="line">            &quot;SecurityOpt&quot;: null,</span><br><span class="line">            &quot;UTSMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;UsernsMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;ShmSize&quot;: 67108864,</span><br><span class="line">            &quot;Runtime&quot;: &quot;runc&quot;,</span><br><span class="line">            &quot;ConsoleSize&quot;: [</span><br><span class="line">                0,</span><br><span class="line">                0</span><br><span class="line">            ],</span><br><span class="line">            &quot;Isolation&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpuShares&quot;: 0,</span><br><span class="line">            &quot;Memory&quot;: 0,</span><br><span class="line">            &quot;NanoCpus&quot;: 0,</span><br><span class="line">            &quot;CgroupParent&quot;: &quot;&quot;,</span><br><span class="line">            &quot;BlkioWeight&quot;: 0,</span><br><span class="line">            &quot;BlkioWeightDevice&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadBps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceWriteBps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceReadIOps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceWriteIOps&quot;: null,</span><br><span class="line">            &quot;CpuPeriod&quot;: 0,</span><br><span class="line">            &quot;CpuQuota&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimePeriod&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimeRuntime&quot;: 0,</span><br><span class="line">            &quot;CpusetCpus&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpusetMems&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Devices&quot;: [],</span><br><span class="line">            &quot;DeviceCgroupRules&quot;: null,</span><br><span class="line">            &quot;DeviceRequests&quot;: null,</span><br><span class="line">            &quot;KernelMemory&quot;: 0,</span><br><span class="line">            &quot;KernelMemoryTCP&quot;: 0,</span><br><span class="line">            &quot;MemoryReservation&quot;: 0,</span><br><span class="line">            &quot;MemorySwap&quot;: 0,</span><br><span class="line">            &quot;MemorySwappiness&quot;: null,</span><br><span class="line">            &quot;OomKillDisable&quot;: false,</span><br><span class="line">            &quot;PidsLimit&quot;: null,</span><br><span class="line">            &quot;Ulimits&quot;: null,</span><br><span class="line">            &quot;CpuCount&quot;: 0,</span><br><span class="line">            &quot;CpuPercent&quot;: 0,</span><br><span class="line">            &quot;IOMaximumIOps&quot;: 0,</span><br><span class="line">            &quot;IOMaximumBandwidth&quot;: 0,</span><br><span class="line">            &quot;MaskedPaths&quot;: [</span><br><span class="line">                &quot;/proc/asound&quot;,</span><br><span class="line">                &quot;/proc/acpi&quot;,</span><br><span class="line">                &quot;/proc/kcore&quot;,</span><br><span class="line">                &quot;/proc/keys&quot;,</span><br><span class="line">                &quot;/proc/latency_stats&quot;,</span><br><span class="line">                &quot;/proc/timer_list&quot;,</span><br><span class="line">                &quot;/proc/timer_stats&quot;,</span><br><span class="line">                &quot;/proc/sched_debug&quot;,</span><br><span class="line">                &quot;/proc/scsi&quot;,</span><br><span class="line">                &quot;/sys/firmware&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ReadonlyPaths&quot;: [</span><br><span class="line">                &quot;/proc/bus&quot;,</span><br><span class="line">                &quot;/proc/fs&quot;,</span><br><span class="line">                &quot;/proc/irq&quot;,</span><br><span class="line">                &quot;/proc/sys&quot;,</span><br><span class="line">                &quot;/proc/sysrq-trigger&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;GraphDriver&quot;: &#123;</span><br><span class="line">            &quot;Data&quot;: &#123;</span><br><span class="line">                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/c3bd95c9c2023cda996478c2d20c8f0163080a5466512c69b56d1547fb64fb7a-init/diff:/var/lib/docker/overlay2/d354ad152b1c58221ab29fbd5cc5aba182a46ff3768ab8bf1abccd8aa6427606/diff:/var/lib/docker/overlay2/36d83b359020a4be71d40164e140b06b202e37f3fbba20e2ebc660eeb243068e/diff&quot;,</span><br><span class="line">                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/c3bd95c9c2023cda996478c2d20c8f0163080a5466512c69b56d1547fb64fb7a/merged&quot;,</span><br><span class="line">                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/c3bd95c9c2023cda996478c2d20c8f0163080a5466512c69b56d1547fb64fb7a/diff&quot;,</span><br><span class="line">                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/c3bd95c9c2023cda996478c2d20c8f0163080a5466512c69b56d1547fb64fb7a/work&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Name&quot;: &quot;overlay2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Mounts&quot;: [],</span><br><span class="line">        &quot;Config&quot;: &#123;</span><br><span class="line">            &quot;Hostname&quot;: &quot;d084a3f8133d&quot;,</span><br><span class="line">            &quot;Domainname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;User&quot;: &quot;&quot;,</span><br><span class="line">            &quot;AttachStdin&quot;: false,</span><br><span class="line">            &quot;AttachStdout&quot;: false,</span><br><span class="line">            &quot;AttachStderr&quot;: false,</span><br><span class="line">            &quot;Tty&quot;: false,</span><br><span class="line">            &quot;OpenStdin&quot;: false,</span><br><span class="line">            &quot;StdinOnce&quot;: false,</span><br><span class="line">            &quot;Env&quot;: [</span><br><span class="line">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;,</span><br><span class="line">                &quot;LANG=en_US.UTF-8&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Cmd&quot;: [</span><br><span class="line">                &quot;/bin/sh&quot;,</span><br><span class="line">                &quot;-c&quot;,</span><br><span class="line">                &quot;while true;do echo hihao;sleep 1;done&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Image&quot;: &quot;archlinux&quot;,</span><br><span class="line">            &quot;Volumes&quot;: null,</span><br><span class="line">            &quot;WorkingDir&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Entrypoint&quot;: null,</span><br><span class="line">            &quot;OnBuild&quot;: null,</span><br><span class="line">            &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;NetworkSettings&quot;: &#123;</span><br><span class="line">            &quot;Bridge&quot;: &quot;&quot;,</span><br><span class="line">            &quot;SandboxID&quot;: &quot;902259aa7f3aa96eda81eb8eb9b1da8d3e6237adbb2049226e41d1b5bfab2899&quot;,</span><br><span class="line">            &quot;HairpinMode&quot;: false,</span><br><span class="line">            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LinkLocalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;Ports&quot;: &#123;&#125;,</span><br><span class="line">            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/902259aa7f3a&quot;,</span><br><span class="line">            &quot;SecondaryIPAddresses&quot;: null,</span><br><span class="line">            &quot;SecondaryIPv6Addresses&quot;: null,</span><br><span class="line">            &quot;EndpointID&quot;: &quot;e563118b1a8af58979bc244e925b2d826334cca6daadf60763612c2c271d1f7c&quot;,</span><br><span class="line">            &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">            &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">            &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">            &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">            &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">            &quot;Networks&quot;: &#123;</span><br><span class="line">                &quot;bridge&quot;: &#123;</span><br><span class="line">                    &quot;IPAMConfig&quot;: null,</span><br><span class="line">                    &quot;Links&quot;: null,</span><br><span class="line">                    &quot;Aliases&quot;: null,</span><br><span class="line">                    &quot;NetworkID&quot;: &quot;7e7119e437a1e69833d5325030ff480c21257adb02543e0ee3e31010cc60e424&quot;,</span><br><span class="line">                    &quot;EndpointID&quot;: &quot;e563118b1a8af58979bc244e925b2d826334cca6daadf60763612c2c271d1f7c&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">                    &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">                    &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">                    &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">                    &quot;DriverOpts&quot;: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line">[proton@proton-pc ~]$ </span><br></pre></td></tr></table></figure>

<h4 id="进入当前正在运行的容器"><a href="#进入当前正在运行的容器" class="headerlink" title="进入当前正在运行的容器"></a>进入当前正在运行的容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">我们通常是使用后台的方式运行的，需要进入容器，修改一些配置</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">命令</span></span><br><span class="line">docker exec -it 容器ID bashShell</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it d084a3f8133d /bin/bash </span><br><span class="line">[root@d084a3f8133d /]# ps</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">  992 pts/0    00:00:00 bash</span><br><span class="line"> 1005 pts/0    00:00:00 ps</span><br><span class="line">[root@d084a3f8133d /]# ps -ef</span><br><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">root         1     0  0 23:13 ?        00:00:00 /bin/sh -c while true;do echo hihao;sleep 1;done</span><br><span class="line">root       992     0  0 23:30 pts/0    00:00:00 /bin/bash</span><br><span class="line">root      1014     1  0 23:30 ?        00:00:00 sleep 1</span><br><span class="line">root      1015   992  0 23:30 pts/0    00:00:00 ps -ef</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">方式二</span></span><br><span class="line">docker attach 容器ID </span><br><span class="line"><span class="meta">#</span><span class="bash">正在执行当前的代码……</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">docker <span class="built_in">exec</span>	<span class="comment">#进入容器后开启一个新的终端，可以在里面操作，（常用）</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">docker attach	<span class="comment">#进入容器正在执行的终端</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="从容器内拷贝文件到主机上"><a href="#从容器内拷贝文件到主机上" class="headerlink" title="从容器内拷贝文件到主机上"></a>从容器内拷贝文件到主机上</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">docker cp 容器id:容器内路径，目的主机路径</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看当前主机目录下文件</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE       COMMAND       CREATED         STATUS         PORTS     NAMES</span><br><span class="line">8fd4c9c0d2cc   archlinux   &quot;/bin/bash&quot;   2 minutes ago   Up 2 minutes             gallant_goldstine</span><br><span class="line"><span class="meta">#</span><span class="bash">进入正在运行的docker容器内部</span></span><br><span class="line">[proton@proton-pc ~]$ docker attach 8fd4c9c0d2cc</span><br><span class="line">[root@8fd4c9c0d2cc /]# cd /home</span><br><span class="line">[root@8fd4c9c0d2cc home]# ls</span><br><span class="line"><span class="meta">#</span><span class="bash">在容器内新建一个文件</span></span><br><span class="line">[root@8fd4c9c0d2cc home]# touch test.java</span><br><span class="line">[root@8fd4c9c0d2cc home]# exit</span><br><span class="line">exit</span><br><span class="line">[proton@proton-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line">[proton@proton-pc ~]$ docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE       COMMAND       CREATED         STATUS                      PORTS     NAMES</span><br><span class="line">8fd4c9c0d2cc   archlinux   &quot;/bin/bash&quot;   4 minutes ago   Exited (0) 24 seconds ago             gallant_goldstine</span><br><span class="line"><span class="meta">#</span><span class="bash">将docker容器内的文件拷贝出来，到主机上，</span></span><br><span class="line">[proton@proton-pc ~]$ docker cp 8fd4c9c0d2cc:/home/test.java ./    </span><br><span class="line">[proton@proton-pc ~]$ ls</span><br><span class="line">test.java  test.txt</span><br><span class="line">[proton@proton-pc ~]$ </span><br><span class="line"><span class="meta">#</span><span class="bash">拷贝是一个手动的过程。未来我们采用 -v 卷的技术可以实现</span></span><br></pre></td></tr></table></figure>



<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p><img src="/2021/09/22/Docker-notes/image-20210920200126977.png" alt="image-20210920200126977"></p>
<p>相关的命令可以通过参考下面的。</p>
<p>接下来是一些练习。</p>
<h3 id="作业练习"><a href="#作业练习" class="headerlink" title="作业练习"></a>作业练习</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Doker 安装 Nginx</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1、搜素镜像 search  建议去dockerhub上搜素 可以看到详细信息。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">2、下载镜像 pull</span></span><br><span class="line"><span class="meta">#</span><span class="bash">3、运行测试</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看镜像</span></span><br><span class="line">[proton@proton-pc ~]$ docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">nginx         latest    ad4c705f24d3   10 days ago    133MB</span><br><span class="line">mysql         latest    0716d6ebcc1a   2 weeks ago    514MB</span><br><span class="line">archlinux     latest    1d6f90387c13   2 weeks ago    381MB</span><br><span class="line">hello-world   latest    d1165f221234   6 months ago   13.3kB</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -d 后台运行</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> --name 给容器起名字</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -p 宿主机端口:容器内部端口</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker run -d --name nginx01 -p:3344:80 nginx</span><br><span class="line">27d6eeb14afcd7ba05975dd1ad18881a3ae29715bd0a715e9e8607be88170a6d</span><br><span class="line">[proton@proton-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS                                   NAMES</span><br><span class="line">27d6eeb14afc   nginx     &quot;/docker-entrypoint.…&quot;   6 seconds ago   Up 5 seconds   0.0.0.0:3344-&gt;80/tcp, :::3344-&gt;80/tcp   nginx01</span><br><span class="line">[proton@proton-pc ~]$ curl localhost:3344</span><br><span class="line"><span class="meta">#</span><span class="bash">测试通过</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">进入容器</span></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it nginx01 /bin/bash</span><br><span class="line">root@27d6eeb14afc:/# whereis nginx</span><br><span class="line">nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx</span><br><span class="line">root@27d6eeb14afc:/# cd /etc/nginx/</span><br><span class="line">root@27d6eeb14afc:/etc/nginx# ls</span><br><span class="line">conf.d          mime.types  nginx.conf   uwsgi_params</span><br><span class="line">fastcgi_params  modules     scgi_params</span><br><span class="line">root@27d6eeb14afc:/etc/nginx# </span><br></pre></td></tr></table></figure>

<h5 id="端口暴露的概念"><a href="#端口暴露的概念" class="headerlink" title="端口暴露的概念"></a>端口暴露的概念</h5><p><img src="/2021/09/22/Docker-notes/image-20210920204051023.png" alt="image-20210920204051023"></p>
<p><strong>思考问题</strong>： 我们每次修改nginx配置文件，都需要进入容器内部？？？十分的不方便，我们要是可以在容器内部提供一个映射路径，达到在容器修改文件名，容器内就可以自动修改？-v 数据卷</p>
<p>答案：通过使用  -v /user/share/nginx /usr/nginx</p>
<blockquote>
<p>作业二：docker 安装tomcat</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">官方的使用</span></span><br><span class="line">docker run -it --rm tomcat:9.0</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">我们之前都是后台启动，停止了容器后，容器还可查到。docker run -it --rm tomcat:9.0 这个一般用来测试用完即删除容器。</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">先下载，后启动</span></span><br><span class="line">docker pull tomcat</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">启动运行</span>	</span><br><span class="line">[proton@proton-pc ~]$ docker run -d -p 3355:8080 --name tomcat01 tomcat</span><br><span class="line">fe4af990f493099f2b6650f276aee86da25bd7216ac53de70df893d50a38b18f</span><br><span class="line"><span class="meta">#</span><span class="bash">已经可以访问了</span></span><br><span class="line">-p 端口映射 宿主机Port:容器Port</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">进入容器</span></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat01 /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash">发现问题 1、linux 命令少了 2、没有webapps 阿里云镜像的原因，默认是最小的，所有不必要的都剔除了。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">保证最小的运行环境。</span></span><br></pre></td></tr></table></figure>

<p><strong>思考问题：</strong> 我们以后部署项目，如果每次都进入容器是不是十分麻烦？？？我们要是可以在容器外部提供一个映射路径，webapps,</p>
<p>我们在外部放置项目，就自动同步到内部就好了！</p>
<p>docker 容器 tomcat + 网站 docker mysql </p>
<blockquote>
<p>作业3 部署es + kibana</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">es 暴露的端口很多！</span></span><br><span class="line"><span class="meta">#</span><span class="bash">es 十分耗内存</span></span><br><span class="line"><span class="meta">#</span><span class="bash">es 的数据一般需要放置到安全目录!挂载</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> --net somenetwork ? 网络配置</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">启动 elasticsearch</span></span><br><span class="line">docker run -d --name elasticsearch  -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:7.6.2</span><br><span class="line"><span class="meta">#</span><span class="bash">docker stats 查看cpu的状态，</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">es 是十分耗内存的，</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看docker stats</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">测试一下</span></span><br><span class="line">[proton@proton-pc ~]$ curl localhost:9200</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot; : &quot;b941f0a0249a&quot;,</span><br><span class="line">  &quot;cluster_name&quot; : &quot;docker-cluster&quot;,</span><br><span class="line">  &quot;cluster_uuid&quot; : &quot;Z0X-vBnCTZCXwKZi_dYDEw&quot;,</span><br><span class="line">  &quot;version&quot; : &#123;</span><br><span class="line">    &quot;number&quot; : &quot;7.6.2&quot;,</span><br><span class="line">    &quot;build_flavor&quot; : &quot;default&quot;,</span><br><span class="line">    &quot;build_type&quot; : &quot;docker&quot;,</span><br><span class="line">    &quot;build_hash&quot; : &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;,</span><br><span class="line">    &quot;build_date&quot; : &quot;2020-03-26T06:34:37.794943Z&quot;,</span><br><span class="line">    &quot;build_snapshot&quot; : false,</span><br><span class="line">    &quot;lucene_version&quot; : &quot;8.4.0&quot;,</span><br><span class="line">    &quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;,</span><br><span class="line">    &quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;tagline&quot; : &quot;You Know, for Search&quot;</span><br><span class="line">&#125;</span><br><span class="line">[proton@proton-pc ~]$ </span><br><span class="line"><span class="meta">#</span><span class="bash">赶紧停下，增加内存的限制</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/22/Docker-notes/image-20210920214128402.png" alt="image-20210920214128402"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">赶紧关闭，增加内存限制，修改配置文 -e 环境配置修改</span></span><br><span class="line">docker run -d --name elasticsearch02  -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; -e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot; elasticsearch:7.6.2</span><br><span class="line">docker stats</span><br><span class="line"></span><br><span class="line">CONTAINER ID   NAME              CPU %     MEM USAGE / LIMIT     MEM %     NET I/O     BLOCK I/O    PIDS</span><br><span class="line">22d837c5bc64   elasticsearch02   2.59%     350.4MiB / 3.349GiB   10.22%    666B / 0B   0B / 729kB   45</span><br><span class="line">^C</span><br><span class="line">[proton@proton-pc ~]$ </span><br><span class="line"><span class="meta">#</span><span class="bash">测试成功了</span></span><br><span class="line">[proton@proton-pc ~]$ curl localhost:9200</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot; : &quot;22d837c5bc64&quot;,</span><br><span class="line">  &quot;cluster_name&quot; : &quot;docker-cluster&quot;,</span><br><span class="line">  &quot;cluster_uuid&quot; : &quot;1EhZDfWjTZCtNqgiloiMCw&quot;,</span><br><span class="line">  &quot;version&quot; : &#123;</span><br><span class="line">    &quot;number&quot; : &quot;7.6.2&quot;,</span><br><span class="line">    &quot;build_flavor&quot; : &quot;default&quot;,</span><br><span class="line">    &quot;build_type&quot; : &quot;docker&quot;,</span><br><span class="line">    &quot;build_hash&quot; : &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;,</span><br><span class="line">    &quot;build_date&quot; : &quot;2020-03-26T06:34:37.794943Z&quot;,</span><br><span class="line">    &quot;build_snapshot&quot; : false,</span><br><span class="line">    &quot;lucene_version&quot; : &quot;8.4.0&quot;,</span><br><span class="line">    &quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;,</span><br><span class="line">    &quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;tagline&quot; : &quot;You Know, for Search&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>作业： 使用kibana 链接我们的 elasticsearch 思考网路如何连过去。</p>
</blockquote>
<p><img src="/2021/09/22/Docker-notes/image-20210920215749543.png" alt="image-20210920215749543"></p>
<h3 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h3><ul>
<li>portainer (先用这个)</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8088:9000 \</span><br><span class="line"> --restart always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>

<ul>
<li>Rancher(CI/CD)</li>
</ul>
<p><strong>什么是portaniner?</strong></p>
<p>Docker 图形化界面管理工具，提供一个后台面板提供给我们使用操作！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8088:9000 \</span><br><span class="line"> --restart always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>

<p>访问测试： <a target="_blank" rel="noopener" href="http://173.82.54.177:8088/">http://173.82.54.177:8088/</a></p>
<p>通过他来访问</p>
<p><img src="/2021/09/22/Docker-notes/image-20210921005349991.png" alt="image-20210921005349991"></p>
<p>设置密码，就可以登录了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">admin</span><br><span class="line"></span><br><span class="line">docker123456</span><br></pre></td></tr></table></figure>



<p>选择本地的</p>
<p>登录进去后</p>
<p><img src="/2021/09/22/Docker-notes/image-20210921005757086.png" alt="image-20210921005757086"></p>
<p>可视化面板测试，玩玩就可以了 。</p>
<h2 id="Docker-镜像讲解"><a href="#Docker-镜像讲解" class="headerlink" title="Docker 镜像讲解"></a>Docker 镜像讲解</h2><h3 id="镜像是什么"><a href="#镜像是什么" class="headerlink" title="镜像是什么"></a>镜像是什么</h3><h3 id="Docker镜像加载原理"><a href="#Docker镜像加载原理" class="headerlink" title="Docker镜像加载原理"></a>Docker镜像加载原理</h3><h3 id="Docker-分层原理"><a href="#Docker-分层原理" class="headerlink" title="Docker 分层原理"></a>Docker 分层原理</h3><h3 id="Docker-commit-镜像"><a href="#Docker-commit-镜像" class="headerlink" title="Docker commit 镜像"></a>Docker commit 镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker commit #提交容器为一个新的副本</span><br><span class="line">docker commit -m=&quot;提交的描述信息&quot; -a=&quot;作者&quot; 容器ID 目标镜像名:[tag]</span><br></pre></td></tr></table></figure>

<p>实战测试</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1、启动一个默认的tomcat</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">2、发现这个默认的tomcat 是没有webapps应用的，镜像的原因，官方的镜像默认webapps下是没有文件的</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">3、我自己拷贝进去了基本的文件</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">4、将我们操作过的容器通过commit 提交为一个镜像，我们以后就使用我们修改过后的镜像即可这就是我们自己的一个修改的镜像</span></span><br><span class="line">[proton@proton-pc ~]$ docker commit -a=&quot;zsz&quot; -m=&quot;add webapps app&quot;  834fa0b1163f tomcat02</span><br><span class="line">sha256:cdb85d573e3f93bf8f00cf2e1b3535d006d52f75cfa76464e2615dabb97f788a</span><br><span class="line">[proton@proton-pc ~]$ docker images</span><br><span class="line">REPOSITORY            TAG       IMAGE ID       CREATED          SIZE</span><br><span class="line">tomcat02              latest    cdb85d573e3f   15 seconds ago   684MB</span><br><span class="line">tomcat                9.0       62146f8bda84   6 days ago       680MB</span><br><span class="line">tomcat                latest    bb832de23021   6 days ago       680MB</span><br></pre></td></tr></table></figure>

<p>如果你想要保存当前的容器镜状态，就可以通过commit来提交，并获得一个镜像。</p>
<p>入门 docker 了 哈哈</p>
<p>接下来才比较重要，</p>
<h2 id="容器数据卷"><a href="#容器数据卷" class="headerlink" title="容器数据卷"></a>容器数据卷</h2><h3 id="什么是容器数据卷"><a href="#什么是容器数据卷" class="headerlink" title="什么是容器数据卷"></a>什么是容器数据卷</h3><p>docker 的理念回顾</p>
<p>将应用和环境打包成一个镜像！</p>
<p>数据！ 如果数据都存在容器中，那么我们把容器删除了，数据就会丢失！！ 需求：数据可以持久化</p>
<p>Mysql容器删了 删库跑路了，！需求：MYSQL数据可以存储在本地</p>
<p>容器之间可以有一个数据共享的技术！docker 容器中产生的数据同步到本地！</p>
<p>这就是卷技术！目录的挂载，将我们容器内的目录挂载到linux 上</p>
<img src="/2021/09/22/Docker-notes/image-20210921035055665.png" alt="image-20210921035055665" style="zoom:150%;">

<p><strong>总结一句话，容器的持久化和同步操作! 容器间也是可以共享的</strong></p>
<h4 id="使用数据卷"><a href="#使用数据卷" class="headerlink" title="使用数据卷"></a>使用数据卷</h4><blockquote>
<p>方式一：直接使用命令来挂载 -v</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -v 主机目录，容器内目录 </span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -it -v /home/ceshi:/home archlinux /bin/bash</span><br><span class="line">[root@6e15453d4aad /]#</span><br><span class="line"><span class="meta">#</span><span class="bash">启动之后我们可以通过docker inspect 容器ID</span> </span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210921040320685.png" alt="image-20210921040320685" style="zoom: 200%;">

<p>测试结果：</p>
<img src="/2021/09/22/Docker-notes/image-20210921041233923.png" alt="image-20210921041233923" style="zoom:150%;">

<p>继续测试：</p>
<ol>
<li>停止容器</li>
<li>在宿主机上修改文件，</li>
<li>再次启动容器</li>
<li>容器内的数据依旧是同步的</li>
</ol>
<img src="/2021/09/22/Docker-notes/image-20210921042016622.png" alt="image-20210921042016622" style="zoom:150%;">

<p><strong>好处：</strong> 我们以后只需要在本地修改即可，容器内部会自动同步！</p>
<h4 id="实战：安装MySQL"><a href="#实战：安装MySQL" class="headerlink" title="实战：安装MySQL"></a>实战：安装MySQL</h4><p>思考：MySQL的数据持久化问题！ data</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">下载获取镜像</span></span><br><span class="line">[proton@proton-pc ~]$ docker pull mysql:5.7</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">运行容器，需要做数据挂在出来 <span class="comment">#安装启动mysql，需要配置密码的，这是需要注意的</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">官方的测试 ：自己去dockerhub上查吧。</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">启动我们的</span></span><br><span class="line">-d 后台运行</span><br><span class="line">-p 端口映射 宿主机Port:容器Port</span><br><span class="line">-v 卷挂载</span><br><span class="line">-e 环境配置</span><br><span class="line">--name 容器名字</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#挂载卷的第1种方式 没有挂载</span></span></span><br><span class="line">docker run -d -p 3310:3306 -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash">测试结果</span></span><br><span class="line">proton@proton-pc ~]$ docker exec -it mysql01 /bin/bash</span><br><span class="line"></span><br><span class="line">docker-entrypoint-initdb.d  lib64  root  tmp</span><br><span class="line">entrypoint.sh               media  run   usr</span><br><span class="line">root@75371f75d00a:/# ls /etc/mysql/</span><br><span class="line">conf.d  my.cnf  my.cnf.fallback  mysql.cnf  mysql.conf.d</span><br><span class="line">root@75371f75d00a:/# ls /etc/mysql/conf.d/</span><br><span class="line">docker.cnf  mysql.cnf  mysqldump.cnf</span><br><span class="line">root@75371f75d00a:/# </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#挂载卷的第2种方式 错误的挂载路径</span></span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql02 mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash">测试结果</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/22/Docker-notes/image-20210921054047460.png" alt="image-20210921054047460"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#挂载卷的第3种方式</span></span>   </span><br><span class="line"><span class="meta">#</span><span class="bash">---错误的挂载路径---</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker run -d -p 3310:3306 -v /home/mysql_1/conf:/etc/mysql -v /home/mysql_1/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql03 mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash">结果</span></span><br><span class="line"></span><br><span class="line">root@6dab0da4b788:/etc# cd mysql/</span><br><span class="line">root@6dab0da4b788:/etc/mysql# ls</span><br><span class="line">root@6dab0da4b788:/etc/mysql# 		#docker 容器下的/etc/mysql 文件被清空了 </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">说明：</span></span><br><span class="line"><span class="meta">#</span><span class="bash">第一个容器 mysql01 没有进行卷挂载，所以在上面的测试结果中的数据就是原始的/etc/mysql/ 展示</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">第二个容器 mysql02 的配置文件挂载错了（待确认），/home/mysql/conf:/etc/mysql/conf.d 这里的关于容器中的mysql的配置文件写错了，挂载的conf.d目录不是配置文件。因为/home/mysql/conf目录是空的，所以卷挂载之后后把容器中的/etc/mysql/conf.d目录清空。</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">第三个容器，mysql02 我把卷挂载是 -v /home/mysql_1/conf:/etc/mysql 会清空容器中的/etc/mysql/ 与第二个容器 mysql02 配置的清空文件的原因一样，因为宿主机的/home/mysql_1/conf是空的 所以把容器中的/etc/mysql/ 清空</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">###正确的方法</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">1、首先把容器中的/etc/mysql/ 的文件复制到宿主机的将要挂载卷的目录/home/mysql_1，</span></span><br><span class="line"><span class="meta">#</span><span class="bash">2、挂载卷 -v /home/mysql_1/conf:/etc/mysql</span> </span><br><span class="line">这样就可以避免清空容器中的文件夹了</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">启动之后，我们载本地使用sqlyog来测试一下</span></span><br><span class="line"><span class="meta">#</span><span class="bash">sqlyog连接到我们的服务器的3310 --------- 3310 和容器内的3306映射，这个时候我们就可以连接上了！</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"></span><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">在本地测试创建一个数据库，查看一下我们映射的路径是否ok</span></span><br></pre></td></tr></table></figure>

<p>假设我们把容器删除掉，发现，我们挂载到本地的数据卷依旧没有丢失，这就实现了容器数据库持久化功能！</p>
<p><img src="/2021/09/22/Docker-notes/image-20210921060249061.png" alt="image-20210921060249061"></p>
<h4 id="具名和匿名挂载"><a href="#具名和匿名挂载" class="headerlink" title="具名和匿名挂载"></a>具名和匿名挂载</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">匿名挂载</span></span><br><span class="line">-v	容器内路径！</span><br><span class="line"></span><br><span class="line">docker run -d  -P --name nginx -v /etc/nginx nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">查看所有的volume 的情况</span></span><br><span class="line">[proton@proton-pc ~]$ docker volume ls</span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     5f83d09c51514204f0602da485db09988af6648d97a944dd370f6e1ae0a12d4e</span><br><span class="line"><span class="meta">#</span><span class="bash">这里发现，这种匿名挂载 我们在 -v 只写了容器内的路径，没有写容器外的路径</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker volume ls</span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     juming-nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">通过 -v 卷名：容器内路径</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d  -P --name nginx02 -v juming-nginx:/etc/nginx nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">查看一下这个卷</span></span><br><span class="line">[proton@proton-pc ~]$ docker volume inspect juming-nginx</span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210921233158543.png" alt="image-20210921233158543" style="zoom:200%;">

<p>所有的docker容器内的卷，没有指定目录的情况下都是在 <strong><code>/var/lib/docker/volume/xxx/_data</code></strong></p>
<p>我们通过具名挂载可以方便的找到一个卷，大多数情况使用 <strong>具名挂载</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">如何确定是具名挂载，还是匿名挂载，还是指定路径挂载</span></span><br><span class="line">-v	容器内路径！	  #匿名挂载</span><br><span class="line">-v 卷名：			#容器内路径</span><br><span class="line">-v /宿主机路径:容器内路径	#指定路径挂载</span><br></pre></td></tr></table></figure>

<p>拓展：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">通过 -v 容器内路径， ro  rw 改变读写权限</span></span><br><span class="line">ro readonly	  #只读</span><br><span class="line">rw read write #可读可写</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">一旦设置了这个容器权限，容器对我们挂载出来的内容就有限定了</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d  -P --name nginx02 -v juming-nginx:/etc/nginx:ro nginx  </span><br><span class="line">[proton@proton-pc ~]$ docker run -d  -P --name nginx02 -v juming-nginx:/etc/nginx:rw nginx  </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">ro 只要看到这个ro就说明这个路径只能通过宿主机来操作，容器内部是无法操作的</span></span><br></pre></td></tr></table></figure>



<h4 id="初识Dockerfile"><a href="#初识Dockerfile" class="headerlink" title="初识Dockerfile"></a>初识Dockerfile</h4><p>Dockerfile 就是用来构建docker 镜像的构建文件！命令脚本！</p>
<p>通过这个脚本可以生成一个镜像。</p>
<p>#测试<br>[proton@proton-pc docker-test-volume]$ vim dockerfile1</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">创建一个dockerfile 文件，名字可以随机，建议 Dockerfile</span></span><br><span class="line"><span class="meta">#</span><span class="bash">文件中的内容 指令（大写） 参数</span></span><br><span class="line"></span><br><span class="line">FROM centos</span><br><span class="line"></span><br><span class="line">VOLUME [&quot;volume01&quot;,&quot;volume02&quot;]</span><br><span class="line"></span><br><span class="line">CMD echo &quot;-----end----&quot;</span><br><span class="line">CMD /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash">这里的每个名令，就是镜像的一层。</span></span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210922000606724.png" alt="image-20210922000606724" style="zoom:150%;">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">启动自己写的镜像</span></span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210922001310644.png" alt="image-20210922001310644" style="zoom:150%;">

<p>这个卷外部一定有一个同步的目录！</p>
<img src="/2021/09/22/Docker-notes/image-20210922002541829.png" alt="image-20210922002541829" style="zoom:150%;">

<p>查看一下卷挂载的路径</p>
<p><img src="/2021/09/22/Docker-notes/image-20210922002120951.png" alt="image-20210922002120951"></p>
<p>测试一下刚才的文件是否同步出去了</p>
<p>这种方式我们未来使用的非常多，因为我们通常会构建自己的镜像！</p>
<p>假设构建的时候没有挂载卷，要手动挂载 -v 卷名:容器内路径</p>
<h4 id="数据卷容器"><a href="#数据卷容器" class="headerlink" title="数据卷容器"></a>数据卷容器</h4><p>多个mysql同步数据</p>
<img src="/2021/09/22/Docker-notes/image-20210922003031848.png" alt="image-20210922003031848" style="zoom:150%;">

<p>#启动3个容器，通过我们刚才自己写的镜像启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc _data]$ docker run -it --name docker01 zsz/centos:1.0 </span><br><span class="line">[proton@proton-pc _data]$ docker run -it --name docker02 --volumes-from docker01 zsz/centos:1.0 </span><br><span class="line">[proton@proton-pc _data]$ docker run -it --name docker03 --volumes-from docker01 zsz/centos:1.0 </span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210922003413944.png" alt="image-20210922003413944" style="zoom:150%;">



<p><img src="/2021/09/22/Docker-notes/image-20210922004130868.png" alt="image-20210922004130868"></p>
<img src="/2021/09/22/Docker-notes/image-20210922004255766.png" alt="image-20210922004255766" style="zoom:150%;">

<p>只要通过 –volumes-from 就可以实现容器间的数据共享</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">测试，可以删除docker01 ，查看一下docker02和docker03是否还可以访问文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash">测试结果依旧可以访问</span></span><br></pre></td></tr></table></figure>



<p><img src="/2021/09/22/Docker-notes/image-20210922005501643.png" alt="image-20210922005501643"></p>
<p>就是拷贝的概念</p>
<p>多个mysql 实现数据共享</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker run -d -p 3310:3306 -e MYSQL_ROOT_PASSWORD=123456 --name mysql02 --volumes-from mysql01 mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash">这个时候可以实现两个容器数据的同步</span></span><br></pre></td></tr></table></figure>

<p><strong>结论：</strong></p>
<p>容器之间的配置信息的传递，数据卷的生命周期一直持续到没有容器使用为止</p>
<p>但是一旦持久化到了本地，这个时候，本地的数据是不会删除的</p>
<h2 id="DockerFile"><a href="#DockerFile" class="headerlink" title="DockerFile"></a>DockerFile</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>Dockerfile 就是用来构建docker 镜像的构建文件！命令脚本！</p>
<p>通过这个脚本可以生成一个镜像。</p>
<p>构建步骤：</p>
<ol>
<li>编写一个dockerfile 文件</li>
<li>docker build 构建一个镜像</li>
<li>docker run 运行镜像</li>
<li>docker push 发布镜像（dockerHub、阿里云镜像仓库）</li>
</ol>
<h3 id="DockerFile-构建过程"><a href="#DockerFile-构建过程" class="headerlink" title="DockerFile 构建过程"></a>DockerFile 构建过程</h3><h4 id="基础指令"><a href="#基础指令" class="headerlink" title="基础指令"></a>基础指令</h4><ol>
<li>每个保留关键字（指令）都必须是大写字母</li>
<li>执行从上到下顺序执行的</li>
<li>#表示注释</li>
<li>每一个指令都会创建一个新的镜像层，并提交。</li>
</ol>
<p><img src="/2021/09/22/Docker-notes/u=1982640279,3003728739&fm=26&fmt=auto.png" alt="https://img2.baidu.com/it/u=1982640279,3003728739&amp;fm=26&amp;fmt=auto"></p>
<p>dockerfile 是面向开发的，我们以后要发布项目，做镜像，就需要编写dockerfile文件，这个文件十分简单！</p>
<p>Docker镜像，逐渐成为了一个企业交付的标准，必须掌握</p>
<p>步骤：开发、部署、运维     缺一不可1</p>
<p>DockerFile : 构建文件，定义了一切的步骤，源代码</p>
<p>DockerImages: 通过DockerFile 构建生成的镜像，最终发布和运行产品</p>
<p>Docker容器： 容器就是镜像运行起来提供服务器。</p>
<h4 id="DockerFile-指令："><a href="#DockerFile-指令：" class="headerlink" title="DockerFile 指令："></a>DockerFile 指令：</h4><p>以前的话，我们用别人的，现在我们知道了这些后，我们来练习自己写一个镜像！！！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">FROM			#基础镜像，一切从这里开始构建</span><br><span class="line">MAINTAINER		#镜像是谁写的，姓名+邮箱</span><br><span class="line">RUN				#镜像构建的时候需要运行的命令</span><br><span class="line">ADD				#步骤，tomcat镜像，这个tomcat压缩包！添加内容</span><br><span class="line">WORKDIR			#镜像的工作目录</span><br><span class="line">VOLUME			#挂载的目录</span><br><span class="line">EXPOSE			#之对外开放的端口</span><br><span class="line">CMD				#指定这个容器启动的时候需要运行的命令，只有最后一个会生效，可被替代。</span><br><span class="line">ENTRYPOINT		#指定这个容器启动的时候运行的命令，可以追加命令</span><br><span class="line">ONBUILD			#当构建一个被继承 DOckerFile 这个就会运行ONBULID 的指令，触发指令</span><br><span class="line">COPY			#类似ADD 将文件拷贝到镜像中</span><br><span class="line">ENV				#构建的时候设置环境变量！</span><br><span class="line">		</span><br></pre></td></tr></table></figure>



<img src="/2021/09/22/Docker-notes/u=3010872685,2996850938&fm=26&fmt=auto.jpeg" alt="点击查看源网页" style="zoom:150%;">

<h4 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h4><p>Docker Hub 中99%的镜像都是从这个基础镜像过来的，FROM scratch,然后配置需要的软件来进行构建</p>
<img src="/2021/09/22/Docker-notes/image-20210922035715666.png" alt="image-20210922035715666" style="zoom:150%;">

<blockquote>
<p>创建一个自己的centos</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1、编写dockerfile的文件</span></span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER zsz&lt;2668838984@qq.com&gt;</span><br><span class="line"></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line"></span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line">RUN yum -y install vim</span><br><span class="line">RUN yum -y install net-tools</span><br><span class="line"></span><br><span class="line">EXPOSE 80</span><br><span class="line">CMD echo $MYPATH</span><br><span class="line"></span><br><span class="line">CMD echo &quot;-----end--------&quot;</span><br><span class="line">CMD /bin/bash</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">2、通过这个文件构建镜像</span></span><br><span class="line"><span class="meta">#</span><span class="bash">命令 docker build -f dockerfile文件路径 -t 镜像名:[tag] 路径</span></span><br><span class="line">Successfully built 66e9e5ddaacb</span><br><span class="line">Successfully tagged mycentos:0.1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">3、测试运行</span></span><br><span class="line">docker </span><br></pre></td></tr></table></figure>

<p>对比测试：</p>
<p>官方的镜像：</p>
<img src="/2021/09/22/Docker-notes/image-20210922042547316.png" alt="image-20210922042547316" style="zoom: 200%;">

<p>我们增加后的镜像</p>
<img src="/2021/09/22/Docker-notes/image-20210922042814743.png" alt="image-20210922042814743" style="zoom:150%;">

<p>我们可以列出本地镜像的变更历史</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker history 镜像ID</span><br></pre></td></tr></table></figure>



<img src="/2021/09/22/Docker-notes/image-20210922043212151.png" alt="image-20210922043212151" style="zoom:150%;">

<p>我们平时拿到一个镜像可以研究一下人家是怎么做的？？？</p>
<blockquote>
<p>CMD 和 ENTRYPOINT 的区别    </p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CMD				#指定这个容器启动的时候需要运行的命令，只有最后一个会生效，可被替代。</span><br><span class="line">ENTRYPOINT		#指定这个容器启动的时候运行的命令，可以追加命令</span><br></pre></td></tr></table></figure>

<p>测试CMD</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">编写dockerfile 文件</span></span><br><span class="line">[proton@proton-pc dockerfile]$ vim dockerfile-cmd-test</span><br><span class="line">FROM centos</span><br><span class="line">CMD [&quot;ls&quot;,&quot;-a&quot;]</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">构建镜像</span></span><br><span class="line">[proton@proton-pc dockerfile]$ docker build -f dockerfile-cmd-test -t cmdtest .</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">run 运行	发现我们的ls -a 命令生效了</span></span><br><span class="line">[proton@proton-pc dockerfile]$ docker run 19232586cb36</span><br><span class="line">.</span><br><span class="line">..</span><br><span class="line">.dockerenv</span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">lost+found</span><br><span class="line">media</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">想追加一个命令 -l  ls -al</span></span><br><span class="line">[proton@proton-pc dockerfile]$ docker run 19232586cb36 -l</span><br><span class="line">docker: Error response from daemon: OCI runtime create failed: container_linux.go:380: starting container process caused: exec: &quot;-l&quot;: executable file not found in $PATH: unknown.</span><br><span class="line">ERRO[0000] error waiting for container: context canceled </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">cmd 的情况下 -l 替换了CMD [<span class="string">&quot;ls&quot;</span>,<span class="string">&quot;-a&quot;</span>] 命令 -l 不是命令所以报错</span></span><br><span class="line">[proton@proton-pc dockerfile]$ docker run 19232586cb36 ls -al</span><br><span class="line">total 56</span><br><span class="line">drwxr-xr-x   1 root root 4096 Sep 21 20:46 .</span><br><span class="line">drwxr-xr-x   1 root root 4096 Sep 21 20:46 ..</span><br><span class="line">-rwxr-xr-x   1 root root    0 Sep 21 20:46 .dockerenv</span><br><span class="line">lrwxrwxrwx   1 root root    7 Nov  3  2020 bin -&gt; usr/bi</span><br><span class="line">[proton@proton-pc dockerfile]$ </span><br></pre></td></tr></table></figure>

<p>测试ENTRYPOINT</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Successfully built 49ec35d65e13</span><br><span class="line">Successfully tagged entrypoint-test:latest</span><br><span class="line">[proton@proton-pc dockerfile]$ docker run 49ec35d65e13</span><br><span class="line">.</span><br><span class="line">..</span><br><span class="line">.dockerenv</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">……</span><br><span class="line">proc</span><br><span class="line">var</span><br><span class="line"><span class="meta">#</span><span class="bash">我们的追加命令，是直接拼接在我们的ENTRYPOINT 之后的</span></span><br><span class="line">[proton@proton-pc dockerfile]$ docker run 49ec35d65e13 -l</span><br><span class="line">total 56</span><br><span class="line">drwxr-xr-x   1 root root 4096 Sep 21 20:51 .</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 home</span><br></pre></td></tr></table></figure>

<p>DockerFile 中很多命令都是十分相似的，我们需要了解它们的区别，我们最好学习的方式就是对比他们然后测试效果！！！</p>
<h4 id="实战：Tomcate"><a href="#实战：Tomcate" class="headerlink" title="实战：Tomcate"></a>实战：Tomcate</h4><ol>
<li><p>准备镜像文件tomcat 压缩包，jdk压缩包！</p>
</li>
<li><p>编写dockerfile文件  官方命名 Dockerfile build会自动寻找这个文件，就不需要-f 指定了！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">vim Dockerfile </span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER ZSZ&lt;2668838984@qq.com&gt;</span><br><span class="line">COPY readme.txt /usr/local/readme.txt</span><br><span class="line"></span><br><span class="line">ADD jdk-8u11-linux-64.tar.gz /usr/local/</span><br><span class="line">ADD apache-tomcat-9.022.tar.gz /usr/local/</span><br><span class="line"></span><br><span class="line">RUN yum -y nstall vim </span><br><span class="line">EVN MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line">ENV JAVA_HOME /usr/local/jdk1.8.0_11</span><br><span class="line">ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line">ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.22</span><br><span class="line">ENV CATALINA_BASH /usr/local/apache-tomcat-9.0.22</span><br><span class="line">ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin</span><br><span class="line"></span><br><span class="line">EXPOSE 8080</span><br><span class="line"></span><br><span class="line">CMD /usr/local/apache-tomcat-9.0.22/bin/startup.sh &amp;&amp; tail -F /usr/local/apache-tomcat-9.0.22/bin/logs/catalina.out</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>构建镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t diytomcat .</span><br></pre></td></tr></table></figure></li>
<li><p>启动镜像</p>
</li>
<li><p>访问测试</p>
</li>
<li><p>发布项目（由于做了卷挂载，我们直接本地编写项目）</p>
</li>
</ol>
<p>发现，项目部署成功，可以直接访问ok!</p>
<p>我们以后开发的步骤：需要掌握 Dockerfile 的编写，！我们之后的一切都是使用docker镜像发布运行。</p>
<h4 id="发布自己的镜像"><a href="#发布自己的镜像" class="headerlink" title="发布自己的镜像"></a>发布自己的镜像</h4><blockquote>
<p>DockerHub</p>
</blockquote>
<ol>
<li><p>注册账号 地址dockerhub</p>
</li>
<li><p>确定这个账号可以登录</p>
</li>
<li><p>在我们的服务器上提交自己的镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc dockerfile]$ docker login --help</span><br><span class="line"></span><br><span class="line">Usage:  docker login [OPTIONS] [SERVER]</span><br><span class="line"></span><br><span class="line">Log in to a Docker registry.</span><br><span class="line">If no server is specified, the default is defined by the daemon.</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -p, --password string   Password</span><br><span class="line">      --password-stdin    Take the password from stdin</span><br><span class="line">  -u, --username string   Username</span><br><span class="line">[proton@proton-pc dockerfile]$ </span><br></pre></td></tr></table></figure></li>
<li><p>登录完成之后就可以提交镜像了，就是一步，docker push </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker login -u zsz</span><br><span class="line">password:*********</span><br><span class="line"></span><br><span class="line">login succeeded</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">push 自己的镜像到服务器上</span></span><br><span class="line"><span class="meta">#</span><span class="bash">这个命令有问题，再去测试</span></span><br><span class="line">docker push diytomcat</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<p>提交也是按照镜像的层级来的</p>
<blockquote>
<p>阿里云镜像服务上</p>
</blockquote>
<ol>
<li>登录阿里云</li>
<li>找到容器镜像服务</li>
<li>创建命名空</li>
<li>创建容器镜像</li>
<li>浏览一下信息</li>
</ol>
<p>阿里云容器镜像就参考官方地址！！！</p>
<h4 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h4><p><img src="Docker-notes/src=http://www.itdaan.com/i/815ca090f9f8f6360ec657afbe5118b41.jpg&refer=http://www.itdaan.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg" alt="点击查看源网页"></p>
<h2 id="Docker-网络"><a href="#Docker-网络" class="headerlink" title="Docker 网络"></a>Docker 网络</h2><h3 id="理解网络-docker0"><a href="#理解网络-docker0" class="headerlink" title="理解网络 docker0"></a>理解网络 docker0</h3><p>清空所有镜像与容器</p>
<blockquote>
<p>测试</p>
</blockquote>
<p><img src="/2021/09/22/Docker-notes/image-20210922170008938.png" alt="image-20210922170008938"></p>
<p>三个网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">问题： docker 是如何处理容器网络访问的？？</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/22/Docker-notes/image-20210922170345497.png" alt="image-20210922170345497"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker run -d -P --name tomcat01 tomcat</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看容器内部网络地址 ip addr 发现容器启动的时候会得到一个 ip 地址 这个是docker 分配的，</span></span><br><span class="line"><span class="meta">#</span><span class="bash">新版的tomcat 没有net-tools</span></span><br><span class="line"><span class="meta">#</span><span class="bash">进入容器</span></span><br><span class="line">docker exec -it tomcat01 /bin/bash </span><br><span class="line"><span class="meta">#</span><span class="bash">查看 ip</span></span><br><span class="line">root@9b24dec363f6:/usr/local/tomcat# cat /etc/hosts </span><br><span class="line">127.0.0.1       localhost</span><br><span class="line">::1     localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0 ip6-localnet</span><br><span class="line">ff00::0 ip6-mcastprefix</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line">172.17.0.2      9b24dec363f6</span><br><span class="line"><span class="meta">#</span><span class="bash">更新软件列表</span></span><br><span class="line">root@9b24dec363f6:/usr/local/tomcat# apt-get update</span><br><span class="line"><span class="meta">#</span><span class="bash">安装net-tools</span></span><br><span class="line">root@9b24dec363f6:/usr/local/tomcat# apt install net-tools</span><br><span class="line"><span class="meta">#</span><span class="bash">查看IP 地址</span></span><br><span class="line">root@9b24dec363f6:/usr/local/tomcat# ifconfig </span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.2  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        ether 02:42:ac:11:00:02  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 619  bytes 8707891 (8.3 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 488  bytes 33708 (32.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line">        </span><br><span class="line"><span class="meta">#</span><span class="bash">思考Linux 能不能ping通容器</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ ping 172.17.0.2</span><br><span class="line">PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.351 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.091 ms</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">说明 Linux 可以ping 通 docker 容器内部的网络。</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>原理</p>
</blockquote>
<ol>
<li>每启动一个docker 容器， docker 就会给docker 容器分配一个IP， 我们只要安装一个docker ,就会有一个网卡 docker0 使用的是桥接模式 ，使用的技术是 evth-pair 技术！</li>
</ol>
<p>再次测试IP addr</p>
<p><img src="/2021/09/22/Docker-notes/image-20210922174354239.png" alt="image-20210922174354239"></p>
<ol start="2">
<li>再启动一个tomcat 容器测试，发现又多了一对网卡</li>
</ol>
<p><img src="/2021/09/22/Docker-notes/image-20210922174753326.png" alt="image-20210922174753326"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">我们发现这个容器带来的网卡都是一对一对的</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> evth-pair 就是一对虚拟设备接口，他们都是成对出现的，一段连接协议，一段彼此相连</span></span><br><span class="line"><span class="meta">#</span><span class="bash">正是因为这个特性 evth-pair 相当于一个桥梁，它是专门用来连接各种虚拟设备的</span></span><br><span class="line"><span class="meta">#</span><span class="bash">OpenStac 、docker 容器之间的连接，OVS 的连接，都是使用的evth-pair技术</span></span><br></pre></td></tr></table></figure>

<p>3、我们接下来测试tomcat01 ping tomcat02 ？？    </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">进入tomcat02 容器</span></span><br><span class="line">root@e7eb33e45dd4:/usr/local/tomcat# ping 172.17.0.2               </span><br><span class="line">PING 172.17.0.2 (172.17.0.2): 56 data bytes</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=0 ttl=64 time=0.383 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.105 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=7 ttl=64 time=0.127 ms</span><br><span class="line">^C--- 172.17.0.2 ping statistics ---</span><br><span class="line">8 packets transmitted, 8 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.105/0.150/0.383/0.089 ms</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">结论： 容器和容器之间是可以互相ping通的！</span></span><br></pre></td></tr></table></figure>



<img src="/2021/09/22/Docker-notes/image-20210922182425146.png" alt="image-20210922182425146" style="zoom:150%;">

<p>结论： tomcat01 和 tomcat02 是公用一个路由器，docker0;</p>
<p>所有的容器不指定网路的情况下，都是由docker0路由的，docker会给我们的容器分配一个默认的可用IP</p>
<ol start="255">
<li>255.0.1/16 域 局域网</li>
</ol>
<blockquote>
<p>小结</p>
</blockquote>
<p>Docker 使用的是Linux 的桥接，宿主机中是一个docker容器的网桥 docker0。</p>
<p><img src="/2021/09/22/Docker-notes/image-20210922183605111.png" alt="image-20210922183605111"></p>
<p>Docker 中的所有的网络接口都是虚拟的，虚拟转发效率高！（内网传递文件）</p>
<p>只要容器删除，对应的网桥就没有了</p>
<h3 id="容器互联-–link"><a href="#容器互联-–link" class="headerlink" title="容器互联 –link"></a>容器互联 –link</h3><blockquote>
<p>思考一个场景， 我们编写一个微服，database url=ip: ,项目不重启，数据库IP换掉了，我们希望可以处理这个问题，可以通过名字来进行访问容器？？？？</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat01 ping tomcat02    </span><br><span class="line">ping: unknown host</span><br><span class="line"><span class="meta">#</span><span class="bash">如何解决？？</span></span><br><span class="line"><span class="meta">#</span><span class="bash">通过 --link 就可以解决网络联通的问题</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d -P --name tomcat03 --link tomcat02 tomcat  </span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat03 ping tomcat02                   </span><br><span class="line">PING tomcat02 (172.17.0.3): 56 data bytes</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=0 ttl=64 time=0.510 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=1 ttl=64 time=0.130 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=2 ttl=64 time=0.106 ms</span><br><span class="line">^C--- tomcat02 ping statistics ---</span><br><span class="line">3 packets transmitted, 3 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.106/0.249/0.510/0.185 ms</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">反向可以ping通吗？？？</span></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat02 ping tomcat03 </span><br><span class="line">ping: unknown host</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>探究： docker network inspect ID</p>
<p><img src="/2021/09/22/Docker-notes/image-20210922201024440.png" alt="image-20210922201024440"></p>
<p><img src="/2021/09/22/Docker-notes/image-20210922201150647.png" alt="image-20210922201150647"></p>
<p>其实这个tomcat03 就是在本地配置了tomcat02 的配置？？ </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看hosts 配置， 在这里发现原理</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat03 cat /ect/hosts</span><br><span class="line">cat: /ect/hosts: No such file or directory</span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat03 cat /etc/hosts</span><br><span class="line">127.0.0.1       localhost</span><br><span class="line">::1     localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0 ip6-localnet</span><br><span class="line">ff00::0 ip6-mcastprefix</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line">172.17.0.3      tomcat02 cb107366b64d</span><br><span class="line">172.17.0.4      31926070ae2f</span><br></pre></td></tr></table></figure>

<p>本质探究：–link 就是我们在hosts中增加了一个172.17.0.3 tomcat02 cb107366b64d</p>
<p>我们现在玩docker 已经不建议使用 –link了</p>
<p>自定义网路！不适用于docker0!</p>
<p>docker0的问题：他不支持容器名连接访问！</p>
<h3 id="自定义网络："><a href="#自定义网络：" class="headerlink" title="自定义网络："></a>自定义网络：</h3><p>好处:</p>
<p>redis -不同的集群使用不同的网络，保证集群的安全和健康</p>
<p>mysql-不同的集群使用不同的网络，保证集群的安全和健康</p>
<p>也可以实现容器互联；</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker network --help</span><br><span class="line"></span><br><span class="line">Usage:  docker network COMMAND</span><br><span class="line"></span><br><span class="line">Manage networks</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  connect     Connect a container to a network</span><br><span class="line">  create      Create a network</span><br><span class="line">  disconnect  Disconnect a container from a network</span><br><span class="line">  inspect     Display detailed information on one or more networks</span><br><span class="line">  ls          List networks</span><br><span class="line">  prune       Remove all unused networks</span><br><span class="line">  rm          Remove one or more networks</span><br><span class="line"></span><br><span class="line">Run &#x27;docker network COMMAND --help&#x27; for more information on a command.</span><br><span class="line">[proton@proton-pc ~]$ </span><br></pre></td></tr></table></figure>

<blockquote>
<p>查所有网络docker network ls</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">7e7119e437a1   bridge    bridge    local</span><br><span class="line">dd4111e98dbc   host      host      local</span><br><span class="line">9820f0ae0444   none      null      local</span><br></pre></td></tr></table></figure>

<p>网络模式</p>
<ul>
<li><p>bridge : 桥接模式 docker  （默认， 自己创建也是用桥接模式）</p>
</li>
<li><p>none :不配置网络</p>
</li>
<li><p>host : 和宿主机共享网络</p>
</li>
<li><p>container : 容器网络联通！（用的少，局限大）</p>
</li>
</ul>
<p><strong>测试：</strong> </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">我们直接启动的命令 --net bridge ,而这个就是我们的docker0</span></span><br><span class="line">docker run -d -P --name tomcat01 tomcat</span><br><span class="line">docker run -d -P --name tomcat01 --net bridge tomcat</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">docker0 特点，默认的，域名不能访问， --link 可以打通连接</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">我们可以自定义一个网络！</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> --driver bridge</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> --subnet 192.168.0.0/16    <span class="comment">#192.168.0.2 192.168.255.255</span></span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> --gateway 192.168.0.1</span> </span><br><span class="line">[proton@proton-pc ~]$ docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span><br><span class="line">0fc624118477c649a92f54dd7436a7660393bf458a0325eb88cf7e9e02b9d9b4</span><br><span class="line">[proton@proton-pc ~]$ docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">7e7119e437a1   bridge    bridge    local</span><br><span class="line">dd4111e98dbc   host      host      local</span><br><span class="line">0fc624118477   mynet     bridge    local</span><br><span class="line">9820f0ae0444   none      null      local</span><br><span class="line">[proton@proton-pc ~]$ </span><br></pre></td></tr></table></figure>

<p>自己的网络就创建好了：</p>
<p><img src="/2021/09/22/Docker-notes/image-20210922204544768.png" alt="image-20210922204544768"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker run -d -P --name tomcat-net-01 --net mynet tomcat </span><br><span class="line">44e243fdf98ef7d7cdd334b639a94982fb2dfb50c15d0f1b0ab92b9b082c945d</span><br><span class="line">[proton@proton-pc ~]$ docker run -d -P --name tomcat-net-02 --net mynet tomcat  </span><br><span class="line">8704e3136780c17fe025699cf81b91732451dee3881424cb7640f4ce710dc374</span><br><span class="line">[proton@proton-pc ~]$ docker network inspect mynet</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;mynet&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;0fc624118477c649a92f54dd7436a7660393bf458a0325eb88cf7e9e02b9d9b4&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2021-09-22T20:41:10.237228394+08:00&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;192.168.0.1&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: false,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;</span><br><span class="line">            &quot;44e243fdf98ef7d7cdd334b639a94982fb2dfb50c15d0f1b0ab92b9b082c945d&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat-net-01&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;0e75ea84d2ecbc212b4c31e7e406f1a14012d295b81be0db444ce6195cabe8c0&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:02&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.2/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;8704e3136780c17fe025699cf81b91732451dee3881424cb7640f4ce710dc374&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat-net-02&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;a6e557c77424548b61a9e8f86dd2073475a52883c8263a3a4be8fb4975979a00&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:03&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.3/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>再次测试ping 连接</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">也可以ping 名字了</span></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it  tomcat-net-01 ping tomcat-net-02            </span><br><span class="line">PING tomcat-net-02 (192.168.0.3): 56 data bytes</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=0 ttl=64 time=0.591 ms</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=1 ttl=64 time=0.236 ms</span><br><span class="line">^C--- tomcat-net-02 ping statistics ---</span><br><span class="line">2 packets transmitted, 2 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.236/0.413/0.591/0.178 ms</span><br><span class="line">[proton@proton-pc ~]$ docker exec -it  tomcat-net-02 ping tomcat-net-01 </span><br><span class="line">PING tomcat-net-01 (192.168.0.2): 56 data bytes</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=0 ttl=64 time=0.117 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=1 ttl=64 time=0.146 ms</span><br><span class="line">^C--- tomcat-net-01 ping statistics ---</span><br><span class="line">2 packets transmitted, 2 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.117/0.132/0.146/0.000 ms</span><br><span class="line">[proton@proton-pc ~]$ </span><br></pre></td></tr></table></figure>

<p>我们自定义的网络，docker都已经帮我们维护好对应的关系了，推荐平时使用自定义的网络！</p>
<h3 id="网络连通"><a href="#网络连通" class="headerlink" title="网络连通"></a>网络连通</h3><p><img src="/2021/09/22/Docker-notes/image-20210922210349538.png" alt="image-20210922210349538"></p>
<p>[proton@proton-pc ~]$ docker exec -it tomcat01 apt-get update    </p>
<p>[proton@proton-pc ~]$ docker exec -it tomcat01 apt-get install inetutils-ping</p>
<img src="/2021/09/22/Docker-notes/image-20210922211146558.png" alt="image-20210922211146558" style="zoom:150%;">

<img src="/2021/09/22/Docker-notes/image-20210922211251148.png" alt="image-20210922211251148" style="zoom:150%;">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">测试打通，tomcat01 到tomcat-net-01</span></span><br><span class="line"><span class="meta">#</span><span class="bash">联通之后就是将我的tomcat01 加入到我们mynet中</span></span><br><span class="line"><span class="meta">#</span><span class="bash">一个容器两个IP</span> </span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/22/Docker-notes/image-20210922211606405.png" alt="image-20210922211606405"></p>
<p>测试：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker network connect mynet tomcat01</span><br><span class="line">[proton@proton-pc ~]$ docker network inspect mynet</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat01 ping tomcat-net-01</span><br><span class="line">PING tomcat-net-01 (192.168.0.2): 56 data bytes</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=0 ttl=64 time=0.648 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=1 ttl=64 time=0.140 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=2 ttl=64 time=0.118 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=3 ttl=64 time=0.269 ms</span><br><span class="line">^C--- tomcat-net-01 ping statistics ---</span><br><span class="line">4 packets transmitted, 4 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.118/0.294/0.648/0.213 ms</span><br><span class="line">[proton@proton-pc ~]$ </span><br></pre></td></tr></table></figure>

<p>假设需要跨网络操作别人的容器，就需要使用docker network connect  联通。</p>
<h3 id="实战：部署Redis集群"><a href="#实战：部署Redis集群" class="headerlink" title="实战：部署Redis集群"></a>实战：部署Redis集群</h3><p><img src="/2021/09/22/Docker-notes/image-20210922212314218.png" alt="image-20210922212314218"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">for port in $(seq 1 6); \</span><br><span class="line">do \</span><br><span class="line">mkdir -p /mydata/redis/node-$&#123;port&#125;/conf</span><br><span class="line">touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">cat &lt;&lt;EOF&gt;&gt; &gt;/mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">port 6379 </span><br><span class="line">bind 0.0.0.0</span><br><span class="line">cluster-enabled yes </span><br><span class="line">cluster-config-file nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">cluster-announce-ip 172.38.0.1$&#123;port&#125;</span><br><span class="line">cluster-announce-port 6379</span><br><span class="line">cluster-announce-bus-port 16379</span><br><span class="line">appendonly yes</span><br><span class="line">EOF </span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">==P38，创建redis集群==</span><br><span class="line">==创建配置文件===</span><br><span class="line">for port in $(seq 1 6); \</span><br><span class="line">do \</span><br><span class="line">mkdir -p /mydata/redis/node-$&#123;port&#125;/conf</span><br><span class="line">touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">cat &lt;&lt; EOF &gt; /mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">port 6379</span><br><span class="line">bind 0.0.0.0</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">cluster-announce-ip 172.38.0.1$&#123;port&#125;</span><br><span class="line">cluster-announce-port 6379</span><br><span class="line">cluster-announce-bus-port 16379</span><br><span class="line">appendonly yes</span><br><span class="line">EOF</span><br><span class="line">done</span><br><span class="line">== 启动容器===</span><br><span class="line">for port in $(seq 1 6); \</span><br><span class="line">do \</span><br><span class="line">docker run -p 637$&#123;port&#125;:6379 -p 1637$&#123;port&#125;:16379 --name redis-$&#123;port&#125; \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/data:/data \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/conf/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-d --net redis --ip 172.38.0.1$&#123;port&#125; redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf; \</span><br><span class="line">done</span><br><span class="line">==进入其中一个容器===</span><br><span class="line">docker exec -it redis-1 /bin/sh</span><br><span class="line">==创建集群===</span><br><span class="line">redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1</span><br><span class="line">==亲测有效===​</span><br></pre></td></tr></table></figure>





<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">/data # redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.</span><br><span class="line">14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing <span class="built_in">hash</span> slots allocation on 6 nodes...</span></span><br><span class="line">Master[0] -&gt; Slots 0 - 5460</span><br><span class="line">Master[1] -&gt; Slots 5461 - 10922</span><br><span class="line">Master[2] -&gt; Slots 10923 - 16383</span><br><span class="line">Adding replica 172.38.0.15:6379 to 172.38.0.11:6379</span><br><span class="line">Adding replica 172.38.0.16:6379 to 172.38.0.12:6379</span><br><span class="line">Adding replica 172.38.0.14:6379 to 172.38.0.13:6379</span><br><span class="line">M: 4ab2c4555828c6afd1c9d28791136cf978846e65 172.38.0.11:6379</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">M: 1521df6023a8397536c116d7ce52563a9002500f 172.38.0.12:6379</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">M: e6a9c3eddf3f70d3923c4f26b27a2bad5842e955 172.38.0.13:6379</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">S: 7344ab5a672a9aed3545fb244ff38ac3058ef3b4 172.38.0.14:6379</span><br><span class="line">   replicates e6a9c3eddf3f70d3923c4f26b27a2bad5842e955</span><br><span class="line">S: 472ac217c6029ffe0316c6e005f455320c2850a5 172.38.0.15:6379</span><br><span class="line">   replicates 4ab2c4555828c6afd1c9d28791136cf978846e65</span><br><span class="line">S: c9226bdd06b7c63a6917710d791f3d58f485a7a2 172.38.0.16:6379</span><br><span class="line">   replicates 1521df6023a8397536c116d7ce52563a9002500f</span><br><span class="line">Can I set the above configuration? (type &#x27;yes&#x27; to accept): yes</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Nodes configuration updated</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Assign a different config epoch to each node</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Sending CLUSTER MEET messages to join the cluster</span></span><br><span class="line">Waiting for the cluster to join</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 172.38.0.11:6379)</span></span><br><span class="line">M: 4ab2c4555828c6afd1c9d28791136cf978846e65 172.38.0.11:6379</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 1521df6023a8397536c116d7ce52563a9002500f 172.38.0.12:6379</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: c9226bdd06b7c63a6917710d791f3d58f485a7a2 172.38.0.16:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 1521df6023a8397536c116d7ce52563a9002500f</span><br><span class="line">S: 7344ab5a672a9aed3545fb244ff38ac3058ef3b4 172.38.0.14:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates e6a9c3eddf3f70d3923c4f26b27a2bad5842e955</span><br><span class="line">M: e6a9c3eddf3f70d3923c4f26b27a2bad5842e955 172.38.0.13:6379</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 472ac217c6029ffe0316c6e005f455320c2850a5 172.38.0.15:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 4ab2c4555828c6afd1c9d28791136cf978846e65</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check <span class="keyword">for</span> open slots...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check slots coverage...</span></span><br><span class="line">[OK] All 16384 slots covered.</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">docker</span> </span><br></pre></td></tr></table></figure>



<h3 id="SpringBoot-微服务"><a href="#SpringBoot-微服务" class="headerlink" title="SpringBoot 微服务"></a>SpringBoot 微服务</h3><p>企业实战</p>
<p>docker compose</p>
<p>docker Swarm</p>
<p>CI/CD jenkins 流水线！！</p>
<h1 id="Docker-参考手册"><a href="#Docker-参考手册" class="headerlink" title="Docker 参考手册"></a>Docker 参考手册</h1><h2 id="Docker-命令大全"><a href="#Docker-命令大全" class="headerlink" title="Docker 命令大全"></a>Docker 命令大全</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"> #</span><span class="bash">容器生命周期管理</span></span><br><span class="line"></span><br><span class="line">    run</span><br><span class="line">    start/stop/restart</span><br><span class="line">    kill</span><br><span class="line">    rm</span><br><span class="line">    pause/unpause</span><br><span class="line">    create</span><br><span class="line">    exec</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">容器操作</span></span><br><span class="line"></span><br><span class="line">    ps</span><br><span class="line">    inspect</span><br><span class="line">    top</span><br><span class="line">    attach</span><br><span class="line">    events</span><br><span class="line">    logs</span><br><span class="line">    wait</span><br><span class="line">    export</span><br><span class="line">    port</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">容器rootfs命令</span></span><br><span class="line"></span><br><span class="line">    commit</span><br><span class="line">    cp</span><br><span class="line">    diff</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">镜像仓库</span></span><br><span class="line"></span><br><span class="line">    login</span><br><span class="line">    pull</span><br><span class="line">    push</span><br><span class="line">    search</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">本地镜像管理</span></span><br><span class="line"></span><br><span class="line">    images</span><br><span class="line">    rmi</span><br><span class="line">    tag</span><br><span class="line">    build</span><br><span class="line">    history</span><br><span class="line">    save</span><br><span class="line">    load</span><br><span class="line">    import</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">info|version</span></span><br><span class="line"></span><br><span class="line">    info</span><br><span class="line">    version</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Docker-资源汇总"><a href="#Docker-资源汇总" class="headerlink" title="Docker 资源汇总"></a>Docker 资源汇总</h2><h3 id="Docker-资源"><a href="#Docker-资源" class="headerlink" title="Docker 资源"></a>Docker 资源</h3><ul>
<li>Docker 官方主页: <a target="_blank" rel="noopener" href="https://www.docker.com/">https://www.docker.com</a></li>
<li>Docker 官方博客: <a target="_blank" rel="noopener" href="https://blog.docker.com/">https://blog.docker.com/</a></li>
<li>Docker 官方文档: <a target="_blank" rel="noopener" href="https://docs.docker.com/">https://docs.docker.com/</a></li>
<li>Docker Store: <a target="_blank" rel="noopener" href="https://store.docker.com/">https://store.docker.com</a></li>
<li>Docker Cloud: <a target="_blank" rel="noopener" href="https://cloud.docker.com/">https://cloud.docker.com</a></li>
<li>Docker Hub: <a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com</a></li>
<li>Docker 的源代码仓库: <a target="_blank" rel="noopener" href="https://github.com/moby/moby">https://github.com/moby/moby</a></li>
<li>Docker 发布版本历史: <a target="_blank" rel="noopener" href="https://docs.docker.com/release-notes/">https://docs.docker.com/release-notes/</a></li>
<li>Docker 常见问题: <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/faq/">https://docs.docker.com/engine/faq/</a></li>
<li>Docker 远端应用 API: <a target="_blank" rel="noopener" href="https://docs.docker.com/develop/sdk/">https://docs.docker.com/develop/sdk/</a></li>
</ul>
<h3 id="Docker-国内镜像"><a href="#Docker-国内镜像" class="headerlink" title="Docker 国内镜像"></a>Docker 国内镜像</h3><ul>
<li><p>阿里云的加速器：<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/60750.html">https://help.aliyun.com/document_detail/60750.html</a></p>
</li>
<li><p>网易加速器：<a target="_blank" rel="noopener" href="http://hub-mirror.c.163.com/">http://hub-mirror.c.163.com</a></p>
</li>
<li><p>官方中国加速器：<a target="_blank" rel="noopener" href="https://registry.docker-cn.com/">https://registry.docker-cn.com</a></p>
</li>
<li><p>ustc 的镜像：<a target="_blank" rel="noopener" href="https://docker.mirrors.ustc.edu.cn/">https://docker.mirrors.ustc.edu.cn</a></p>
</li>
<li><p>daocloud：<a target="_blank" rel="noopener" href="https://www.daocloud.io/mirror#accelerator-doc%EF%BC%88%E6%B3%A8%E5%86%8C%E5%90%8E%E4%BD%BF%E7%94%A8%EF%BC%89">https://www.daocloud.io/mirror#accelerator-doc（注册后使用）</a></p>
</li>
<li><p>如果有更好的资源，欢迎通过下面的笔记来分享。</p>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/09/13/Archlinu-install-note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zsz">
      <meta itemprop="description" content="不负光阴韶华">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/09/13/Archlinu-install-note/" class="post-title-link" itemprop="url">Archlinu-install-note</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-09-13 06:45:21" itemprop="dateCreated datePublished" datetime="2021-09-13T06:45:21+08:00">2021-09-13</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-05-05 22:42:54" itemprop="dateModified" datetime="2022-05-05T22:42:54+08:00">2022-05-05</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">-- linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>[TOC]</p>
<h1 id="Archlinux-安装笔记"><a href="#Archlinux-安装笔记" class="headerlink" title="Archlinux 安装笔记"></a>Archlinux 安装笔记</h1><h2 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h2><ol>
<li>在使用live系统完成了分区与引导器的安装后，由于我没有安装sudo,dhcpcd导致了我启动系统后无法配置网络，无法连接到网络，无法使用visudo</li>
<li>在发现系统的配置错误后，可以重新通过live镜像进行修改。</li>
<li>为什么那个自由软件者的kde桌面安装教程没有安装xorg</li>
<li>显示主文件磁盘空间不足/分配了10G</li>
<li></li>
</ol>
<h1 id="Arch-Linux-日常使用"><a href="#Arch-Linux-日常使用" class="headerlink" title="Arch Linux 日常使用"></a>Arch Linux 日常使用</h1><h2 id="更新系统"><a href="#更新系统" class="headerlink" title="更新系统"></a>更新系统</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -Syyu    #升级系统中全部包</span><br></pre></td></tr></table></figure>

<h2 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pacman -S package_name1 package_name2 ...</span><br><span class="line">pacman -S --noconfirm  gcc </span><br><span class="line"><span class="meta">#</span><span class="bash"> man pacman 为什么不能使用</span></span><br></pre></td></tr></table></figure>



<h2 id="下载文件"><a href="#下载文件" class="headerlink" title="下载文件"></a>下载文件</h2><h3 id="linux-wget指定下载目录和重命名"><a href="#linux-wget指定下载目录和重命名" class="headerlink" title="linux wget指定下载目录和重命名"></a>linux wget指定下载目录和重命名</h3><p>当我们在使用wget命令下载文件时，通常会需要将文件下载到指定的目录，这时就可以使用 -P 参数来指定目录，如果指定的目录不存在，则会自动创建。</p>
<p>示例：</p>
<p>wget -P /usr/local/src <a target="_blank" rel="noopener" href="http://download.redis.io/releases/redis-4.0.9.tar.gz">http://download.redis.io/releases/redis-4.0.9.tar.gz</a></p>
<p>如果需要对下载的文件进行重命名，则可以通过 -O 参数指定文件名，需要注意的是，如果重命名中包含路径，那么该路径必须实现创建好。</p>
<p>示例：</p>
<p>wget <a target="_blank" rel="noopener" href="http://download.redis.io/releases/redis-4.0.9.tar.gz">http://download.redis.io/releases/redis-4.0.9.tar.gz</a> -O /usr/local/src/redis.tar.gz</p>
<p>经测试 小写的和大写的都可以 但是大写的会显示下载过程 小写的不会</p>
<h2 id="安装激活xmind"><a href="#安装激活xmind" class="headerlink" title="安装激活xmind"></a>安装激活xmind</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">编辑</span><br><span class="line">/etc/environment</span><br><span class="line">添加</span><br><span class="line">VANA_LICENSE_MODE=true</span><br><span class="line">VANA_LIENCE_TO=ZSZ</span><br></pre></td></tr></table></figure>





<h2 id="arch-Linux-安装pip的一种方法"><a href="#arch-Linux-安装pip的一种方法" class="headerlink" title="arch Linux 安装pip的一种方法"></a>arch Linux 安装pip的一种方法</h2><p>文档链接：<a target="_blank" rel="noopener" href="https://pip.pypa.io/en/stable/installation/">https://pip.pypa.io/en/stable/installation/</a></p>
<p>​    </p>
<h3 id="⚠警告"><a href="#⚠警告" class="headerlink" title="⚠警告"></a>⚠警告</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@ae5d7bf3b1fc python_pip]# wget 	https://bootstrap.pypa.io/get-pip.py</span><br><span class="line">[root@ae5d7bf3b1fc python_pip]# python3 ./get-pip.py </span><br><span class="line">Collecting pip</span><br><span class="line">  Downloading pip-21.2.4-py3-none-any.whl (1.6 MB)</span><br><span class="line">     |████████████████████████████████| 1.6 MB 24.0 MB/s </span><br><span class="line">Collecting setuptools</span><br><span class="line">  Downloading setuptools-58.2.0-py3-none-any.whl (946 kB)</span><br><span class="line">     |████████████████████████████████| 946 kB 32.6 MB/s </span><br><span class="line">Collecting wheel</span><br><span class="line">  Downloading wheel-0.37.0-py2.py3-none-any.whl (35 kB)</span><br><span class="line">Installing collected packages: wheel, setuptools, pip</span><br><span class="line">Successfully installed pip-21.2.4 setuptools-58.2.0 wheel-0.37.0</span><br><span class="line">WARNING: Running pip as the &#x27;root&#x27; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv</span><br></pre></td></tr></table></figure>





<p>创建我的archlinux 镜像</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> archlinux</span><br><span class="line"><span class="keyword">MAINTAINER</span> zsz&lt;<span class="number">2668838984</span>@qq.com&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> MYPATH /home</span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> <span class="variable">$MYPATH</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> pacman -Syuu</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> pacman -S python3</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> pacman -S </span></span><br></pre></td></tr></table></figure>



<h2 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">root@d61d4b3a39dc:/migen# python3 ./setup.py </span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;./setup.py&quot;, line 4, in &lt;module&gt;</span><br><span class="line">    from setuptools import setup</span><br><span class="line">ModuleNotFoundError: No module named &#x27;setuptools&#x27;</span><br><span class="line">root@d61d4b3a39dc:/migen# python3 ./setup.py develop --user</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;./setup.py&quot;, line 4, in &lt;module&gt;</span><br><span class="line">    from setuptools import setup</span><br><span class="line">ModuleNotFoundError: No module named &#x27;setuptools&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">安装python3-setuptools</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Ubuntu</span></span></span><br><span class="line">apt-get install python3-setuptools</span><br><span class="line"><span class="meta">#</span><span class="bash">使用脚本安装</span></span><br><span class="line">wget  https://bootstrap.pypa.io/get-pip.py</span><br><span class="line">chmod +x ./get-pip.py</span><br><span class="line">python get-pip.py</span><br><span class="line"></span><br><span class="line">apt-get install python3-pip</span><br><span class="line"><span class="meta">#</span><span class="bash">安装</span></span><br><span class="line">apt-get install verilator</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">archlinux</span></span><br><span class="line">pacman -S python-setuptools</span><br><span class="line"><span class="meta">#</span><span class="bash">这条命令安装后，执行./litex_setup.py init install --user 时出错。 又试了一遍又可以了！！！！</span></span><br><span class="line"><span class="meta">#</span><span class="bash">通过安装pip使用pip install setuptools 后成功安装。</span></span><br></pre></td></tr></table></figure>



<h1 id="ubuntu-更新软件"><a href="#ubuntu-更新软件" class="headerlink" title="ubuntu 更新软件"></a>ubuntu 更新软件</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">apt-get update: 升级安装包相关的命令,刷新可安装的软件列表(但是不做任何实际的安装动作)</span><br><span class="line"></span><br><span class="line">apt-get upgrade: 进行安装包的更新(软件版本的升级)</span><br><span class="line"></span><br><span class="line">apt-get dist-upgrade: 进行系统版本的升级(Ubuntu版本的升级)</span><br><span class="line"></span><br><span class="line">do-release-upgrade: Ubuntu官方推荐的系统升级方式,若加参数-d还可以升级到开发版本,但会不稳定</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -v /home/proton/app/config/config.toml:/app/config --name tsrrr 7bc49bdacfa2 /app/rly -config config/config.toml</span><br><span class="line">docker run -it -v /home/proton/app/config/rly.toml:/bin/rly.toml --name tsdrrr 7bc49bdacfa2 /bin/rly -config config/rly.toml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">在学习docker的时候，经常会编译docker镜像，很多都是基于上一个Dockerfile修改编译而来，因此出现了很多REPOSITORY 和 TAG 为 none 的镜像。每次 docker images 查看镜像，都会列出一长串，有的时候一屏还展示不全，所以就想要删除某些镜像。但是一个一个删又很费时，那就只有批量删除了。</span><br><span class="line">使用 grep 函数查找出所有包含 none 的镜像，然后使用 awk 函数找出所有的镜像ID，并将它们作为参数，使用 docker rmi 命令删除所有包含 none 的镜像。</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查询所有匹配上的docker镜像ID</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker images | grep none | awk <span class="string">&#x27;&#123;print $3&#125;&#x27;</span></span></span><br><span class="line"></span><br><span class="line">docker ps -a | grep 7bc49bdacfa2 | awk &#x27;&#123;print $3&#125;&#x27;</span><br><span class="line">docker images | grep none | awk &#x27;&#123;print $3&#125;&#x27; | xargs docker rmi</span><br><span class="line"></span><br><span class="line">docker ps -a | grep 7bc49bdacfa2 | awk &#x27;&#123;print $1&#125;&#x27;</span><br><span class="line">docker ps -a | grep 7bc49bdacfa2 | awk &#x27;&#123;print $1&#125;&#x27; | xargs docker rm</span><br><span class="line"></span><br><span class="line">docker ps -a | grep e8e9f8df3fbc | awk &#x27;&#123;print $1&#125;&#x27;</span><br><span class="line">docker ps -a | grep e8e9f8df3fbc | awk &#x27;&#123;print $1&#125;&#x27; | xargs docker rm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">docker images | grep jhao104/proxy_pool:latest | awk &#x27;&#123;print $3&#125;&#x27; | xargs docker rmi</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#rly 那个</span></span></span><br><span class="line">apt-get install vim</span><br><span class="line">apt-get install make</span><br><span class="line">apt-get install yarn</span><br><span class="line">apt-get install git</span><br></pre></td></tr></table></figure>



<h1 id="代理搭建proxy-pool"><a href="#代理搭建proxy-pool" class="headerlink" title="代理搭建proxy_pool"></a>代理搭建proxy_pool</h1><p>1、pull docker images</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull jhao104/proxy_pool</span><br></pre></td></tr></table></figure>

<p>2、运行docker 注意这里的docker使用的是外部的redis,需要重新配置本地的redis</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">我第一步运行的是</span> </span><br><span class="line">docker pull jhao104/proxy_pool</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">然后我就运行了</span></span><br><span class="line"><span class="meta">#</span><span class="bash">注意默认的redis没有密码访问：</span></span><br><span class="line">docker run --env DB_CONN=redis://@173.82.54.177:6379/0 -p 5010:5010 jhao104/proxy_pool:latest</span><br></pre></td></tr></table></figure>


<h1 id="ubuntu-16-04-安装python3-6后无法打开终端"><a href="#ubuntu-16-04-安装python3-6后无法打开终端" class="headerlink" title="ubuntu 16.04 安装python3.6后无法打开终端"></a>ubuntu 16.04 安装python3.6后无法打开终端</h1><p>安装python3.6后 快捷键Ctrl+alt+T不行，在Applications里面点击图标也打不开：<br>##参考链接<br>安装python3.6 <a target="_blank" rel="noopener" href="https://tding.top/archives/3868725a.html">https://tding.top/archives/3868725a.html</a><br>解决参考连接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39717318/article/details/111447840">https://blog.csdn.net/weixin_39717318/article/details/111447840</a></p>
<ol>
<li> ctrl+alt+f1 ，输入gnome-terminal，查看无法启动的错误原因</li>
</ol>
<p>$ gnome-terminal</p>
<ol start="2">
<li>提示错误信息如下：Traceback (most recent call last):</li>
</ol>
<p>File “/usr/bin/gnome-terminal”, line 9, in</p>
<p>from gi.repository import GLib, Gio</p>
<p>File “/usr/lib/python3/dist-packages/gi/<strong>init</strong>.py”, line 42, in</p>
<p>from . import _gi</p>
<p>ImportError: cannot import name ‘_gi’</p>
<ol start="3">
<li>查找_gi的库文件$ ls -la /usr/lib/python3/dist-packages/gi/</li>
</ol>
<p>_gi_cairo.cpython-35m-x86_64-Linux-gnu.so</p>
<p>_gi.cpython-35m-x86_64-Linux-gnu.so</p>
<p>……..</p>
<ol start="4">
<li>复制一份3.6使用的库文件</li>
</ol>
<p>$ cd /usr/lib/python3/dist-packages/gi/</p>
<p>$ sudo cp _gi.cpython-35m-x86_64-Linux-gnu.so _gi.cpython-36m-x86_64-Linux-gnu.so</p>
<p>$ sudo cp _gi_cairo.cpython-35m-x86_64-Linux-gnu.so _gi_cairo.cpython-36m-x86_64-Linux-gnu.so</p>
<p>注意：<br>最后，还要注意一下，你的python3是安装在哪里的：</p>
<p>看看python3装在哪儿<br>由于我的python3.6的位置原因需要将gi/文件夹拷贝到<br>/usr/local/python3.6/lib/python3.6/site-packages/</p>
<p>所以需要：sudo cp -fr /usr/lib/python3/dist-packages/gi/ /usr/local/python3.6/lib/python3.6/site-packages/</p>
<ol>
<li>alt+ctrl+f7返回，重新尝试打开终端，问题解决</li>
</ol>
<h2 id="从源代码安装Python-3-6之后，没有名为“-lsb-release”的模块"><a href="#从源代码安装Python-3-6之后，没有名为“-lsb-release”的模块" class="headerlink" title="从源代码安装Python 3.6之后，没有名为“ lsb_release”的模块"></a>从源代码安装Python 3.6之后，没有名为“ lsb_release”的模块</h2><p>注意由于我的python3.6所在的位置是/usr/local/python3.6</p>
<p>通过 sys.path 找到了我的路径是<br>/usr/local/python3.6/lib/python3.6/site-packages<br>所以</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /usr/share/pyshared/lsb_release.py /usr/local/python3.6/lib/python3.6/site-packages/lsb_release.py</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">说明：</span><br><span class="line"></span><br><span class="line">我们可以看到 /usr/bin/lsb_release</span><br><span class="line"></span><br><span class="line">#!/usr/bin/python3 -Es</span><br><span class="line"></span><br><span class="line"># lsb_release command for Debian</span><br><span class="line"># (C) 2005-10 Chris Lawrence &lt;lawrencc@debian.org&gt;</span><br><span class="line">#    This package is free software; you can redistribute it and/or modify</span><br><span class="line">#    it under the terms of the GNU General Public License as published by</span><br><span class="line">#    the Free Software Foundation; version 2 dated June, 1991.</span><br><span class="line">#    This package is distributed in the hope that it will be useful,</span><br><span class="line">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="line">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><br><span class="line">#    GNU General Public License for more details.</span><br><span class="line">#    You should have received a copy of the GNU General Public License</span><br><span class="line">#    along with this package; if not, write to the Free Software</span><br><span class="line">#    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA</span><br><span class="line">#    02110-1301 USA</span><br><span class="line">from optparse import OptionParser</span><br><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">import lsb_release</span><br><span class="line"></span><br><span class="line">关键步骤是import lsb_release，但是问题是Python 3.6没有此模块。</span><br><span class="line"></span><br><span class="line">因此，您必须已覆盖python3从python3.5到python3.6。这就是为什么你lsb_release坏了。</span><br><span class="line"></span><br><span class="line">要进行验证，我们可以在中看到python3.6：</span><br><span class="line"></span><br><span class="line">➜  ~ python3.6 </span><br><span class="line">Python 3.6.4 (default, Feb  6 2018, 16:57:12) </span><br><span class="line">[GCC 5.4.0 20160609] on linux</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; import lsb_release</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">ModuleNotFoundError: No module named &#x27;lsb_release&#x27;</span><br><span class="line"></span><br><span class="line">然后在python3.5：</span><br><span class="line"></span><br><span class="line">➜  ~ python3.5</span><br><span class="line">Python 3.5.2 (default, Nov 23 2017, 16:37:01) </span><br><span class="line">[GCC 5.4.0 20160609] on linux</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; import lsb_release</span><br><span class="line">&gt;&gt;&gt; lsb_release.__file__</span><br><span class="line">&#x27;/usr/lib/python3/dist-packages/lsb_release.py&#x27;</span><br><span class="line"></span><br><span class="line">该文件在哪里：</span><br><span class="line"></span><br><span class="line">➜  ~ ll /usr/lib/python3/dist-packages/lsb_release.py</span><br><span class="line">lrwxrwxrwx 1 root root 38 Jul   7  2016 /usr/lib/python3/dist-packages/lsb_release.py -&gt; ../../../share/pyshared/lsb_release.py</span><br><span class="line"></span><br><span class="line">因此，此模块lsb_release存在于中，python3.5但不存在于中python3.6。我们最终找到了它！</span><br><span class="line"></span><br><span class="line">现在，通过添加到原始lsb_release.py文件的链接来修复它！</span><br><span class="line"></span><br><span class="line">这个对我有用！</span><br></pre></td></tr></table></figure>

<h1 id="archlinux-访问win10共享文件夹"><a href="#archlinux-访问win10共享文件夹" class="headerlink" title="archlinux 访问win10共享文件夹"></a>archlinux 访问win10共享文件夹</h1><p>首先使用archlinux ping 通win</p>
<p>2、 在archlinux的文件管理中，打开一个网络的位置，选择smb的输入</p>
<p>smb://192.168.1.6然后会提示你输入账号与密码，账号是win下，微软账号，或者是本地账号，密码是对应账号的密码。</p>
<p>然后就可以访问win下共享的文件夹了</p>
<h1 id="Archlinux-安装Matlab2018a"><a href="#Archlinux-安装Matlab2018a" class="headerlink" title="Archlinux 安装Matlab2018a"></a>Archlinux 安装Matlab2018a</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ol>
<li><p>在百度网盘下载两个两个iso文件，然后将他们解压到同一个文件夹下，复制到archlinux 中，还有要复制crack文件</p>
</li>
<li><p>进入复制到archlinux中的matlab的安装文件夹，打开终端，</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo ./install</span><br><span class="line"><span class="comment">#以管理员的身份进行安装</span></span><br></pre></td></tr></table></figure></li>
<li><p>选择使用文件安装密钥</p>
<p><img src="/2021/09/13/Archlinu-install-note/image-20220505210655117.png" alt="image-20220505210655117"></p>
</li>
<li><p>点击下一步，点击同意条款，点击下一步</p>
</li>
<li><p>提供安装密钥，这个密钥在crack压缩包里，我们打开压缩包</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir crack</span><br><span class="line">tar -xzvf ./matlabxxxxxxcrack.tar.gz ./crack</span><br><span class="line"><span class="built_in">cd</span> ./crack </span><br><span class="line"><span class="comment">#在解压的文件夹中有一个叫readme.txt的文件</span></span><br><span class="line"><span class="comment">#使用</span></span><br></pre></td></tr></table></figure>



<p><img src="/2021/09/13/Archlinu-install-note/image-20220505210808581.png" alt="image-20220505210808581"></p>
<p>使用这一个密钥</p>
<p><img src="/2021/09/13/Archlinu-install-note/image-20220505211507450.png" alt="image-20220505211507450"></p>
</li>
<li><p>选择安装目录，我选择安装在<code>/opt/MATLAB</code>下</p>
</li>
<li><p>后面就是一直下一步，下一步安装就好了</p>
</li>
<li><p>安装完成后开始准备激活</p>
</li>
</ol>
<h2 id="激活"><a href="#激活" class="headerlink" title="激活"></a>激活</h2><ol>
<li><p>进入<code>/opt/MATLAB/R2018a/bin</code>下，执行<code>./matlab</code></p>
<ul>
<li><p>如果报错</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MATLAB is selecting SOFTWARE OPENGL rendering.</span><br><span class="line">/opt/MATLAB/R2018a/bin/glnxa64/MATLAB: error <span class="keyword">while</span> loading shared libraries: libcrypt.so.1: cannot open shared object file: No such file or directory</span><br><span class="line"><span class="comment">#需要安装</span></span><br><span class="line">sudo pacman -S libxcrypt-compat</span><br></pre></td></tr></table></figure></li>
<li><p>使用./matlab后，如果报错</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#如果报下面的错误</span></span><br><span class="line">MATLAB is selecting SOFTWARE OPENGL rendering.</span><br><span class="line">License checkout failed.</span><br><span class="line">License Manager Error -15</span><br><span class="line">MATLAB is unable to connect to the license server. </span><br><span class="line">Check that the license manager has been started, and that the MATLAB client machine can communicate</span><br><span class="line">with the license server.</span><br><span class="line"></span><br><span class="line">Troubleshoot this issue by visiting: </span><br><span class="line">https://www.mathworks.com/support/lme/R2018a/15</span><br><span class="line"></span><br><span class="line">Diagnostic Information:</span><br><span class="line">Feature: MATLAB </span><br><span class="line">License path: 27000@waves-pc.localdomain:/opt/IC_EDA/Questasim10.7/questasim/License/mentor.dat:/home/waves/.matla</span><br><span class="line">b/R2018a_licenses:/opt/MATLAB/R2018a/licenses/license.dat:/opt/MATLAB/R2018a/licenses/*.lic </span><br><span class="line">Licensing error: -15,570. System Error: 115</span><br><span class="line"><span class="comment">#使用下面这一条命令解决</span></span><br><span class="line">sudo ./matlab</span><br></pre></td></tr></table></figure></li>
<li><p><img src="/2021/09/13/Archlinu-install-note/image-20220505223606959.png" alt="image-20220505223606959"></p>
</li>
<li><p><img src="/2021/09/13/Archlinu-install-note/image-20220505223621331.png" alt="image-20220505223621331"></p>
</li>
<li><p>激活完成后还需要copy 补丁文件</p>
</li>
</ul>
</li>
<li><p>copy补丁文件</p>
<p>到crack文件夹下，找到<code>R2018a\bin\glnxa64\</code>复制到安装目录下，相同的位置覆盖原来的文件。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/MATLAB_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E5%AE%89%E8%A3%85%E6%97%B6library%E9%94%99%E8%AF%AF">创建快捷方式</a></p>
<p>在<code>/usr/share/applications/</code>文件夹下创建<code>matlab.desktop</code>文件内容如下。完成后保存退出。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/usr/share/applications/matlab.desktop</span></span><br><span class="line"></span><br><span class="line">[Desktop Entry]</span><br><span class="line">Version=R2018a</span><br><span class="line">Type=Application</span><br><span class="line">Terminal=<span class="literal">false</span></span><br><span class="line">MimeType=text/x-matlab</span><br><span class="line">Exec=/opt/MATLAB/R2018a/bin/matlab -desktop</span><br><span class="line">Name=MATLAB</span><br><span class="line">Icon=matlab</span><br><span class="line">Categories=Development;Math;Science</span><br><span class="line">Comment=Scientific computing environment</span><br><span class="line">StartupNotify=<span class="literal">true</span></span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zsz</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
