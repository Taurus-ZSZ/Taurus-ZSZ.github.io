<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","version":"8.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="[TOC] Docker 学习笔记Docker 概述docker 可以干什么？更快速的交付与部署， docker 打包运行，一键运行。 更便捷的升级和扩容 使用docker 之后，我们部署应用更搭积木一样。 更简单的运维 更高效的计算机资源利用 docker是内核级的虚拟化，一个实体机上可以运行很多个容器。 Docker 安装Docker 的基本组成 镜像(image)： docker 镜像好比是">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker 学习笔记">
<meta property="og:url" content="http://example.com/2021/09/22/Docker-notes/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="[TOC] Docker 学习笔记Docker 概述docker 可以干什么？更快速的交付与部署， docker 打包运行，一键运行。 更便捷的升级和扩容 使用docker 之后，我们部署应用更搭积木一样。 更简单的运维 更高效的计算机资源利用 docker是内核级的虚拟化，一个实体机上可以运行很多个容器。 Docker 安装Docker 的基本组成 镜像(image)： docker 镜像好比是">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210916040839977.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210916053831188.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210916060909003.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210916061429374.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210920200126977.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210920204051023.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210920214128402.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210920215749543.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210921005349991.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210921005757086.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210921035055665.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210921040320685.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210921041233923.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210921042016622.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210921054047460.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210921060249061.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210921233158543.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922000606724.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922001310644.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922002541829.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922002120951.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922003031848.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922003413944.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922004130868.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922004255766.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922005501643.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/u=1982640279,3003728739&fm=26&fmt=auto.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/u=3010872685,2996850938&fm=26&fmt=auto.jpeg">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922035715666.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922042547316.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922042814743.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922043212151.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/Docker-notes/src=http://www.itdaan.com/i/815ca090f9f8f6360ec657afbe5118b41.jpg&refer=http://www.itdaan.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922170008938.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922170345497.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922174354239.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922174753326.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922182425146.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922183605111.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922201024440.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922201150647.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922204544768.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922210349538.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922211146558.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922211251148.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922211606405.png">
<meta property="og:image" content="http://example.com/2021/09/22/Docker-notes/image-20210922212314218.png">
<meta property="article:published_time" content="2021-09-21T17:25:59.000Z">
<meta property="article:modified_time" content="2022-04-11T15:30:45.184Z">
<meta property="article:author" content="zsz">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/09/22/Docker-notes/image-20210916040839977.png">


<link rel="canonical" href="http://example.com/2021/09/22/Docker-notes/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2021/09/22/Docker-notes/","path":"2021/09/22/Docker-notes/","title":"Docker 学习笔记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Docker 学习笔记 | Hexo</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hexo</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">遇见美好的每天</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">19</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">8</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">21</span></a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0"><span class="nav-number">1.</span> <span class="nav-text">Docker 学习笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-%E6%A6%82%E8%BF%B0"><span class="nav-number">1.1.</span> <span class="nav-text">Docker 概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-%E5%8F%AF%E4%BB%A5%E5%B9%B2%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-number">1.1.1.</span> <span class="nav-text">docker 可以干什么？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-%E5%AE%89%E8%A3%85"><span class="nav-number">1.2.</span> <span class="nav-text">Docker 安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90"><span class="nav-number">1.2.1.</span> <span class="nav-text">Docker 的基本组成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Docker"><span class="nav-number">1.2.2.</span> <span class="nav-text">安装Docker</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Centos7-%E5%AE%89%E8%A3%85-Docker"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">Centos7 安装 Docker</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Archlinux-%E5%AE%89%E8%A3%85Docker"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">Archlinux 安装Docker</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9E%E9%A1%BEHello-world"><span class="nav-number">1.2.3.</span> <span class="nav-text">回顾Hello world</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="nav-number">1.2.4.</span> <span class="nav-text">底层原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-%E7%9A%84%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.3.</span> <span class="nav-text">Docker 的常用命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%AE%E5%8A%A9%E5%91%BD%E4%BB%A4"><span class="nav-number">1.3.1.</span> <span class="nav-text">帮助命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%E5%91%BD%E4%BB%A4"><span class="nav-number">1.3.2.</span> <span class="nav-text">镜像命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-images"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">docker images</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-search"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">**docker search **</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-pull"><span class="nav-number">1.3.2.3.</span> <span class="nav-text">docker pull</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-rmi"><span class="nav-number">1.3.2.4.</span> <span class="nav-text">docker rmi</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.3.3.</span> <span class="nav-text">容器命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B0%E5%BB%BA%E5%AE%B9%E5%99%A8%E5%B9%B6%E5%90%AF%E5%8A%A8"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">新建容器并启动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%97%E5%87%BA%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E5%AE%B9%E5%99%A8"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">列出正在运行的容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%80%E5%87%BA%E5%AE%B9%E5%99%A8"><span class="nav-number">1.3.3.3.</span> <span class="nav-text">退出容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%AE%B9%E5%99%A8"><span class="nav-number">1.3.3.4.</span> <span class="nav-text">删除容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E5%92%8C%E5%81%9C%E6%AD%A2%E5%AE%B9%E5%99%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.3.5.</span> <span class="nav-text">启动和停止容器操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4"><span class="nav-number">1.3.4.</span> <span class="nav-text">常用的其他命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">后台启动容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97%E5%91%BD%E4%BB%A4"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">查看日志命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9A%84%E8%BF%9B%E7%A8%8B%E4%BF%A1%E6%81%AF-ps"><span class="nav-number">1.3.4.3.</span> <span class="nav-text">查看容器中的进程信息 ps</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F-%E8%BF%99%E9%87%8C%E6%98%AF%E5%AE%B9%E5%99%A8%EF%BC%9F%EF%BC%9F-%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE"><span class="nav-number">1.3.4.4.</span> <span class="nav-text">查看镜像(这里是容器？？)的元数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E5%85%A5%E5%BD%93%E5%89%8D%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E5%AE%B9%E5%99%A8"><span class="nav-number">1.3.4.5.</span> <span class="nav-text">进入当前正在运行的容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8E%E5%AE%B9%E5%99%A8%E5%86%85%E6%8B%B7%E8%B4%9D%E6%96%87%E4%BB%B6%E5%88%B0%E4%B8%BB%E6%9C%BA%E4%B8%8A"><span class="nav-number">1.3.4.6.</span> <span class="nav-text">从容器内拷贝文件到主机上</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">1.3.5.</span> <span class="nav-text">小结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%9C%E4%B8%9A%E7%BB%83%E4%B9%A0"><span class="nav-number">1.3.6.</span> <span class="nav-text">作业练习</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%9A%B4%E9%9C%B2%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="nav-number">1.3.6.0.1.</span> <span class="nav-text">端口暴露的概念</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="nav-number">1.3.7.</span> <span class="nav-text">可视化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-%E9%95%9C%E5%83%8F%E8%AE%B2%E8%A7%A3"><span class="nav-number">1.4.</span> <span class="nav-text">Docker 镜像讲解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number">1.4.1.</span> <span class="nav-text">镜像是什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker%E9%95%9C%E5%83%8F%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86"><span class="nav-number">1.4.2.</span> <span class="nav-text">Docker镜像加载原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-%E5%88%86%E5%B1%82%E5%8E%9F%E7%90%86"><span class="nav-number">1.4.3.</span> <span class="nav-text">Docker 分层原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-commit-%E9%95%9C%E5%83%8F"><span class="nav-number">1.4.4.</span> <span class="nav-text">Docker commit 镜像</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">1.5.</span> <span class="nav-text">容器数据卷</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">1.5.1.</span> <span class="nav-text">什么是容器数据卷</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">1.5.1.1.</span> <span class="nav-text">使用数据卷</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%EF%BC%9A%E5%AE%89%E8%A3%85MySQL"><span class="nav-number">1.5.1.2.</span> <span class="nav-text">实战：安装MySQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B7%E5%90%8D%E5%92%8C%E5%8C%BF%E5%90%8D%E6%8C%82%E8%BD%BD"><span class="nav-number">1.5.1.3.</span> <span class="nav-text">具名和匿名挂载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9D%E8%AF%86Dockerfile"><span class="nav-number">1.5.1.4.</span> <span class="nav-text">初识Dockerfile</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%AE%B9%E5%99%A8"><span class="nav-number">1.5.1.5.</span> <span class="nav-text">数据卷容器</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DockerFile"><span class="nav-number">1.6.</span> <span class="nav-text">DockerFile</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.6.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DockerFile-%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="nav-number">1.6.2.</span> <span class="nav-text">DockerFile 构建过程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E6%8C%87%E4%BB%A4"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">基础指令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DockerFile-%E6%8C%87%E4%BB%A4%EF%BC%9A"><span class="nav-number">1.6.2.2.</span> <span class="nav-text">DockerFile 指令：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%E6%B5%8B%E8%AF%95"><span class="nav-number">1.6.2.3.</span> <span class="nav-text">实战测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%EF%BC%9ATomcate"><span class="nav-number">1.6.2.4.</span> <span class="nav-text">实战：Tomcate</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%91%E5%B8%83%E8%87%AA%E5%B7%B1%E7%9A%84%E9%95%9C%E5%83%8F"><span class="nav-number">1.6.2.5.</span> <span class="nav-text">发布自己的镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93-1"><span class="nav-number">1.6.2.6.</span> <span class="nav-text">小结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-%E7%BD%91%E7%BB%9C"><span class="nav-number">1.7.</span> <span class="nav-text">Docker 网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%90%86%E8%A7%A3%E7%BD%91%E7%BB%9C-docker0"><span class="nav-number">1.7.1.</span> <span class="nav-text">理解网络 docker0</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E4%BA%92%E8%81%94-%E2%80%93link"><span class="nav-number">1.7.2.</span> <span class="nav-text">容器互联 –link</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C%EF%BC%9A"><span class="nav-number">1.7.3.</span> <span class="nav-text">自定义网络：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E8%BF%9E%E9%80%9A"><span class="nav-number">1.7.4.</span> <span class="nav-text">网络连通</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%EF%BC%9A%E9%83%A8%E7%BD%B2Redis%E9%9B%86%E7%BE%A4"><span class="nav-number">1.7.5.</span> <span class="nav-text">实战：部署Redis集群</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SpringBoot-%E5%BE%AE%E6%9C%8D%E5%8A%A1"><span class="nav-number">1.7.6.</span> <span class="nav-text">SpringBoot 微服务</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker-%E5%8F%82%E8%80%83%E6%89%8B%E5%86%8C"><span class="nav-number">2.</span> <span class="nav-text">Docker 参考手册</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8"><span class="nav-number">2.1.</span> <span class="nav-text">Docker 命令大全</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB"><span class="nav-number">2.2.</span> <span class="nav-text">Docker 资源汇总</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-%E8%B5%84%E6%BA%90"><span class="nav-number">2.2.1.</span> <span class="nav-text">Docker 资源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F"><span class="nav-number">2.2.2.</span> <span class="nav-text">Docker 国内镜像</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">zsz</p>
  <div class="site-description" itemprop="description">不负光阴韶华</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/09/22/Docker-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zsz">
      <meta itemprop="description" content="不负光阴韶华">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Docker 学习笔记
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-09-22 01:25:59" itemprop="dateCreated datePublished" datetime="2021-09-22T01:25:59+08:00">2021-09-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-04-11 23:30:45" itemprop="dateModified" datetime="2022-04-11T23:30:45+08:00">2022-04-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>[TOC]</p>
<h1 id="Docker-学习笔记"><a href="#Docker-学习笔记" class="headerlink" title="Docker 学习笔记"></a>Docker 学习笔记</h1><h2 id="Docker-概述"><a href="#Docker-概述" class="headerlink" title="Docker 概述"></a>Docker 概述</h2><h3 id="docker-可以干什么？"><a href="#docker-可以干什么？" class="headerlink" title="docker 可以干什么？"></a>docker 可以干什么？</h3><p>更快速的交付与部署，</p>
<p>docker 打包运行，一键运行。</p>
<p><strong>更便捷的升级和扩容</strong></p>
<p>使用docker 之后，我们部署应用更搭积木一样。</p>
<p><strong>更简单的运维</strong></p>
<p><strong>更高效的计算机资源利用</strong></p>
<p>docker是内核级的虚拟化，一个实体机上可以运行很多个容器。</p>
<h2 id="Docker-安装"><a href="#Docker-安装" class="headerlink" title="Docker 安装"></a>Docker 安装</h2><h3 id="Docker-的基本组成"><a href="#Docker-的基本组成" class="headerlink" title="Docker 的基本组成"></a>Docker 的基本组成</h3><p><img src="/2021/09/22/Docker-notes/image-20210916040839977.png" alt="image-20210916040839977"></p>
<p><strong>镜像(image)：</strong></p>
<p>docker 镜像好比是一个模板，可以通过这个创建容器服务， tomcat 镜像====》run ===&gt;tomcat01容器(提供服务)，通过这个镜像可以创建多个容器，（最终服务运行或项目运行就在这个容器中）</p>
<p><strong>容器(container)</strong></p>
<p>Docker 利用容器技术可以独立运行一个或一组应用，通过镜像来创建的，</p>
<p>启动，停止，删除，基本命令 </p>
<p>目前，可以把容器理解成一个简易的linux系统。</p>
<p><strong>仓库(repository)</strong></p>
<p>仓库就是用来存放镜像的地方。</p>
<p>仓库分为公有仓库和私有仓库！</p>
<p>Docker Hub （默认是国外的）</p>
<p>阿里云   都有容器服务。（配置镜像加速！）</p>
<h3 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">环境准备</span><br></pre></td></tr></table></figure>

<ol>
<li>需要会一点点的linux 的基础</li>
<li>Centos7</li>
<li>使用Xshell连接远程服务器进行操作</li>
</ol>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">环境查看</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">系统内核是5.14.3-arch1-1</span><br><span class="line">uname -r</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">系统版本</span><br><span class="line">zsz@zsz-pc ~]$ cat /etc/os-release </span><br><span class="line">NAME=&quot;Arch Linux&quot;</span><br><span class="line">PRETTY_NAME=&quot;Arch Linux&quot;</span><br><span class="line">ID=arch</span><br><span class="line">BUILD_ID=rolling</span><br><span class="line">ANSI_COLOR=&quot;38;2;23;147;209&quot;</span><br><span class="line">HOME_URL=&quot;https://archlinux.org/&quot;</span><br><span class="line">DOCUMENTATION_URL=&quot;https://wiki.archlinux.org/&quot;</span><br><span class="line">SUPPORT_URL=&quot;https://bbs.archlinux.org/&quot;</span><br><span class="line">BUG_REPORT_URL=&quot;https://bugs.archlinux.org/&quot;</span><br><span class="line">LOGO=archlinux</span><br><span class="line">[zsz@zsz-pc ~]$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Centos7-安装-Docker"><a href="#Centos7-安装-Docker" class="headerlink" title="Centos7 安装 Docker"></a>Centos7 安装 Docker</h4><ol>
<li><p>卸载</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure></li>
<li><p>使用官方仓库安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">安装环境</span></span><br><span class="line">sudo yum install -y yum-utils</span><br><span class="line"><span class="meta">#</span><span class="bash">设置仓库</span></span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta">#</span><span class="bash">在国内推荐使用阿里的</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>安装docker 相关的 docker-ce 社区 -ee 企业版 推荐使用ce</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">更新软件包索引</span></span><br><span class="line">yum makecache fast</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">安装</span></span><br><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure></li>
<li><p>启动Docker </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<p>帮助文档</p>
<h4 id="Archlinux-安装Docker"><a href="#Archlinux-安装Docker" class="headerlink" title="Archlinux 安装Docker"></a>Archlinux 安装Docker</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">安装 docker</span></span><br><span class="line">sudo pacman  -S docker</span><br><span class="line"><span class="meta">#</span><span class="bash">启动 docker 服务</span></span><br><span class="line">systemctl start docker.service</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看docker的信息</span></span><br><span class="line"></span><br><span class="line">sudo docker version</span><br><span class="line"></span><br><span class="line">Client:</span><br><span class="line"> Version:           20.10.8</span><br><span class="line"> API version:       1.41</span><br><span class="line"> Go version:        go1.16.6</span><br><span class="line"> Git commit:        3967b7d28e</span><br><span class="line"> Built:             Wed Aug  4 10:59:01 2021</span><br><span class="line"> OS/Arch:           linux/amd64</span><br><span class="line"> Context:           default</span><br><span class="line"> Experimental:      true</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          20.10.8</span><br><span class="line">  API version:      1.41 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.16.6</span><br><span class="line">  Git commit:       75249d88bc</span><br><span class="line">  Built:            Wed Aug  4 10:58:48 2021</span><br><span class="line">  OS/Arch:          linux/amd64</span><br><span class="line">  Experimental:     false</span><br><span class="line"> containerd:</span><br><span class="line">  Version:          v1.5.5</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">免sudo执行docker</span></span><br><span class="line">sudo gpasswd -a $&#123;USER&#125; docker</span><br><span class="line"><span class="meta">#</span><span class="bash">重新登录，重新开启docker服务，systemctl start docker.service</span></span><br><span class="line"><span class="meta">	#</span><span class="bash">在centos7中 需要刷新docker 组</span></span><br><span class="line">	newgrp docker</span><br><span class="line"><span class="meta">#</span><span class="bash">重新开启docker服务，</span></span><br><span class="line">systemctl start docker.service</span><br><span class="line"></span><br><span class="line">docker info </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">运行hello world</span> </span><br><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210916053831188.png" alt="image-20210916053831188" style="zoom:150%;">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">查看一下下载的这个hello-world 镜像</span><br><span class="line">[zsz@zsz-pc ~]$ docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    d1165f221234   6 months ago   13.3kB</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>卸载docker </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1、卸载依赖</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2、删除资源</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="回顾Hello-world"><a href="#回顾Hello-world" class="headerlink" title="回顾Hello world"></a>回顾Hello world</h3><h3 id="底层原理"><a href="#底层原理" class="headerlink" title="底层原理"></a>底层原理</h3><p><strong>Docker是怎么工作的？</strong></p>
<p>Docker 是一个Client-Server结构的服务，Docker的守护进程运行在主机上，通过Socket从客户端访问。</p>
<p>DockerServer 接受到Docker-Client的指令，就会执行这个命令。</p>
<p><img src="/2021/09/22/Docker-notes/image-20210916060909003.png" alt="image-20210916060909003"></p>
<p><strong>Docker为什么比虚拟机快</strong></p>
<ol>
<li>Docker 有着比虚拟机更少的抽象层。</li>
<li>Docker 利用的是宿主机的内核，VM需要的是guest os。</li>
</ol>
<p><img src="/2021/09/22/Docker-notes/image-20210916061429374.png" alt="image-20210916061429374"></p>
<p>所以说，新建一个容器的时候，docker不需要像虚拟机一样重新加载一个操作系统的内核，避免引导，虚拟机是加载Guest OS，分钟级别的，而Docker利用的是宿主机的操作系统，省略了这个过程，秒级的响应速度。</p>
<p>之后学习完毕所有的命令，再回过头来看这段理论，就会非常清晰。    </p>
<h2 id="Docker-的常用命令"><a href="#Docker-的常用命令" class="headerlink" title="Docker 的常用命令"></a>Docker 的常用命令</h2><h3 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker.service	#启动docker服务</span><br><span class="line">docker version 	#显示docker 的版本信息</span><br><span class="line">docker info		#显示docker的系统信息，包括镜像与容器的数量。</span><br><span class="line">docker --help	#帮助命令</span><br></pre></td></tr></table></figure>

<p>帮助文档的地址：<a target="_blank" rel="noopener" href="https://docs.docker.com/reference/">https://docs.docker.com/reference/</a></p>
<h3 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h3><h4 id="docker-images"><a href="#docker-images" class="headerlink" title="docker images"></a><strong>docker images</strong></h4><p><strong>查看所有本地的主机上的镜像</strong>。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[zsz@zsz-pc ~]$ docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    d1165f221234   6 months ago   13.3kB</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">解释</span></span><br><span class="line">REPOSITORY	镜像的仓库源</span><br><span class="line">TAG			镜像的标签</span><br><span class="line">IMAG ID		镜像的ID</span><br><span class="line">CREATE		镜像创建的时间</span><br><span class="line">SIZE		镜像的大小</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">常用可选项</span></span><br><span class="line">Options:</span><br><span class="line">  -a, --all            #列出所有的镜像 Show all images (default hides intermediate images)</span><br><span class="line">  -q, --quiet           #只显示镜像的ID Only show image IDs</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="docker-search"><a href="#docker-search" class="headerlink" title="**docker search **"></a>**docker search **</h4><p><strong>搜索命令</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[zsz@zsz-pc ~]$ docker search mysql</span><br><span class="line">NAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql                             MySQL is a widely used, open-source relation…   11419     [OK]       </span><br><span class="line">mariadb                           MariaDB Server is a high performing open sou…   4339      [OK]       </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">可选项</span></span><br><span class="line">-f, --filter filter   Filter output based on conditions provided</span><br><span class="line">	--format string   Pretty-print search using a Go template</span><br><span class="line">    --limit int       Max number of search results (default 25)</span><br><span class="line">	--no-trunc        Don&#x27;t truncate output</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">可选项 通过收藏来过滤</span></span><br><span class="line"> --filter=STARS=3000	#搜索出来的就是STARS大于3000的</span><br><span class="line"> </span><br><span class="line"> docker search mysql --filter=STARS=3000</span><br><span class="line">NAME      DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql     MySQL is a widely used, open-source relation…   11419     [OK]       </span><br><span class="line">mariadb   MariaDB Server is a high performing open sou…   4339      [OK]       </span><br><span class="line">[zsz@zsz-pc ~]$ docker search mysql --filter=STARS=5000</span><br><span class="line">NAME      DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql     MySQL is a widely used, open-source relation…   11419     [OK] </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="docker-pull"><a href="#docker-pull" class="headerlink" title="docker pull"></a><strong>docker pull</strong></h4><p><strong>拉取镜像</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">下载镜像，docker pull 镜像名[:tag]</span></span><br><span class="line">[zsz@zsz-pc ~]$ docker pull mysql</span><br><span class="line">Using default tag: latest	#如果不写tag,默认就是latest</span><br><span class="line">latest: Pulling from library/mysql</span><br><span class="line">a330b6cecb98: Pull complete #分层下载，docker image 的核心，联合文件系统</span><br><span class="line">9c8f656c32b8: Pull complete </span><br><span class="line">88e473c3f553: Pull complete </span><br><span class="line">062463ea5d2f: Pull complete </span><br><span class="line">daf7e3bdf4b6: Pull complete </span><br><span class="line">1839c0b7aac9: Pull complete </span><br><span class="line">cf0a0cfee6d0: Pull complete </span><br><span class="line">1b42041bb11e: Pull complete </span><br><span class="line">10459d86c7e6: Pull complete </span><br><span class="line">b7199599d5f9: Pull complete </span><br><span class="line">1d6f51e17d45: Pull complete </span><br><span class="line">50e0789bacad: Pull complete </span><br><span class="line">Digest: sha256:99e0989e7e3797cfbdb8d51a19d32c8d286dd8862794d01a547651a896bcf00c	#docker 签名，防伪标志</span><br><span class="line">Status: Downloaded newer image for mysql:latest</span><br><span class="line">docker.io/library/mysql:latest	#真实地址</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">等价于</span></span><br><span class="line">docker pull mysql</span><br><span class="line">docker pull docker.io/library/mysql:latest	</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">指定版本下载</span></span><br><span class="line">docker pull mysql:5.7</span><br><span class="line">5.7: Pulling from library/mysql</span><br><span class="line">a330b6cecb98: Already exists </span><br><span class="line">9c8f656c32b8: Already exists </span><br><span class="line">88e473c3f553: Already exists </span><br><span class="line">062463ea5d2f: Already exists </span><br><span class="line">daf7e3bdf4b6: Already exists </span><br><span class="line">1839c0b7aac9: Already exists </span><br><span class="line">cf0a0cfee6d0: Already exists </span><br><span class="line">fae7a809788c: Pull complete </span><br><span class="line">dae5a82a61f0: Pull complete </span><br><span class="line">7063da9569eb: Pull complete </span><br><span class="line">51a9a9b4ef36: Pull complete </span><br><span class="line">Digest: sha256:d9b934cdf6826629f8d02ea01f28b2c4ddb1ae27c32664b14867324b3e5e1291</span><br><span class="line">Status: Downloaded newer image for mysql:5.7</span><br><span class="line">docker.io/library/mysql:5.7</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="docker-rmi"><a href="#docker-rmi" class="headerlink" title="docker rmi"></a><strong>docker rmi</strong></h4><p>删除镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[zsz@zsz-pc ~]$ docker rmi -f 镜像ID 	#删除指定的容器</span><br><span class="line">[zsz@zsz-pc ~]$ docker rmi -f 镜像1ID 镜像1ID 镜像2ID 	#删除多个容器</span><br><span class="line">[zsz@zsz-pc ~]$ docker rmi -f $(docker images -aq)	#删除所有的容器</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h3><p>说明：我们有了镜像才可以创建容器，linux,下载一个centos镜像来测试学习。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull centos</span><br></pre></td></tr></table></figure>

<h4 id="新建容器并启动"><a href="#新建容器并启动" class="headerlink" title="新建容器并启动"></a><strong>新建容器并启动</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">docker run [可选参数] image </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">参数说明</span></span><br><span class="line">--name=&quot;Name&quot;	容器的名字，用来区分容器</span><br><span class="line">-d				后台运行</span><br><span class="line">-it				使用交互方式运行，进入容器查看内容。</span><br><span class="line">-p				指定容器的端口	-p 8080:8080</span><br><span class="line">	-p ip:主机端口:容器端口</span><br><span class="line">	-p	主机端口:容器端口(常用的)</span><br><span class="line">	-p	容器端口</span><br><span class="line">	容器端口	</span><br><span class="line">-P				随机指定端口</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">测试 启动并进入容器</span></span><br><span class="line">[zsz@zsz-pc ~]$ docker run -it centos /bin/bash</span><br><span class="line">[root@a67ea1104291 /]# 			#主机名就是images的镜像ID</span><br><span class="line">[root@a67ea1104291 /]# ls		#查看容器内的centos,基础版本，的命令可能都是不完善的</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line">[root@a67ea1104291 /]# exit		#从容器中退回主机</span><br><span class="line">exit</span><br><span class="line">[zsz@zsz-pc ~]$ ls</span><br><span class="line">Desktop    Downloads  Pictures  Templates  VMwareTools-10.3.10-13959562.tar.gz</span><br><span class="line">Documents  Music      Public    Videos     vmware-tools-distrib</span><br></pre></td></tr></table></figure>

<h4 id="列出正在运行的容器"><a href="#列出正在运行的容器" class="headerlink" title="列出正在运行的容器"></a><strong>列出正在运行的容器</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> docker ps 命令</span></span><br><span class="line"><span class="meta">	#</span><span class="bash">列出当前正在运行的容器</span></span><br><span class="line">-a 	#列出当前正在运行的容器+ 带出历史运行过的容器</span><br><span class="line">-n=?	#显示最近创建的容器。</span><br><span class="line">-q	#只显示容器的编号</span><br><span class="line"></span><br><span class="line">[zsz@zsz-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line">[zsz@zsz-pc ~]$ docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND       CREATED         STATUS                     PORTS     NAMES</span><br><span class="line">a67ea1104291   centos         &quot;/bin/bash&quot;   5 minutes ago   Exited (0) 2 minutes ago             eloquent_wiles</span><br><span class="line">86c173decece   d1165f221234   &quot;/hello&quot;      25 hours ago    Exited (0) 25 hours ago              sharp_shtern</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="退出容器"><a href="#退出容器" class="headerlink" title="退出容器"></a><strong>退出容器</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exit 	#直接停止容器并退出</span><br><span class="line">crtl+P+Q 	#容器不停止退出</span><br></pre></td></tr></table></figure>

<h4 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a><strong>删除容器</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器ID				#删除指定的镜像 ，不能删除正在运行的容器，如果要强制删除使用 rm -f</span><br><span class="line">docker rm -f $(docker ps -aq)#删除所有的容器</span><br><span class="line">docker ps -a -q |xargs docker rm #也可删除所有的容器</span><br></pre></td></tr></table></figure>

<h4 id="启动和停止容器操作"><a href="#启动和停止容器操作" class="headerlink" title="启动和停止容器操作"></a><strong>启动和停止容器操作</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker start 	容器ID	#启动容器</span><br><span class="line">docker	rstart	容器ID	#重启容器</span><br><span class="line">docker  stop	容器ID	#停止当前正在运行的容器</span><br><span class="line">docker kill		容器ID	#强制停止当前的容器</span><br></pre></td></tr></table></figure>



<h3 id="常用的其他命令"><a href="#常用的其他命令" class="headerlink" title="常用的其他命令"></a>常用的其他命令</h3><h4 id="后台启动容器"><a href="#后台启动容器" class="headerlink" title="后台启动容器"></a>后台启动容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">命令 docker run -d 镜像名！</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d archlinux</span><br><span class="line">c8419e6e8b0d040e66efba9b4d212752648b47379761811afd680cd288630fca</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">问题 docker ps 发现archlinux 停止了</span></span><br><span class="line">[proton@proton-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">常见的坑，docker 容器用后台运行，就必须要有一个进程，docker发现没有应用就会自动停止。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Nignx 容器启动后发现自己没有提供服务，就会立刻停止，就是没有程序。</span></span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h4 id="查看日志命令"><a href="#查看日志命令" class="headerlink" title="查看日志命令"></a>查看日志命令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> docker logs -f -t --tail 容器 没有日志</span><br><span class="line"><span class="meta"> </span></span><br><span class="line"><span class="meta"> #</span><span class="bash">自己写一段shell脚本</span></span><br><span class="line"> “while true;do echo nihao;sleep 1;done”</span><br><span class="line"> [proton@proton-pc ~]$ docker run -d archlinux /bin/sh -c &quot;while true;do echo hihao;sleep 1;done&quot; </span><br><span class="line">00fd93c63788ca4880b1ef87345977c696d2f275a73083911894883bf8d72353</span><br><span class="line">[proton@proton-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE       COMMAND                  CREATED         STATUS         PORTS     NAMES</span><br><span class="line">00fd93c63788   archlinux   &quot;/bin/sh -c &#x27;while t…&quot;   3 seconds ago   Up 3 seconds             zealous_lichterman</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">显示日志</span></span><br><span class="line">-tf			#显示日志 -t 时间戳 -f 跟踪日志输出</span><br><span class="line">--tail number #要显示的日志条数</span><br><span class="line"> docker logs -f -t --tail 10 00fd93c63788</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h4 id="查看容器中的进程信息-ps"><a href="#查看容器中的进程信息-ps" class="headerlink" title="查看容器中的进程信息 ps"></a>查看容器中的进程信息 ps</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">命令 docker top 容器ID</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker top d084a3f8133d</span><br><span class="line">UID                 PID                 PPID                C                   STIME               TTY   </span><br><span class="line">root                4613                4593                0                   07:13               ?     </span><br><span class="line">root                4697                4613                0                   07:14               ?     </span><br><span class="line">[proton@proton-pc ~]$ </span><br><span class="line"><span class="meta">#</span><span class="bash"> UID 用户ID</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PID 进程ID</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PPID 是父进程ID</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="查看镜像-这里是容器？？-的元数据"><a href="#查看镜像-这里是容器？？-的元数据" class="headerlink" title="查看镜像(这里是容器？？)的元数据"></a>查看镜像(这里是容器？？)的元数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line">docker inspect --hellp</span><br><span class="line"><span class="meta">#</span><span class="bash"> 命令</span></span><br><span class="line">docker inspect 容器ID</span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line">[proton@proton-pc ~]$ docker inspect d084a3f8133d</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2021-09-19T23:13:45.41748822Z&quot;,</span><br><span class="line">        &quot;Path&quot;: &quot;/bin/sh&quot;,</span><br><span class="line">        &quot;Args&quot;: [</span><br><span class="line">            &quot;-c&quot;,</span><br><span class="line">            &quot;while true;do echo hihao;sleep 1;done&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;State&quot;: &#123;</span><br><span class="line">            &quot;Status&quot;: &quot;running&quot;,</span><br><span class="line">            &quot;Running&quot;: true,</span><br><span class="line">            &quot;Paused&quot;: false,</span><br><span class="line">            &quot;Restarting&quot;: false,</span><br><span class="line">            &quot;OOMKilled&quot;: false,</span><br><span class="line">            &quot;Dead&quot;: false,</span><br><span class="line">            &quot;Pid&quot;: 4613,</span><br><span class="line">            &quot;ExitCode&quot;: 0,</span><br><span class="line">            &quot;Error&quot;: &quot;&quot;,</span><br><span class="line">            &quot;StartedAt&quot;: &quot;2021-09-19T23:13:45.855531374Z&quot;,</span><br><span class="line">            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Image&quot;: &quot;sha256:1d6f90387c134e502f5579c8c7ded65a5eaf25b9b2a5dce29a844e9290d4853c&quot;,</span><br><span class="line">        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f/resolv.conf&quot;,</span><br><span class="line">        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f/hostname&quot;,</span><br><span class="line">        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f/hosts&quot;,</span><br><span class="line">        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f/d084a3f8133d3d57440d05663baf50988512224f2665d5798b5f35c39a838f1f-json.log&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;/nice_dewdney&quot;,</span><br><span class="line">        &quot;RestartCount&quot;: 0,</span><br><span class="line">        &quot;Driver&quot;: &quot;overlay2&quot;,</span><br><span class="line">        &quot;Platform&quot;: &quot;linux&quot;,</span><br><span class="line">        &quot;MountLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ProcessLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;AppArmorProfile&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ExecIDs&quot;: null,</span><br><span class="line">        &quot;HostConfig&quot;: &#123;</span><br><span class="line">            &quot;Binds&quot;: null,</span><br><span class="line">            &quot;ContainerIDFile&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LogConfig&quot;: &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;json-file&quot;,</span><br><span class="line">                &quot;Config&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;NetworkMode&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;PortBindings&quot;: &#123;&#125;,</span><br><span class="line">            &quot;RestartPolicy&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;no&quot;,</span><br><span class="line">                &quot;MaximumRetryCount&quot;: 0</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;AutoRemove&quot;: false,</span><br><span class="line">            &quot;VolumeDriver&quot;: &quot;&quot;,</span><br><span class="line">            &quot;VolumesFrom&quot;: null,</span><br><span class="line">            &quot;CapAdd&quot;: null,</span><br><span class="line">            &quot;CapDrop&quot;: null,</span><br><span class="line">            &quot;CgroupnsMode&quot;: &quot;host&quot;,</span><br><span class="line">            &quot;Dns&quot;: [],</span><br><span class="line">            &quot;DnsOptions&quot;: [],</span><br><span class="line">            &quot;DnsSearch&quot;: [],</span><br><span class="line">            &quot;ExtraHosts&quot;: null,</span><br><span class="line">            &quot;GroupAdd&quot;: null,</span><br><span class="line">            &quot;IpcMode&quot;: &quot;private&quot;,</span><br><span class="line">            &quot;Cgroup&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Links&quot;: null,</span><br><span class="line">            &quot;OomScoreAdj&quot;: 0,</span><br><span class="line">            &quot;PidMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Privileged&quot;: false,</span><br><span class="line">            &quot;PublishAllPorts&quot;: false,</span><br><span class="line">            &quot;ReadonlyRootfs&quot;: false,</span><br><span class="line">            &quot;SecurityOpt&quot;: null,</span><br><span class="line">            &quot;UTSMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;UsernsMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;ShmSize&quot;: 67108864,</span><br><span class="line">            &quot;Runtime&quot;: &quot;runc&quot;,</span><br><span class="line">            &quot;ConsoleSize&quot;: [</span><br><span class="line">                0,</span><br><span class="line">                0</span><br><span class="line">            ],</span><br><span class="line">            &quot;Isolation&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpuShares&quot;: 0,</span><br><span class="line">            &quot;Memory&quot;: 0,</span><br><span class="line">            &quot;NanoCpus&quot;: 0,</span><br><span class="line">            &quot;CgroupParent&quot;: &quot;&quot;,</span><br><span class="line">            &quot;BlkioWeight&quot;: 0,</span><br><span class="line">            &quot;BlkioWeightDevice&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadBps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceWriteBps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceReadIOps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceWriteIOps&quot;: null,</span><br><span class="line">            &quot;CpuPeriod&quot;: 0,</span><br><span class="line">            &quot;CpuQuota&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimePeriod&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimeRuntime&quot;: 0,</span><br><span class="line">            &quot;CpusetCpus&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpusetMems&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Devices&quot;: [],</span><br><span class="line">            &quot;DeviceCgroupRules&quot;: null,</span><br><span class="line">            &quot;DeviceRequests&quot;: null,</span><br><span class="line">            &quot;KernelMemory&quot;: 0,</span><br><span class="line">            &quot;KernelMemoryTCP&quot;: 0,</span><br><span class="line">            &quot;MemoryReservation&quot;: 0,</span><br><span class="line">            &quot;MemorySwap&quot;: 0,</span><br><span class="line">            &quot;MemorySwappiness&quot;: null,</span><br><span class="line">            &quot;OomKillDisable&quot;: false,</span><br><span class="line">            &quot;PidsLimit&quot;: null,</span><br><span class="line">            &quot;Ulimits&quot;: null,</span><br><span class="line">            &quot;CpuCount&quot;: 0,</span><br><span class="line">            &quot;CpuPercent&quot;: 0,</span><br><span class="line">            &quot;IOMaximumIOps&quot;: 0,</span><br><span class="line">            &quot;IOMaximumBandwidth&quot;: 0,</span><br><span class="line">            &quot;MaskedPaths&quot;: [</span><br><span class="line">                &quot;/proc/asound&quot;,</span><br><span class="line">                &quot;/proc/acpi&quot;,</span><br><span class="line">                &quot;/proc/kcore&quot;,</span><br><span class="line">                &quot;/proc/keys&quot;,</span><br><span class="line">                &quot;/proc/latency_stats&quot;,</span><br><span class="line">                &quot;/proc/timer_list&quot;,</span><br><span class="line">                &quot;/proc/timer_stats&quot;,</span><br><span class="line">                &quot;/proc/sched_debug&quot;,</span><br><span class="line">                &quot;/proc/scsi&quot;,</span><br><span class="line">                &quot;/sys/firmware&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ReadonlyPaths&quot;: [</span><br><span class="line">                &quot;/proc/bus&quot;,</span><br><span class="line">                &quot;/proc/fs&quot;,</span><br><span class="line">                &quot;/proc/irq&quot;,</span><br><span class="line">                &quot;/proc/sys&quot;,</span><br><span class="line">                &quot;/proc/sysrq-trigger&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;GraphDriver&quot;: &#123;</span><br><span class="line">            &quot;Data&quot;: &#123;</span><br><span class="line">                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/c3bd95c9c2023cda996478c2d20c8f0163080a5466512c69b56d1547fb64fb7a-init/diff:/var/lib/docker/overlay2/d354ad152b1c58221ab29fbd5cc5aba182a46ff3768ab8bf1abccd8aa6427606/diff:/var/lib/docker/overlay2/36d83b359020a4be71d40164e140b06b202e37f3fbba20e2ebc660eeb243068e/diff&quot;,</span><br><span class="line">                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/c3bd95c9c2023cda996478c2d20c8f0163080a5466512c69b56d1547fb64fb7a/merged&quot;,</span><br><span class="line">                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/c3bd95c9c2023cda996478c2d20c8f0163080a5466512c69b56d1547fb64fb7a/diff&quot;,</span><br><span class="line">                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/c3bd95c9c2023cda996478c2d20c8f0163080a5466512c69b56d1547fb64fb7a/work&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Name&quot;: &quot;overlay2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Mounts&quot;: [],</span><br><span class="line">        &quot;Config&quot;: &#123;</span><br><span class="line">            &quot;Hostname&quot;: &quot;d084a3f8133d&quot;,</span><br><span class="line">            &quot;Domainname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;User&quot;: &quot;&quot;,</span><br><span class="line">            &quot;AttachStdin&quot;: false,</span><br><span class="line">            &quot;AttachStdout&quot;: false,</span><br><span class="line">            &quot;AttachStderr&quot;: false,</span><br><span class="line">            &quot;Tty&quot;: false,</span><br><span class="line">            &quot;OpenStdin&quot;: false,</span><br><span class="line">            &quot;StdinOnce&quot;: false,</span><br><span class="line">            &quot;Env&quot;: [</span><br><span class="line">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;,</span><br><span class="line">                &quot;LANG=en_US.UTF-8&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Cmd&quot;: [</span><br><span class="line">                &quot;/bin/sh&quot;,</span><br><span class="line">                &quot;-c&quot;,</span><br><span class="line">                &quot;while true;do echo hihao;sleep 1;done&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Image&quot;: &quot;archlinux&quot;,</span><br><span class="line">            &quot;Volumes&quot;: null,</span><br><span class="line">            &quot;WorkingDir&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Entrypoint&quot;: null,</span><br><span class="line">            &quot;OnBuild&quot;: null,</span><br><span class="line">            &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;NetworkSettings&quot;: &#123;</span><br><span class="line">            &quot;Bridge&quot;: &quot;&quot;,</span><br><span class="line">            &quot;SandboxID&quot;: &quot;902259aa7f3aa96eda81eb8eb9b1da8d3e6237adbb2049226e41d1b5bfab2899&quot;,</span><br><span class="line">            &quot;HairpinMode&quot;: false,</span><br><span class="line">            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LinkLocalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;Ports&quot;: &#123;&#125;,</span><br><span class="line">            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/902259aa7f3a&quot;,</span><br><span class="line">            &quot;SecondaryIPAddresses&quot;: null,</span><br><span class="line">            &quot;SecondaryIPv6Addresses&quot;: null,</span><br><span class="line">            &quot;EndpointID&quot;: &quot;e563118b1a8af58979bc244e925b2d826334cca6daadf60763612c2c271d1f7c&quot;,</span><br><span class="line">            &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">            &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">            &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">            &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">            &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">            &quot;Networks&quot;: &#123;</span><br><span class="line">                &quot;bridge&quot;: &#123;</span><br><span class="line">                    &quot;IPAMConfig&quot;: null,</span><br><span class="line">                    &quot;Links&quot;: null,</span><br><span class="line">                    &quot;Aliases&quot;: null,</span><br><span class="line">                    &quot;NetworkID&quot;: &quot;7e7119e437a1e69833d5325030ff480c21257adb02543e0ee3e31010cc60e424&quot;,</span><br><span class="line">                    &quot;EndpointID&quot;: &quot;e563118b1a8af58979bc244e925b2d826334cca6daadf60763612c2c271d1f7c&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">                    &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">                    &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">                    &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">                    &quot;DriverOpts&quot;: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line">[proton@proton-pc ~]$ </span><br></pre></td></tr></table></figure>

<h4 id="进入当前正在运行的容器"><a href="#进入当前正在运行的容器" class="headerlink" title="进入当前正在运行的容器"></a>进入当前正在运行的容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">我们通常是使用后台的方式运行的，需要进入容器，修改一些配置</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">命令</span></span><br><span class="line">docker exec -it 容器ID bashShell</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it d084a3f8133d /bin/bash </span><br><span class="line">[root@d084a3f8133d /]# ps</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">  992 pts/0    00:00:00 bash</span><br><span class="line"> 1005 pts/0    00:00:00 ps</span><br><span class="line">[root@d084a3f8133d /]# ps -ef</span><br><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">root         1     0  0 23:13 ?        00:00:00 /bin/sh -c while true;do echo hihao;sleep 1;done</span><br><span class="line">root       992     0  0 23:30 pts/0    00:00:00 /bin/bash</span><br><span class="line">root      1014     1  0 23:30 ?        00:00:00 sleep 1</span><br><span class="line">root      1015   992  0 23:30 pts/0    00:00:00 ps -ef</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">方式二</span></span><br><span class="line">docker attach 容器ID </span><br><span class="line"><span class="meta">#</span><span class="bash">正在执行当前的代码……</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">docker <span class="built_in">exec</span>	<span class="comment">#进入容器后开启一个新的终端，可以在里面操作，（常用）</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">docker attach	<span class="comment">#进入容器正在执行的终端</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="从容器内拷贝文件到主机上"><a href="#从容器内拷贝文件到主机上" class="headerlink" title="从容器内拷贝文件到主机上"></a>从容器内拷贝文件到主机上</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">docker cp 容器id:容器内路径，目的主机路径</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看当前主机目录下文件</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE       COMMAND       CREATED         STATUS         PORTS     NAMES</span><br><span class="line">8fd4c9c0d2cc   archlinux   &quot;/bin/bash&quot;   2 minutes ago   Up 2 minutes             gallant_goldstine</span><br><span class="line"><span class="meta">#</span><span class="bash">进入正在运行的docker容器内部</span></span><br><span class="line">[proton@proton-pc ~]$ docker attach 8fd4c9c0d2cc</span><br><span class="line">[root@8fd4c9c0d2cc /]# cd /home</span><br><span class="line">[root@8fd4c9c0d2cc home]# ls</span><br><span class="line"><span class="meta">#</span><span class="bash">在容器内新建一个文件</span></span><br><span class="line">[root@8fd4c9c0d2cc home]# touch test.java</span><br><span class="line">[root@8fd4c9c0d2cc home]# exit</span><br><span class="line">exit</span><br><span class="line">[proton@proton-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line">[proton@proton-pc ~]$ docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE       COMMAND       CREATED         STATUS                      PORTS     NAMES</span><br><span class="line">8fd4c9c0d2cc   archlinux   &quot;/bin/bash&quot;   4 minutes ago   Exited (0) 24 seconds ago             gallant_goldstine</span><br><span class="line"><span class="meta">#</span><span class="bash">将docker容器内的文件拷贝出来，到主机上，</span></span><br><span class="line">[proton@proton-pc ~]$ docker cp 8fd4c9c0d2cc:/home/test.java ./    </span><br><span class="line">[proton@proton-pc ~]$ ls</span><br><span class="line">test.java  test.txt</span><br><span class="line">[proton@proton-pc ~]$ </span><br><span class="line"><span class="meta">#</span><span class="bash">拷贝是一个手动的过程。未来我们采用 -v 卷的技术可以实现</span></span><br></pre></td></tr></table></figure>



<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p><img src="/2021/09/22/Docker-notes/image-20210920200126977.png" alt="image-20210920200126977"></p>
<p>相关的命令可以通过参考下面的。</p>
<p>接下来是一些练习。</p>
<h3 id="作业练习"><a href="#作业练习" class="headerlink" title="作业练习"></a>作业练习</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Doker 安装 Nginx</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1、搜素镜像 search  建议去dockerhub上搜素 可以看到详细信息。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">2、下载镜像 pull</span></span><br><span class="line"><span class="meta">#</span><span class="bash">3、运行测试</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看镜像</span></span><br><span class="line">[proton@proton-pc ~]$ docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">nginx         latest    ad4c705f24d3   10 days ago    133MB</span><br><span class="line">mysql         latest    0716d6ebcc1a   2 weeks ago    514MB</span><br><span class="line">archlinux     latest    1d6f90387c13   2 weeks ago    381MB</span><br><span class="line">hello-world   latest    d1165f221234   6 months ago   13.3kB</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -d 后台运行</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> --name 给容器起名字</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -p 宿主机端口:容器内部端口</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker run -d --name nginx01 -p:3344:80 nginx</span><br><span class="line">27d6eeb14afcd7ba05975dd1ad18881a3ae29715bd0a715e9e8607be88170a6d</span><br><span class="line">[proton@proton-pc ~]$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS                                   NAMES</span><br><span class="line">27d6eeb14afc   nginx     &quot;/docker-entrypoint.…&quot;   6 seconds ago   Up 5 seconds   0.0.0.0:3344-&gt;80/tcp, :::3344-&gt;80/tcp   nginx01</span><br><span class="line">[proton@proton-pc ~]$ curl localhost:3344</span><br><span class="line"><span class="meta">#</span><span class="bash">测试通过</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">进入容器</span></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it nginx01 /bin/bash</span><br><span class="line">root@27d6eeb14afc:/# whereis nginx</span><br><span class="line">nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx</span><br><span class="line">root@27d6eeb14afc:/# cd /etc/nginx/</span><br><span class="line">root@27d6eeb14afc:/etc/nginx# ls</span><br><span class="line">conf.d          mime.types  nginx.conf   uwsgi_params</span><br><span class="line">fastcgi_params  modules     scgi_params</span><br><span class="line">root@27d6eeb14afc:/etc/nginx# </span><br></pre></td></tr></table></figure>

<h5 id="端口暴露的概念"><a href="#端口暴露的概念" class="headerlink" title="端口暴露的概念"></a>端口暴露的概念</h5><p><img src="/2021/09/22/Docker-notes/image-20210920204051023.png" alt="image-20210920204051023"></p>
<p><strong>思考问题</strong>： 我们每次修改nginx配置文件，都需要进入容器内部？？？十分的不方便，我们要是可以在容器内部提供一个映射路径，达到在容器修改文件名，容器内就可以自动修改？-v 数据卷</p>
<p>答案：通过使用  -v /user/share/nginx /usr/nginx</p>
<blockquote>
<p>作业二：docker 安装tomcat</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">官方的使用</span></span><br><span class="line">docker run -it --rm tomcat:9.0</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">我们之前都是后台启动，停止了容器后，容器还可查到。docker run -it --rm tomcat:9.0 这个一般用来测试用完即删除容器。</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">先下载，后启动</span></span><br><span class="line">docker pull tomcat</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">启动运行</span>	</span><br><span class="line">[proton@proton-pc ~]$ docker run -d -p 3355:8080 --name tomcat01 tomcat</span><br><span class="line">fe4af990f493099f2b6650f276aee86da25bd7216ac53de70df893d50a38b18f</span><br><span class="line"><span class="meta">#</span><span class="bash">已经可以访问了</span></span><br><span class="line">-p 端口映射 宿主机Port:容器Port</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">进入容器</span></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat01 /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash">发现问题 1、linux 命令少了 2、没有webapps 阿里云镜像的原因，默认是最小的，所有不必要的都剔除了。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">保证最小的运行环境。</span></span><br></pre></td></tr></table></figure>

<p><strong>思考问题：</strong> 我们以后部署项目，如果每次都进入容器是不是十分麻烦？？？我们要是可以在容器外部提供一个映射路径，webapps,</p>
<p>我们在外部放置项目，就自动同步到内部就好了！</p>
<p>docker 容器 tomcat + 网站 docker mysql </p>
<blockquote>
<p>作业3 部署es + kibana</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">es 暴露的端口很多！</span></span><br><span class="line"><span class="meta">#</span><span class="bash">es 十分耗内存</span></span><br><span class="line"><span class="meta">#</span><span class="bash">es 的数据一般需要放置到安全目录!挂载</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> --net somenetwork ? 网络配置</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">启动 elasticsearch</span></span><br><span class="line">docker run -d --name elasticsearch  -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:7.6.2</span><br><span class="line"><span class="meta">#</span><span class="bash">docker stats 查看cpu的状态，</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">es 是十分耗内存的，</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看docker stats</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">测试一下</span></span><br><span class="line">[proton@proton-pc ~]$ curl localhost:9200</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot; : &quot;b941f0a0249a&quot;,</span><br><span class="line">  &quot;cluster_name&quot; : &quot;docker-cluster&quot;,</span><br><span class="line">  &quot;cluster_uuid&quot; : &quot;Z0X-vBnCTZCXwKZi_dYDEw&quot;,</span><br><span class="line">  &quot;version&quot; : &#123;</span><br><span class="line">    &quot;number&quot; : &quot;7.6.2&quot;,</span><br><span class="line">    &quot;build_flavor&quot; : &quot;default&quot;,</span><br><span class="line">    &quot;build_type&quot; : &quot;docker&quot;,</span><br><span class="line">    &quot;build_hash&quot; : &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;,</span><br><span class="line">    &quot;build_date&quot; : &quot;2020-03-26T06:34:37.794943Z&quot;,</span><br><span class="line">    &quot;build_snapshot&quot; : false,</span><br><span class="line">    &quot;lucene_version&quot; : &quot;8.4.0&quot;,</span><br><span class="line">    &quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;,</span><br><span class="line">    &quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;tagline&quot; : &quot;You Know, for Search&quot;</span><br><span class="line">&#125;</span><br><span class="line">[proton@proton-pc ~]$ </span><br><span class="line"><span class="meta">#</span><span class="bash">赶紧停下，增加内存的限制</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/22/Docker-notes/image-20210920214128402.png" alt="image-20210920214128402"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">赶紧关闭，增加内存限制，修改配置文 -e 环境配置修改</span></span><br><span class="line">docker run -d --name elasticsearch02  -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; -e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot; elasticsearch:7.6.2</span><br><span class="line">docker stats</span><br><span class="line"></span><br><span class="line">CONTAINER ID   NAME              CPU %     MEM USAGE / LIMIT     MEM %     NET I/O     BLOCK I/O    PIDS</span><br><span class="line">22d837c5bc64   elasticsearch02   2.59%     350.4MiB / 3.349GiB   10.22%    666B / 0B   0B / 729kB   45</span><br><span class="line">^C</span><br><span class="line">[proton@proton-pc ~]$ </span><br><span class="line"><span class="meta">#</span><span class="bash">测试成功了</span></span><br><span class="line">[proton@proton-pc ~]$ curl localhost:9200</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot; : &quot;22d837c5bc64&quot;,</span><br><span class="line">  &quot;cluster_name&quot; : &quot;docker-cluster&quot;,</span><br><span class="line">  &quot;cluster_uuid&quot; : &quot;1EhZDfWjTZCtNqgiloiMCw&quot;,</span><br><span class="line">  &quot;version&quot; : &#123;</span><br><span class="line">    &quot;number&quot; : &quot;7.6.2&quot;,</span><br><span class="line">    &quot;build_flavor&quot; : &quot;default&quot;,</span><br><span class="line">    &quot;build_type&quot; : &quot;docker&quot;,</span><br><span class="line">    &quot;build_hash&quot; : &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;,</span><br><span class="line">    &quot;build_date&quot; : &quot;2020-03-26T06:34:37.794943Z&quot;,</span><br><span class="line">    &quot;build_snapshot&quot; : false,</span><br><span class="line">    &quot;lucene_version&quot; : &quot;8.4.0&quot;,</span><br><span class="line">    &quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;,</span><br><span class="line">    &quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;tagline&quot; : &quot;You Know, for Search&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>作业： 使用kibana 链接我们的 elasticsearch 思考网路如何连过去。</p>
</blockquote>
<p><img src="/2021/09/22/Docker-notes/image-20210920215749543.png" alt="image-20210920215749543"></p>
<h3 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h3><ul>
<li>portainer (先用这个)</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8088:9000 \</span><br><span class="line"> --restart always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>

<ul>
<li>Rancher(CI/CD)</li>
</ul>
<p><strong>什么是portaniner?</strong></p>
<p>Docker 图形化界面管理工具，提供一个后台面板提供给我们使用操作！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8088:9000 \</span><br><span class="line"> --restart always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>

<p>访问测试： <a target="_blank" rel="noopener" href="http://173.82.54.177:8088/">http://173.82.54.177:8088/</a></p>
<p>通过他来访问</p>
<p><img src="/2021/09/22/Docker-notes/image-20210921005349991.png" alt="image-20210921005349991"></p>
<p>设置密码，就可以登录了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">admin</span><br><span class="line"></span><br><span class="line">docker123456</span><br></pre></td></tr></table></figure>



<p>选择本地的</p>
<p>登录进去后</p>
<p><img src="/2021/09/22/Docker-notes/image-20210921005757086.png" alt="image-20210921005757086"></p>
<p>可视化面板测试，玩玩就可以了 。</p>
<h2 id="Docker-镜像讲解"><a href="#Docker-镜像讲解" class="headerlink" title="Docker 镜像讲解"></a>Docker 镜像讲解</h2><h3 id="镜像是什么"><a href="#镜像是什么" class="headerlink" title="镜像是什么"></a>镜像是什么</h3><h3 id="Docker镜像加载原理"><a href="#Docker镜像加载原理" class="headerlink" title="Docker镜像加载原理"></a>Docker镜像加载原理</h3><h3 id="Docker-分层原理"><a href="#Docker-分层原理" class="headerlink" title="Docker 分层原理"></a>Docker 分层原理</h3><h3 id="Docker-commit-镜像"><a href="#Docker-commit-镜像" class="headerlink" title="Docker commit 镜像"></a>Docker commit 镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker commit #提交容器为一个新的副本</span><br><span class="line">docker commit -m=&quot;提交的描述信息&quot; -a=&quot;作者&quot; 容器ID 目标镜像名:[tag]</span><br></pre></td></tr></table></figure>

<p>实战测试</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1、启动一个默认的tomcat</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">2、发现这个默认的tomcat 是没有webapps应用的，镜像的原因，官方的镜像默认webapps下是没有文件的</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">3、我自己拷贝进去了基本的文件</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">4、将我们操作过的容器通过commit 提交为一个镜像，我们以后就使用我们修改过后的镜像即可这就是我们自己的一个修改的镜像</span></span><br><span class="line">[proton@proton-pc ~]$ docker commit -a=&quot;zsz&quot; -m=&quot;add webapps app&quot;  834fa0b1163f tomcat02</span><br><span class="line">sha256:cdb85d573e3f93bf8f00cf2e1b3535d006d52f75cfa76464e2615dabb97f788a</span><br><span class="line">[proton@proton-pc ~]$ docker images</span><br><span class="line">REPOSITORY            TAG       IMAGE ID       CREATED          SIZE</span><br><span class="line">tomcat02              latest    cdb85d573e3f   15 seconds ago   684MB</span><br><span class="line">tomcat                9.0       62146f8bda84   6 days ago       680MB</span><br><span class="line">tomcat                latest    bb832de23021   6 days ago       680MB</span><br></pre></td></tr></table></figure>

<p>如果你想要保存当前的容器镜状态，就可以通过commit来提交，并获得一个镜像。</p>
<p>入门 docker 了 哈哈</p>
<p>接下来才比较重要，</p>
<h2 id="容器数据卷"><a href="#容器数据卷" class="headerlink" title="容器数据卷"></a>容器数据卷</h2><h3 id="什么是容器数据卷"><a href="#什么是容器数据卷" class="headerlink" title="什么是容器数据卷"></a>什么是容器数据卷</h3><p>docker 的理念回顾</p>
<p>将应用和环境打包成一个镜像！</p>
<p>数据！ 如果数据都存在容器中，那么我们把容器删除了，数据就会丢失！！ 需求：数据可以持久化</p>
<p>Mysql容器删了 删库跑路了，！需求：MYSQL数据可以存储在本地</p>
<p>容器之间可以有一个数据共享的技术！docker 容器中产生的数据同步到本地！</p>
<p>这就是卷技术！目录的挂载，将我们容器内的目录挂载到linux 上</p>
<img src="/2021/09/22/Docker-notes/image-20210921035055665.png" alt="image-20210921035055665" style="zoom:150%;">

<p><strong>总结一句话，容器的持久化和同步操作! 容器间也是可以共享的</strong></p>
<h4 id="使用数据卷"><a href="#使用数据卷" class="headerlink" title="使用数据卷"></a>使用数据卷</h4><blockquote>
<p>方式一：直接使用命令来挂载 -v</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -v 主机目录，容器内目录 </span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -it -v /home/ceshi:/home archlinux /bin/bash</span><br><span class="line">[root@6e15453d4aad /]#</span><br><span class="line"><span class="meta">#</span><span class="bash">启动之后我们可以通过docker inspect 容器ID</span> </span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210921040320685.png" alt="image-20210921040320685" style="zoom: 200%;">

<p>测试结果：</p>
<img src="/2021/09/22/Docker-notes/image-20210921041233923.png" alt="image-20210921041233923" style="zoom:150%;">

<p>继续测试：</p>
<ol>
<li>停止容器</li>
<li>在宿主机上修改文件，</li>
<li>再次启动容器</li>
<li>容器内的数据依旧是同步的</li>
</ol>
<img src="/2021/09/22/Docker-notes/image-20210921042016622.png" alt="image-20210921042016622" style="zoom:150%;">

<p><strong>好处：</strong> 我们以后只需要在本地修改即可，容器内部会自动同步！</p>
<h4 id="实战：安装MySQL"><a href="#实战：安装MySQL" class="headerlink" title="实战：安装MySQL"></a>实战：安装MySQL</h4><p>思考：MySQL的数据持久化问题！ data</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">下载获取镜像</span></span><br><span class="line">[proton@proton-pc ~]$ docker pull mysql:5.7</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">运行容器，需要做数据挂在出来 <span class="comment">#安装启动mysql，需要配置密码的，这是需要注意的</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">官方的测试 ：自己去dockerhub上查吧。</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">启动我们的</span></span><br><span class="line">-d 后台运行</span><br><span class="line">-p 端口映射 宿主机Port:容器Port</span><br><span class="line">-v 卷挂载</span><br><span class="line">-e 环境配置</span><br><span class="line">--name 容器名字</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#挂载卷的第1种方式 没有挂载</span></span></span><br><span class="line">docker run -d -p 3310:3306 -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash">测试结果</span></span><br><span class="line">proton@proton-pc ~]$ docker exec -it mysql01 /bin/bash</span><br><span class="line"></span><br><span class="line">docker-entrypoint-initdb.d  lib64  root  tmp</span><br><span class="line">entrypoint.sh               media  run   usr</span><br><span class="line">root@75371f75d00a:/# ls /etc/mysql/</span><br><span class="line">conf.d  my.cnf  my.cnf.fallback  mysql.cnf  mysql.conf.d</span><br><span class="line">root@75371f75d00a:/# ls /etc/mysql/conf.d/</span><br><span class="line">docker.cnf  mysql.cnf  mysqldump.cnf</span><br><span class="line">root@75371f75d00a:/# </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#挂载卷的第2种方式 错误的挂载路径</span></span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql02 mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash">测试结果</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/22/Docker-notes/image-20210921054047460.png" alt="image-20210921054047460"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#挂载卷的第3种方式</span></span>   </span><br><span class="line"><span class="meta">#</span><span class="bash">---错误的挂载路径---</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker run -d -p 3310:3306 -v /home/mysql_1/conf:/etc/mysql -v /home/mysql_1/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql03 mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash">结果</span></span><br><span class="line"></span><br><span class="line">root@6dab0da4b788:/etc# cd mysql/</span><br><span class="line">root@6dab0da4b788:/etc/mysql# ls</span><br><span class="line">root@6dab0da4b788:/etc/mysql# 		#docker 容器下的/etc/mysql 文件被清空了 </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">说明：</span></span><br><span class="line"><span class="meta">#</span><span class="bash">第一个容器 mysql01 没有进行卷挂载，所以在上面的测试结果中的数据就是原始的/etc/mysql/ 展示</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">第二个容器 mysql02 的配置文件挂载错了（待确认），/home/mysql/conf:/etc/mysql/conf.d 这里的关于容器中的mysql的配置文件写错了，挂载的conf.d目录不是配置文件。因为/home/mysql/conf目录是空的，所以卷挂载之后后把容器中的/etc/mysql/conf.d目录清空。</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">第三个容器，mysql02 我把卷挂载是 -v /home/mysql_1/conf:/etc/mysql 会清空容器中的/etc/mysql/ 与第二个容器 mysql02 配置的清空文件的原因一样，因为宿主机的/home/mysql_1/conf是空的 所以把容器中的/etc/mysql/ 清空</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">###正确的方法</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">1、首先把容器中的/etc/mysql/ 的文件复制到宿主机的将要挂载卷的目录/home/mysql_1，</span></span><br><span class="line"><span class="meta">#</span><span class="bash">2、挂载卷 -v /home/mysql_1/conf:/etc/mysql</span> </span><br><span class="line">这样就可以避免清空容器中的文件夹了</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">启动之后，我们载本地使用sqlyog来测试一下</span></span><br><span class="line"><span class="meta">#</span><span class="bash">sqlyog连接到我们的服务器的3310 --------- 3310 和容器内的3306映射，这个时候我们就可以连接上了！</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"></span><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">在本地测试创建一个数据库，查看一下我们映射的路径是否ok</span></span><br></pre></td></tr></table></figure>

<p>假设我们把容器删除掉，发现，我们挂载到本地的数据卷依旧没有丢失，这就实现了容器数据库持久化功能！</p>
<p><img src="/2021/09/22/Docker-notes/image-20210921060249061.png" alt="image-20210921060249061"></p>
<h4 id="具名和匿名挂载"><a href="#具名和匿名挂载" class="headerlink" title="具名和匿名挂载"></a>具名和匿名挂载</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">匿名挂载</span></span><br><span class="line">-v	容器内路径！</span><br><span class="line"></span><br><span class="line">docker run -d  -P --name nginx -v /etc/nginx nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">查看所有的volume 的情况</span></span><br><span class="line">[proton@proton-pc ~]$ docker volume ls</span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     5f83d09c51514204f0602da485db09988af6648d97a944dd370f6e1ae0a12d4e</span><br><span class="line"><span class="meta">#</span><span class="bash">这里发现，这种匿名挂载 我们在 -v 只写了容器内的路径，没有写容器外的路径</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker volume ls</span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     juming-nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">通过 -v 卷名：容器内路径</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d  -P --name nginx02 -v juming-nginx:/etc/nginx nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">查看一下这个卷</span></span><br><span class="line">[proton@proton-pc ~]$ docker volume inspect juming-nginx</span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210921233158543.png" alt="image-20210921233158543" style="zoom:200%;">

<p>所有的docker容器内的卷，没有指定目录的情况下都是在 <strong><code>/var/lib/docker/volume/xxx/_data</code></strong></p>
<p>我们通过具名挂载可以方便的找到一个卷，大多数情况使用 <strong>具名挂载</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">如何确定是具名挂载，还是匿名挂载，还是指定路径挂载</span></span><br><span class="line">-v	容器内路径！	  #匿名挂载</span><br><span class="line">-v 卷名：			#容器内路径</span><br><span class="line">-v /宿主机路径:容器内路径	#指定路径挂载</span><br></pre></td></tr></table></figure>

<p>拓展：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">通过 -v 容器内路径， ro  rw 改变读写权限</span></span><br><span class="line">ro readonly	  #只读</span><br><span class="line">rw read write #可读可写</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">一旦设置了这个容器权限，容器对我们挂载出来的内容就有限定了</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d  -P --name nginx02 -v juming-nginx:/etc/nginx:ro nginx  </span><br><span class="line">[proton@proton-pc ~]$ docker run -d  -P --name nginx02 -v juming-nginx:/etc/nginx:rw nginx  </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">ro 只要看到这个ro就说明这个路径只能通过宿主机来操作，容器内部是无法操作的</span></span><br></pre></td></tr></table></figure>



<h4 id="初识Dockerfile"><a href="#初识Dockerfile" class="headerlink" title="初识Dockerfile"></a>初识Dockerfile</h4><p>Dockerfile 就是用来构建docker 镜像的构建文件！命令脚本！</p>
<p>通过这个脚本可以生成一个镜像。</p>
<p>#测试<br>[proton@proton-pc docker-test-volume]$ vim dockerfile1</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">创建一个dockerfile 文件，名字可以随机，建议 Dockerfile</span></span><br><span class="line"><span class="meta">#</span><span class="bash">文件中的内容 指令（大写） 参数</span></span><br><span class="line"></span><br><span class="line">FROM centos</span><br><span class="line"></span><br><span class="line">VOLUME [&quot;volume01&quot;,&quot;volume02&quot;]</span><br><span class="line"></span><br><span class="line">CMD echo &quot;-----end----&quot;</span><br><span class="line">CMD /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash">这里的每个名令，就是镜像的一层。</span></span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210922000606724.png" alt="image-20210922000606724" style="zoom:150%;">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">启动自己写的镜像</span></span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210922001310644.png" alt="image-20210922001310644" style="zoom:150%;">

<p>这个卷外部一定有一个同步的目录！</p>
<img src="/2021/09/22/Docker-notes/image-20210922002541829.png" alt="image-20210922002541829" style="zoom:150%;">

<p>查看一下卷挂载的路径</p>
<p><img src="/2021/09/22/Docker-notes/image-20210922002120951.png" alt="image-20210922002120951"></p>
<p>测试一下刚才的文件是否同步出去了</p>
<p>这种方式我们未来使用的非常多，因为我们通常会构建自己的镜像！</p>
<p>假设构建的时候没有挂载卷，要手动挂载 -v 卷名:容器内路径</p>
<h4 id="数据卷容器"><a href="#数据卷容器" class="headerlink" title="数据卷容器"></a>数据卷容器</h4><p>多个mysql同步数据</p>
<img src="/2021/09/22/Docker-notes/image-20210922003031848.png" alt="image-20210922003031848" style="zoom:150%;">

<p>#启动3个容器，通过我们刚才自己写的镜像启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc _data]$ docker run -it --name docker01 zsz/centos:1.0 </span><br><span class="line">[proton@proton-pc _data]$ docker run -it --name docker02 --volumes-from docker01 zsz/centos:1.0 </span><br><span class="line">[proton@proton-pc _data]$ docker run -it --name docker03 --volumes-from docker01 zsz/centos:1.0 </span><br></pre></td></tr></table></figure>

<img src="/2021/09/22/Docker-notes/image-20210922003413944.png" alt="image-20210922003413944" style="zoom:150%;">



<p><img src="/2021/09/22/Docker-notes/image-20210922004130868.png" alt="image-20210922004130868"></p>
<img src="/2021/09/22/Docker-notes/image-20210922004255766.png" alt="image-20210922004255766" style="zoom:150%;">

<p>只要通过 –volumes-from 就可以实现容器间的数据共享</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">测试，可以删除docker01 ，查看一下docker02和docker03是否还可以访问文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash">测试结果依旧可以访问</span></span><br></pre></td></tr></table></figure>



<p><img src="/2021/09/22/Docker-notes/image-20210922005501643.png" alt="image-20210922005501643"></p>
<p>就是拷贝的概念</p>
<p>多个mysql 实现数据共享</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker run -d -p 3310:3306 -e MYSQL_ROOT_PASSWORD=123456 --name mysql02 --volumes-from mysql01 mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash">这个时候可以实现两个容器数据的同步</span></span><br></pre></td></tr></table></figure>

<p><strong>结论：</strong></p>
<p>容器之间的配置信息的传递，数据卷的生命周期一直持续到没有容器使用为止</p>
<p>但是一旦持久化到了本地，这个时候，本地的数据是不会删除的</p>
<h2 id="DockerFile"><a href="#DockerFile" class="headerlink" title="DockerFile"></a>DockerFile</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>Dockerfile 就是用来构建docker 镜像的构建文件！命令脚本！</p>
<p>通过这个脚本可以生成一个镜像。</p>
<p>构建步骤：</p>
<ol>
<li>编写一个dockerfile 文件</li>
<li>docker build 构建一个镜像</li>
<li>docker run 运行镜像</li>
<li>docker push 发布镜像（dockerHub、阿里云镜像仓库）</li>
</ol>
<h3 id="DockerFile-构建过程"><a href="#DockerFile-构建过程" class="headerlink" title="DockerFile 构建过程"></a>DockerFile 构建过程</h3><h4 id="基础指令"><a href="#基础指令" class="headerlink" title="基础指令"></a>基础指令</h4><ol>
<li>每个保留关键字（指令）都必须是大写字母</li>
<li>执行从上到下顺序执行的</li>
<li>#表示注释</li>
<li>每一个指令都会创建一个新的镜像层，并提交。</li>
</ol>
<p><img src="/2021/09/22/Docker-notes/u=1982640279,3003728739&fm=26&fmt=auto.png" alt="https://img2.baidu.com/it/u=1982640279,3003728739&amp;fm=26&amp;fmt=auto"></p>
<p>dockerfile 是面向开发的，我们以后要发布项目，做镜像，就需要编写dockerfile文件，这个文件十分简单！</p>
<p>Docker镜像，逐渐成为了一个企业交付的标准，必须掌握</p>
<p>步骤：开发、部署、运维     缺一不可1</p>
<p>DockerFile : 构建文件，定义了一切的步骤，源代码</p>
<p>DockerImages: 通过DockerFile 构建生成的镜像，最终发布和运行产品</p>
<p>Docker容器： 容器就是镜像运行起来提供服务器。</p>
<h4 id="DockerFile-指令："><a href="#DockerFile-指令：" class="headerlink" title="DockerFile 指令："></a>DockerFile 指令：</h4><p>以前的话，我们用别人的，现在我们知道了这些后，我们来练习自己写一个镜像！！！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">FROM			#基础镜像，一切从这里开始构建</span><br><span class="line">MAINTAINER		#镜像是谁写的，姓名+邮箱</span><br><span class="line">RUN				#镜像构建的时候需要运行的命令</span><br><span class="line">ADD				#步骤，tomcat镜像，这个tomcat压缩包！添加内容</span><br><span class="line">WORKDIR			#镜像的工作目录</span><br><span class="line">VOLUME			#挂载的目录</span><br><span class="line">EXPOSE			#之对外开放的端口</span><br><span class="line">CMD				#指定这个容器启动的时候需要运行的命令，只有最后一个会生效，可被替代。</span><br><span class="line">ENTRYPOINT		#指定这个容器启动的时候运行的命令，可以追加命令</span><br><span class="line">ONBUILD			#当构建一个被继承 DOckerFile 这个就会运行ONBULID 的指令，触发指令</span><br><span class="line">COPY			#类似ADD 将文件拷贝到镜像中</span><br><span class="line">ENV				#构建的时候设置环境变量！</span><br><span class="line">		</span><br></pre></td></tr></table></figure>



<img src="/2021/09/22/Docker-notes/u=3010872685,2996850938&fm=26&fmt=auto.jpeg" alt="点击查看源网页" style="zoom:150%;">

<h4 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h4><p>Docker Hub 中99%的镜像都是从这个基础镜像过来的，FROM scratch,然后配置需要的软件来进行构建</p>
<img src="/2021/09/22/Docker-notes/image-20210922035715666.png" alt="image-20210922035715666" style="zoom:150%;">

<blockquote>
<p>创建一个自己的centos</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1、编写dockerfile的文件</span></span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER zsz&lt;2668838984@qq.com&gt;</span><br><span class="line"></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line"></span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line">RUN yum -y install vim</span><br><span class="line">RUN yum -y install net-tools</span><br><span class="line"></span><br><span class="line">EXPOSE 80</span><br><span class="line">CMD echo $MYPATH</span><br><span class="line"></span><br><span class="line">CMD echo &quot;-----end--------&quot;</span><br><span class="line">CMD /bin/bash</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">2、通过这个文件构建镜像</span></span><br><span class="line"><span class="meta">#</span><span class="bash">命令 docker build -f dockerfile文件路径 -t 镜像名:[tag] 路径</span></span><br><span class="line">Successfully built 66e9e5ddaacb</span><br><span class="line">Successfully tagged mycentos:0.1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">3、测试运行</span></span><br><span class="line">docker </span><br></pre></td></tr></table></figure>

<p>对比测试：</p>
<p>官方的镜像：</p>
<img src="/2021/09/22/Docker-notes/image-20210922042547316.png" alt="image-20210922042547316" style="zoom: 200%;">

<p>我们增加后的镜像</p>
<img src="/2021/09/22/Docker-notes/image-20210922042814743.png" alt="image-20210922042814743" style="zoom:150%;">

<p>我们可以列出本地镜像的变更历史</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker history 镜像ID</span><br></pre></td></tr></table></figure>



<img src="/2021/09/22/Docker-notes/image-20210922043212151.png" alt="image-20210922043212151" style="zoom:150%;">

<p>我们平时拿到一个镜像可以研究一下人家是怎么做的？？？</p>
<blockquote>
<p>CMD 和 ENTRYPOINT 的区别    </p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CMD				#指定这个容器启动的时候需要运行的命令，只有最后一个会生效，可被替代。</span><br><span class="line">ENTRYPOINT		#指定这个容器启动的时候运行的命令，可以追加命令</span><br></pre></td></tr></table></figure>

<p>测试CMD</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">编写dockerfile 文件</span></span><br><span class="line">[proton@proton-pc dockerfile]$ vim dockerfile-cmd-test</span><br><span class="line">FROM centos</span><br><span class="line">CMD [&quot;ls&quot;,&quot;-a&quot;]</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">构建镜像</span></span><br><span class="line">[proton@proton-pc dockerfile]$ docker build -f dockerfile-cmd-test -t cmdtest .</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">run 运行	发现我们的ls -a 命令生效了</span></span><br><span class="line">[proton@proton-pc dockerfile]$ docker run 19232586cb36</span><br><span class="line">.</span><br><span class="line">..</span><br><span class="line">.dockerenv</span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">lost+found</span><br><span class="line">media</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">想追加一个命令 -l  ls -al</span></span><br><span class="line">[proton@proton-pc dockerfile]$ docker run 19232586cb36 -l</span><br><span class="line">docker: Error response from daemon: OCI runtime create failed: container_linux.go:380: starting container process caused: exec: &quot;-l&quot;: executable file not found in $PATH: unknown.</span><br><span class="line">ERRO[0000] error waiting for container: context canceled </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">cmd 的情况下 -l 替换了CMD [<span class="string">&quot;ls&quot;</span>,<span class="string">&quot;-a&quot;</span>] 命令 -l 不是命令所以报错</span></span><br><span class="line">[proton@proton-pc dockerfile]$ docker run 19232586cb36 ls -al</span><br><span class="line">total 56</span><br><span class="line">drwxr-xr-x   1 root root 4096 Sep 21 20:46 .</span><br><span class="line">drwxr-xr-x   1 root root 4096 Sep 21 20:46 ..</span><br><span class="line">-rwxr-xr-x   1 root root    0 Sep 21 20:46 .dockerenv</span><br><span class="line">lrwxrwxrwx   1 root root    7 Nov  3  2020 bin -&gt; usr/bi</span><br><span class="line">[proton@proton-pc dockerfile]$ </span><br></pre></td></tr></table></figure>

<p>测试ENTRYPOINT</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Successfully built 49ec35d65e13</span><br><span class="line">Successfully tagged entrypoint-test:latest</span><br><span class="line">[proton@proton-pc dockerfile]$ docker run 49ec35d65e13</span><br><span class="line">.</span><br><span class="line">..</span><br><span class="line">.dockerenv</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">……</span><br><span class="line">proc</span><br><span class="line">var</span><br><span class="line"><span class="meta">#</span><span class="bash">我们的追加命令，是直接拼接在我们的ENTRYPOINT 之后的</span></span><br><span class="line">[proton@proton-pc dockerfile]$ docker run 49ec35d65e13 -l</span><br><span class="line">total 56</span><br><span class="line">drwxr-xr-x   1 root root 4096 Sep 21 20:51 .</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 home</span><br></pre></td></tr></table></figure>

<p>DockerFile 中很多命令都是十分相似的，我们需要了解它们的区别，我们最好学习的方式就是对比他们然后测试效果！！！</p>
<h4 id="实战：Tomcate"><a href="#实战：Tomcate" class="headerlink" title="实战：Tomcate"></a>实战：Tomcate</h4><ol>
<li><p>准备镜像文件tomcat 压缩包，jdk压缩包！</p>
</li>
<li><p>编写dockerfile文件  官方命名 Dockerfile build会自动寻找这个文件，就不需要-f 指定了！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">vim Dockerfile </span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER ZSZ&lt;2668838984@qq.com&gt;</span><br><span class="line">COPY readme.txt /usr/local/readme.txt</span><br><span class="line"></span><br><span class="line">ADD jdk-8u11-linux-64.tar.gz /usr/local/</span><br><span class="line">ADD apache-tomcat-9.022.tar.gz /usr/local/</span><br><span class="line"></span><br><span class="line">RUN yum -y nstall vim </span><br><span class="line">EVN MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line">ENV JAVA_HOME /usr/local/jdk1.8.0_11</span><br><span class="line">ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line">ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.22</span><br><span class="line">ENV CATALINA_BASH /usr/local/apache-tomcat-9.0.22</span><br><span class="line">ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin</span><br><span class="line"></span><br><span class="line">EXPOSE 8080</span><br><span class="line"></span><br><span class="line">CMD /usr/local/apache-tomcat-9.0.22/bin/startup.sh &amp;&amp; tail -F /usr/local/apache-tomcat-9.0.22/bin/logs/catalina.out</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>构建镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t diytomcat .</span><br></pre></td></tr></table></figure></li>
<li><p>启动镜像</p>
</li>
<li><p>访问测试</p>
</li>
<li><p>发布项目（由于做了卷挂载，我们直接本地编写项目）</p>
</li>
</ol>
<p>发现，项目部署成功，可以直接访问ok!</p>
<p>我们以后开发的步骤：需要掌握 Dockerfile 的编写，！我们之后的一切都是使用docker镜像发布运行。</p>
<h4 id="发布自己的镜像"><a href="#发布自己的镜像" class="headerlink" title="发布自己的镜像"></a>发布自己的镜像</h4><blockquote>
<p>DockerHub</p>
</blockquote>
<ol>
<li><p>注册账号 地址dockerhub</p>
</li>
<li><p>确定这个账号可以登录</p>
</li>
<li><p>在我们的服务器上提交自己的镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc dockerfile]$ docker login --help</span><br><span class="line"></span><br><span class="line">Usage:  docker login [OPTIONS] [SERVER]</span><br><span class="line"></span><br><span class="line">Log in to a Docker registry.</span><br><span class="line">If no server is specified, the default is defined by the daemon.</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -p, --password string   Password</span><br><span class="line">      --password-stdin    Take the password from stdin</span><br><span class="line">  -u, --username string   Username</span><br><span class="line">[proton@proton-pc dockerfile]$ </span><br></pre></td></tr></table></figure></li>
<li><p>登录完成之后就可以提交镜像了，就是一步，docker push </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker login -u zsz</span><br><span class="line">password:*********</span><br><span class="line"></span><br><span class="line">login succeeded</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">push 自己的镜像到服务器上</span></span><br><span class="line"><span class="meta">#</span><span class="bash">这个命令有问题，再去测试</span></span><br><span class="line">docker push diytomcat</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<p>提交也是按照镜像的层级来的</p>
<blockquote>
<p>阿里云镜像服务上</p>
</blockquote>
<ol>
<li>登录阿里云</li>
<li>找到容器镜像服务</li>
<li>创建命名空</li>
<li>创建容器镜像</li>
<li>浏览一下信息</li>
</ol>
<p>阿里云容器镜像就参考官方地址！！！</p>
<h4 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h4><p><img src="Docker-notes/src=http://www.itdaan.com/i/815ca090f9f8f6360ec657afbe5118b41.jpg&refer=http://www.itdaan.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg" alt="点击查看源网页"></p>
<h2 id="Docker-网络"><a href="#Docker-网络" class="headerlink" title="Docker 网络"></a>Docker 网络</h2><h3 id="理解网络-docker0"><a href="#理解网络-docker0" class="headerlink" title="理解网络 docker0"></a>理解网络 docker0</h3><p>清空所有镜像与容器</p>
<blockquote>
<p>测试</p>
</blockquote>
<p><img src="/2021/09/22/Docker-notes/image-20210922170008938.png" alt="image-20210922170008938"></p>
<p>三个网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">问题： docker 是如何处理容器网络访问的？？</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/22/Docker-notes/image-20210922170345497.png" alt="image-20210922170345497"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker run -d -P --name tomcat01 tomcat</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看容器内部网络地址 ip addr 发现容器启动的时候会得到一个 ip 地址 这个是docker 分配的，</span></span><br><span class="line"><span class="meta">#</span><span class="bash">新版的tomcat 没有net-tools</span></span><br><span class="line"><span class="meta">#</span><span class="bash">进入容器</span></span><br><span class="line">docker exec -it tomcat01 /bin/bash </span><br><span class="line"><span class="meta">#</span><span class="bash">查看 ip</span></span><br><span class="line">root@9b24dec363f6:/usr/local/tomcat# cat /etc/hosts </span><br><span class="line">127.0.0.1       localhost</span><br><span class="line">::1     localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0 ip6-localnet</span><br><span class="line">ff00::0 ip6-mcastprefix</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line">172.17.0.2      9b24dec363f6</span><br><span class="line"><span class="meta">#</span><span class="bash">更新软件列表</span></span><br><span class="line">root@9b24dec363f6:/usr/local/tomcat# apt-get update</span><br><span class="line"><span class="meta">#</span><span class="bash">安装net-tools</span></span><br><span class="line">root@9b24dec363f6:/usr/local/tomcat# apt install net-tools</span><br><span class="line"><span class="meta">#</span><span class="bash">查看IP 地址</span></span><br><span class="line">root@9b24dec363f6:/usr/local/tomcat# ifconfig </span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.2  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        ether 02:42:ac:11:00:02  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 619  bytes 8707891 (8.3 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 488  bytes 33708 (32.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line">        </span><br><span class="line"><span class="meta">#</span><span class="bash">思考Linux 能不能ping通容器</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ ping 172.17.0.2</span><br><span class="line">PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.351 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.091 ms</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">说明 Linux 可以ping 通 docker 容器内部的网络。</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>原理</p>
</blockquote>
<ol>
<li>每启动一个docker 容器， docker 就会给docker 容器分配一个IP， 我们只要安装一个docker ,就会有一个网卡 docker0 使用的是桥接模式 ，使用的技术是 evth-pair 技术！</li>
</ol>
<p>再次测试IP addr</p>
<p><img src="/2021/09/22/Docker-notes/image-20210922174354239.png" alt="image-20210922174354239"></p>
<ol start="2">
<li>再启动一个tomcat 容器测试，发现又多了一对网卡</li>
</ol>
<p><img src="/2021/09/22/Docker-notes/image-20210922174753326.png" alt="image-20210922174753326"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">我们发现这个容器带来的网卡都是一对一对的</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> evth-pair 就是一对虚拟设备接口，他们都是成对出现的，一段连接协议，一段彼此相连</span></span><br><span class="line"><span class="meta">#</span><span class="bash">正是因为这个特性 evth-pair 相当于一个桥梁，它是专门用来连接各种虚拟设备的</span></span><br><span class="line"><span class="meta">#</span><span class="bash">OpenStac 、docker 容器之间的连接，OVS 的连接，都是使用的evth-pair技术</span></span><br></pre></td></tr></table></figure>

<p>3、我们接下来测试tomcat01 ping tomcat02 ？？    </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">进入tomcat02 容器</span></span><br><span class="line">root@e7eb33e45dd4:/usr/local/tomcat# ping 172.17.0.2               </span><br><span class="line">PING 172.17.0.2 (172.17.0.2): 56 data bytes</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=0 ttl=64 time=0.383 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.105 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=7 ttl=64 time=0.127 ms</span><br><span class="line">^C--- 172.17.0.2 ping statistics ---</span><br><span class="line">8 packets transmitted, 8 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.105/0.150/0.383/0.089 ms</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">结论： 容器和容器之间是可以互相ping通的！</span></span><br></pre></td></tr></table></figure>



<img src="/2021/09/22/Docker-notes/image-20210922182425146.png" alt="image-20210922182425146" style="zoom:150%;">

<p>结论： tomcat01 和 tomcat02 是公用一个路由器，docker0;</p>
<p>所有的容器不指定网路的情况下，都是由docker0路由的，docker会给我们的容器分配一个默认的可用IP</p>
<ol start="255">
<li>255.0.1/16 域 局域网</li>
</ol>
<blockquote>
<p>小结</p>
</blockquote>
<p>Docker 使用的是Linux 的桥接，宿主机中是一个docker容器的网桥 docker0。</p>
<p><img src="/2021/09/22/Docker-notes/image-20210922183605111.png" alt="image-20210922183605111"></p>
<p>Docker 中的所有的网络接口都是虚拟的，虚拟转发效率高！（内网传递文件）</p>
<p>只要容器删除，对应的网桥就没有了</p>
<h3 id="容器互联-–link"><a href="#容器互联-–link" class="headerlink" title="容器互联 –link"></a>容器互联 –link</h3><blockquote>
<p>思考一个场景， 我们编写一个微服，database url=ip: ,项目不重启，数据库IP换掉了，我们希望可以处理这个问题，可以通过名字来进行访问容器？？？？</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat01 ping tomcat02    </span><br><span class="line">ping: unknown host</span><br><span class="line"><span class="meta">#</span><span class="bash">如何解决？？</span></span><br><span class="line"><span class="meta">#</span><span class="bash">通过 --link 就可以解决网络联通的问题</span></span><br><span class="line">[proton@proton-pc ~]$ docker run -d -P --name tomcat03 --link tomcat02 tomcat  </span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat03 ping tomcat02                   </span><br><span class="line">PING tomcat02 (172.17.0.3): 56 data bytes</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=0 ttl=64 time=0.510 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=1 ttl=64 time=0.130 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=2 ttl=64 time=0.106 ms</span><br><span class="line">^C--- tomcat02 ping statistics ---</span><br><span class="line">3 packets transmitted, 3 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.106/0.249/0.510/0.185 ms</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">反向可以ping通吗？？？</span></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat02 ping tomcat03 </span><br><span class="line">ping: unknown host</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>探究： docker network inspect ID</p>
<p><img src="/2021/09/22/Docker-notes/image-20210922201024440.png" alt="image-20210922201024440"></p>
<p><img src="/2021/09/22/Docker-notes/image-20210922201150647.png" alt="image-20210922201150647"></p>
<p>其实这个tomcat03 就是在本地配置了tomcat02 的配置？？ </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看hosts 配置， 在这里发现原理</span></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat03 cat /ect/hosts</span><br><span class="line">cat: /ect/hosts: No such file or directory</span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat03 cat /etc/hosts</span><br><span class="line">127.0.0.1       localhost</span><br><span class="line">::1     localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0 ip6-localnet</span><br><span class="line">ff00::0 ip6-mcastprefix</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line">172.17.0.3      tomcat02 cb107366b64d</span><br><span class="line">172.17.0.4      31926070ae2f</span><br></pre></td></tr></table></figure>

<p>本质探究：–link 就是我们在hosts中增加了一个172.17.0.3 tomcat02 cb107366b64d</p>
<p>我们现在玩docker 已经不建议使用 –link了</p>
<p>自定义网路！不适用于docker0!</p>
<p>docker0的问题：他不支持容器名连接访问！</p>
<h3 id="自定义网络："><a href="#自定义网络：" class="headerlink" title="自定义网络："></a>自定义网络：</h3><p>好处:</p>
<p>redis -不同的集群使用不同的网络，保证集群的安全和健康</p>
<p>mysql-不同的集群使用不同的网络，保证集群的安全和健康</p>
<p>也可以实现容器互联；</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker network --help</span><br><span class="line"></span><br><span class="line">Usage:  docker network COMMAND</span><br><span class="line"></span><br><span class="line">Manage networks</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  connect     Connect a container to a network</span><br><span class="line">  create      Create a network</span><br><span class="line">  disconnect  Disconnect a container from a network</span><br><span class="line">  inspect     Display detailed information on one or more networks</span><br><span class="line">  ls          List networks</span><br><span class="line">  prune       Remove all unused networks</span><br><span class="line">  rm          Remove one or more networks</span><br><span class="line"></span><br><span class="line">Run &#x27;docker network COMMAND --help&#x27; for more information on a command.</span><br><span class="line">[proton@proton-pc ~]$ </span><br></pre></td></tr></table></figure>

<blockquote>
<p>查所有网络docker network ls</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">7e7119e437a1   bridge    bridge    local</span><br><span class="line">dd4111e98dbc   host      host      local</span><br><span class="line">9820f0ae0444   none      null      local</span><br></pre></td></tr></table></figure>

<p>网络模式</p>
<ul>
<li><p>bridge : 桥接模式 docker  （默认， 自己创建也是用桥接模式）</p>
</li>
<li><p>none :不配置网络</p>
</li>
<li><p>host : 和宿主机共享网络</p>
</li>
<li><p>container : 容器网络联通！（用的少，局限大）</p>
</li>
</ul>
<p><strong>测试：</strong> </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">我们直接启动的命令 --net bridge ,而这个就是我们的docker0</span></span><br><span class="line">docker run -d -P --name tomcat01 tomcat</span><br><span class="line">docker run -d -P --name tomcat01 --net bridge tomcat</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">docker0 特点，默认的，域名不能访问， --link 可以打通连接</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">我们可以自定义一个网络！</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> --driver bridge</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> --subnet 192.168.0.0/16    <span class="comment">#192.168.0.2 192.168.255.255</span></span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> --gateway 192.168.0.1</span> </span><br><span class="line">[proton@proton-pc ~]$ docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span><br><span class="line">0fc624118477c649a92f54dd7436a7660393bf458a0325eb88cf7e9e02b9d9b4</span><br><span class="line">[proton@proton-pc ~]$ docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">7e7119e437a1   bridge    bridge    local</span><br><span class="line">dd4111e98dbc   host      host      local</span><br><span class="line">0fc624118477   mynet     bridge    local</span><br><span class="line">9820f0ae0444   none      null      local</span><br><span class="line">[proton@proton-pc ~]$ </span><br></pre></td></tr></table></figure>

<p>自己的网络就创建好了：</p>
<p><img src="/2021/09/22/Docker-notes/image-20210922204544768.png" alt="image-20210922204544768"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker run -d -P --name tomcat-net-01 --net mynet tomcat </span><br><span class="line">44e243fdf98ef7d7cdd334b639a94982fb2dfb50c15d0f1b0ab92b9b082c945d</span><br><span class="line">[proton@proton-pc ~]$ docker run -d -P --name tomcat-net-02 --net mynet tomcat  </span><br><span class="line">8704e3136780c17fe025699cf81b91732451dee3881424cb7640f4ce710dc374</span><br><span class="line">[proton@proton-pc ~]$ docker network inspect mynet</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;mynet&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;0fc624118477c649a92f54dd7436a7660393bf458a0325eb88cf7e9e02b9d9b4&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2021-09-22T20:41:10.237228394+08:00&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;192.168.0.1&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: false,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;</span><br><span class="line">            &quot;44e243fdf98ef7d7cdd334b639a94982fb2dfb50c15d0f1b0ab92b9b082c945d&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat-net-01&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;0e75ea84d2ecbc212b4c31e7e406f1a14012d295b81be0db444ce6195cabe8c0&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:02&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.2/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;8704e3136780c17fe025699cf81b91732451dee3881424cb7640f4ce710dc374&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat-net-02&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;a6e557c77424548b61a9e8f86dd2073475a52883c8263a3a4be8fb4975979a00&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:03&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.3/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>再次测试ping 连接</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">也可以ping 名字了</span></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it  tomcat-net-01 ping tomcat-net-02            </span><br><span class="line">PING tomcat-net-02 (192.168.0.3): 56 data bytes</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=0 ttl=64 time=0.591 ms</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=1 ttl=64 time=0.236 ms</span><br><span class="line">^C--- tomcat-net-02 ping statistics ---</span><br><span class="line">2 packets transmitted, 2 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.236/0.413/0.591/0.178 ms</span><br><span class="line">[proton@proton-pc ~]$ docker exec -it  tomcat-net-02 ping tomcat-net-01 </span><br><span class="line">PING tomcat-net-01 (192.168.0.2): 56 data bytes</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=0 ttl=64 time=0.117 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=1 ttl=64 time=0.146 ms</span><br><span class="line">^C--- tomcat-net-01 ping statistics ---</span><br><span class="line">2 packets transmitted, 2 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.117/0.132/0.146/0.000 ms</span><br><span class="line">[proton@proton-pc ~]$ </span><br></pre></td></tr></table></figure>

<p>我们自定义的网络，docker都已经帮我们维护好对应的关系了，推荐平时使用自定义的网络！</p>
<h3 id="网络连通"><a href="#网络连通" class="headerlink" title="网络连通"></a>网络连通</h3><p><img src="/2021/09/22/Docker-notes/image-20210922210349538.png" alt="image-20210922210349538"></p>
<p>[proton@proton-pc ~]$ docker exec -it tomcat01 apt-get update    </p>
<p>[proton@proton-pc ~]$ docker exec -it tomcat01 apt-get install inetutils-ping</p>
<img src="/2021/09/22/Docker-notes/image-20210922211146558.png" alt="image-20210922211146558" style="zoom:150%;">

<img src="/2021/09/22/Docker-notes/image-20210922211251148.png" alt="image-20210922211251148" style="zoom:150%;">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">测试打通，tomcat01 到tomcat-net-01</span></span><br><span class="line"><span class="meta">#</span><span class="bash">联通之后就是将我的tomcat01 加入到我们mynet中</span></span><br><span class="line"><span class="meta">#</span><span class="bash">一个容器两个IP</span> </span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/22/Docker-notes/image-20210922211606405.png" alt="image-20210922211606405"></p>
<p>测试：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[proton@proton-pc ~]$ docker network connect mynet tomcat01</span><br><span class="line">[proton@proton-pc ~]$ docker network inspect mynet</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[proton@proton-pc ~]$ docker exec -it tomcat01 ping tomcat-net-01</span><br><span class="line">PING tomcat-net-01 (192.168.0.2): 56 data bytes</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=0 ttl=64 time=0.648 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=1 ttl=64 time=0.140 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=2 ttl=64 time=0.118 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=3 ttl=64 time=0.269 ms</span><br><span class="line">^C--- tomcat-net-01 ping statistics ---</span><br><span class="line">4 packets transmitted, 4 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.118/0.294/0.648/0.213 ms</span><br><span class="line">[proton@proton-pc ~]$ </span><br></pre></td></tr></table></figure>

<p>假设需要跨网络操作别人的容器，就需要使用docker network connect  联通。</p>
<h3 id="实战：部署Redis集群"><a href="#实战：部署Redis集群" class="headerlink" title="实战：部署Redis集群"></a>实战：部署Redis集群</h3><p><img src="/2021/09/22/Docker-notes/image-20210922212314218.png" alt="image-20210922212314218"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">for port in $(seq 1 6); \</span><br><span class="line">do \</span><br><span class="line">mkdir -p /mydata/redis/node-$&#123;port&#125;/conf</span><br><span class="line">touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">cat &lt;&lt;EOF&gt;&gt; &gt;/mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">port 6379 </span><br><span class="line">bind 0.0.0.0</span><br><span class="line">cluster-enabled yes </span><br><span class="line">cluster-config-file nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">cluster-announce-ip 172.38.0.1$&#123;port&#125;</span><br><span class="line">cluster-announce-port 6379</span><br><span class="line">cluster-announce-bus-port 16379</span><br><span class="line">appendonly yes</span><br><span class="line">EOF </span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">==P38，创建redis集群==</span><br><span class="line">==创建配置文件===</span><br><span class="line">for port in $(seq 1 6); \</span><br><span class="line">do \</span><br><span class="line">mkdir -p /mydata/redis/node-$&#123;port&#125;/conf</span><br><span class="line">touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">cat &lt;&lt; EOF &gt; /mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">port 6379</span><br><span class="line">bind 0.0.0.0</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">cluster-announce-ip 172.38.0.1$&#123;port&#125;</span><br><span class="line">cluster-announce-port 6379</span><br><span class="line">cluster-announce-bus-port 16379</span><br><span class="line">appendonly yes</span><br><span class="line">EOF</span><br><span class="line">done</span><br><span class="line">== 启动容器===</span><br><span class="line">for port in $(seq 1 6); \</span><br><span class="line">do \</span><br><span class="line">docker run -p 637$&#123;port&#125;:6379 -p 1637$&#123;port&#125;:16379 --name redis-$&#123;port&#125; \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/data:/data \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/conf/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-d --net redis --ip 172.38.0.1$&#123;port&#125; redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf; \</span><br><span class="line">done</span><br><span class="line">==进入其中一个容器===</span><br><span class="line">docker exec -it redis-1 /bin/sh</span><br><span class="line">==创建集群===</span><br><span class="line">redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1</span><br><span class="line">==亲测有效===​</span><br></pre></td></tr></table></figure>





<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">/data # redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.</span><br><span class="line">14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing <span class="built_in">hash</span> slots allocation on 6 nodes...</span></span><br><span class="line">Master[0] -&gt; Slots 0 - 5460</span><br><span class="line">Master[1] -&gt; Slots 5461 - 10922</span><br><span class="line">Master[2] -&gt; Slots 10923 - 16383</span><br><span class="line">Adding replica 172.38.0.15:6379 to 172.38.0.11:6379</span><br><span class="line">Adding replica 172.38.0.16:6379 to 172.38.0.12:6379</span><br><span class="line">Adding replica 172.38.0.14:6379 to 172.38.0.13:6379</span><br><span class="line">M: 4ab2c4555828c6afd1c9d28791136cf978846e65 172.38.0.11:6379</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">M: 1521df6023a8397536c116d7ce52563a9002500f 172.38.0.12:6379</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">M: e6a9c3eddf3f70d3923c4f26b27a2bad5842e955 172.38.0.13:6379</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">S: 7344ab5a672a9aed3545fb244ff38ac3058ef3b4 172.38.0.14:6379</span><br><span class="line">   replicates e6a9c3eddf3f70d3923c4f26b27a2bad5842e955</span><br><span class="line">S: 472ac217c6029ffe0316c6e005f455320c2850a5 172.38.0.15:6379</span><br><span class="line">   replicates 4ab2c4555828c6afd1c9d28791136cf978846e65</span><br><span class="line">S: c9226bdd06b7c63a6917710d791f3d58f485a7a2 172.38.0.16:6379</span><br><span class="line">   replicates 1521df6023a8397536c116d7ce52563a9002500f</span><br><span class="line">Can I set the above configuration? (type &#x27;yes&#x27; to accept): yes</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Nodes configuration updated</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Assign a different config epoch to each node</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Sending CLUSTER MEET messages to join the cluster</span></span><br><span class="line">Waiting for the cluster to join</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 172.38.0.11:6379)</span></span><br><span class="line">M: 4ab2c4555828c6afd1c9d28791136cf978846e65 172.38.0.11:6379</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 1521df6023a8397536c116d7ce52563a9002500f 172.38.0.12:6379</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: c9226bdd06b7c63a6917710d791f3d58f485a7a2 172.38.0.16:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 1521df6023a8397536c116d7ce52563a9002500f</span><br><span class="line">S: 7344ab5a672a9aed3545fb244ff38ac3058ef3b4 172.38.0.14:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates e6a9c3eddf3f70d3923c4f26b27a2bad5842e955</span><br><span class="line">M: e6a9c3eddf3f70d3923c4f26b27a2bad5842e955 172.38.0.13:6379</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 472ac217c6029ffe0316c6e005f455320c2850a5 172.38.0.15:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 4ab2c4555828c6afd1c9d28791136cf978846e65</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check <span class="keyword">for</span> open slots...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check slots coverage...</span></span><br><span class="line">[OK] All 16384 slots covered.</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">docker</span> </span><br></pre></td></tr></table></figure>



<h3 id="SpringBoot-微服务"><a href="#SpringBoot-微服务" class="headerlink" title="SpringBoot 微服务"></a>SpringBoot 微服务</h3><p>企业实战</p>
<p>docker compose</p>
<p>docker Swarm</p>
<p>CI/CD jenkins 流水线！！</p>
<h1 id="Docker-参考手册"><a href="#Docker-参考手册" class="headerlink" title="Docker 参考手册"></a>Docker 参考手册</h1><h2 id="Docker-命令大全"><a href="#Docker-命令大全" class="headerlink" title="Docker 命令大全"></a>Docker 命令大全</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"> #</span><span class="bash">容器生命周期管理</span></span><br><span class="line"></span><br><span class="line">    run</span><br><span class="line">    start/stop/restart</span><br><span class="line">    kill</span><br><span class="line">    rm</span><br><span class="line">    pause/unpause</span><br><span class="line">    create</span><br><span class="line">    exec</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">容器操作</span></span><br><span class="line"></span><br><span class="line">    ps</span><br><span class="line">    inspect</span><br><span class="line">    top</span><br><span class="line">    attach</span><br><span class="line">    events</span><br><span class="line">    logs</span><br><span class="line">    wait</span><br><span class="line">    export</span><br><span class="line">    port</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">容器rootfs命令</span></span><br><span class="line"></span><br><span class="line">    commit</span><br><span class="line">    cp</span><br><span class="line">    diff</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">镜像仓库</span></span><br><span class="line"></span><br><span class="line">    login</span><br><span class="line">    pull</span><br><span class="line">    push</span><br><span class="line">    search</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">本地镜像管理</span></span><br><span class="line"></span><br><span class="line">    images</span><br><span class="line">    rmi</span><br><span class="line">    tag</span><br><span class="line">    build</span><br><span class="line">    history</span><br><span class="line">    save</span><br><span class="line">    load</span><br><span class="line">    import</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">info|version</span></span><br><span class="line"></span><br><span class="line">    info</span><br><span class="line">    version</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Docker-资源汇总"><a href="#Docker-资源汇总" class="headerlink" title="Docker 资源汇总"></a>Docker 资源汇总</h2><h3 id="Docker-资源"><a href="#Docker-资源" class="headerlink" title="Docker 资源"></a>Docker 资源</h3><ul>
<li>Docker 官方主页: <a target="_blank" rel="noopener" href="https://www.docker.com/">https://www.docker.com</a></li>
<li>Docker 官方博客: <a target="_blank" rel="noopener" href="https://blog.docker.com/">https://blog.docker.com/</a></li>
<li>Docker 官方文档: <a target="_blank" rel="noopener" href="https://docs.docker.com/">https://docs.docker.com/</a></li>
<li>Docker Store: <a target="_blank" rel="noopener" href="https://store.docker.com/">https://store.docker.com</a></li>
<li>Docker Cloud: <a target="_blank" rel="noopener" href="https://cloud.docker.com/">https://cloud.docker.com</a></li>
<li>Docker Hub: <a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com</a></li>
<li>Docker 的源代码仓库: <a target="_blank" rel="noopener" href="https://github.com/moby/moby">https://github.com/moby/moby</a></li>
<li>Docker 发布版本历史: <a target="_blank" rel="noopener" href="https://docs.docker.com/release-notes/">https://docs.docker.com/release-notes/</a></li>
<li>Docker 常见问题: <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/faq/">https://docs.docker.com/engine/faq/</a></li>
<li>Docker 远端应用 API: <a target="_blank" rel="noopener" href="https://docs.docker.com/develop/sdk/">https://docs.docker.com/develop/sdk/</a></li>
</ul>
<h3 id="Docker-国内镜像"><a href="#Docker-国内镜像" class="headerlink" title="Docker 国内镜像"></a>Docker 国内镜像</h3><ul>
<li><p>阿里云的加速器：<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/60750.html">https://help.aliyun.com/document_detail/60750.html</a></p>
</li>
<li><p>网易加速器：<a target="_blank" rel="noopener" href="http://hub-mirror.c.163.com/">http://hub-mirror.c.163.com</a></p>
</li>
<li><p>官方中国加速器：<a target="_blank" rel="noopener" href="https://registry.docker-cn.com/">https://registry.docker-cn.com</a></p>
</li>
<li><p>ustc 的镜像：<a target="_blank" rel="noopener" href="https://docker.mirrors.ustc.edu.cn/">https://docker.mirrors.ustc.edu.cn</a></p>
</li>
<li><p>daocloud：<a target="_blank" rel="noopener" href="https://www.daocloud.io/mirror#accelerator-doc%EF%BC%88%E6%B3%A8%E5%86%8C%E5%90%8E%E4%BD%BF%E7%94%A8%EF%BC%89">https://www.daocloud.io/mirror#accelerator-doc（注册后使用）</a></p>
</li>
<li><p>如果有更好的资源，欢迎通过下面的笔记来分享。</p>
</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Docker/" rel="tag"># Docker</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/09/13/Archlinu-install-note/" rel="prev" title="Archlinu-install-note">
                  <i class="fa fa-chevron-left"></i> Archlinu-install-note
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/10/06/migen-notes/" rel="next" title="migen-notes">
                  migen-notes <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zsz</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
